var to=Object.defineProperty,oo=Object.defineProperties;var ao=Object.getOwnPropertyDescriptors;var bt=Object.getOwnPropertySymbols;var ro=Object.prototype.hasOwnProperty,so=Object.prototype.propertyIsEnumerable;var nt=(e,t,o)=>t in e?to(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,Et=(e,t)=>{for(var o in t||(t={}))ro.call(t,o)&&nt(e,o,t[o]);if(bt)for(var o of bt(t))so.call(t,o)&&nt(e,o,t[o]);return e},Lt=(e,t)=>oo(e,ao(t));var h=(e,t,o)=>(nt(e,typeof t!="symbol"?t+"":t,o),o);import{c as l,w as C,l as g,a as no,d as M,o as Z,r as S,b as H,e as E,f as b,g as Q,F as j,h as y,i as z,j as W,t as io,n as J,k as Re,m as A,p as P,q as w,s as K,u as D,v as it,x as lo,y as De,z as X,A as co,B as po,C as He,D as F,E as ee,G as oe,H as mo,I as uo,J as ho,K as go,V as fo}from"./vendor.3a2d484d.js";const yo=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const n of s.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&a(n)}).observe(document,{childList:!0,subtree:!0});function o(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerpolicy&&(s.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?s.credentials="include":r.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(r){if(r.ep)return;r.ep=!0;const s=o(r);fetch(r.href,s)}};yo();const lt=new Map,Fe=new Map,qe=new Set,dt=[],St=/ยง[0-9a-f]/ig,wo=/_?nether(_|$)/i,vo=/(^|_)end(_|$)/i,ct=e=>{const t=e>=0&&e<13700;return{serverTime:e,days:Math.floor((e+8e3)/24e3),hours:(Math.floor(e/1e3)+6)%24,minutes:Math.floor(e/1e3%1*60),seconds:Math.floor(e/1e3%1*60%1*60),day:t,night:!t}},kt=e=>{switch(e){case"large":case"body":return 32;case"small":default:return 16}},Ve=(e,t)=>{const o=typeof e=="string"?e:e.name,a=typeof e=="string"?void 0:e.uuid,r=`${o}-${t}`;if(lt.has(r))return Promise.resolve(lt.get(r));if(Fe.has(r))return Fe.get(r);const s=new Promise((n,i)=>{const c=new Image;c.onload=function(){lt.set(r,c),qe.delete(r),Ke(),n(c)},c.onerror=function(d){console.warn(`Failed to retrieve face of ${o} with size ${t}!`),qe.delete(r),Ke(),i(d)},dt.push({name:o,uuid:a,size:t,cacheKey:r,image:c})}).finally(()=>Fe.delete(r));return Fe.set(r,s),Ke(),s},Ke=()=>{if(qe.size>8||!dt.length)return;const e=dt.pop();qe.add(e.cacheKey),e.image.src=_().state.currentMapProvider.getPlayerHeadUrl(e),Ke()},_o=e=>{const t=new URLSearchParams(e.search),o=e.hash.replace("#","");return o?bo(o):Eo(t)},bo=e=>{const t=e.replace("#","").split(";"),o=t[0]||void 0,a=t[1]||void 0,r=(t[2]||"").split(",").map(n=>parseFloat(n)).filter(n=>!isNaN(n)&&isFinite(n)),s=typeof t[3]!="undefined"?parseInt(t[3]):void 0;return Ct({world:o,map:a,location:r.length===3?{x:r[0],y:r[1],z:r[2]}:void 0,zoom:s,legacy:!1})},Eo=e=>{const t=e.get("worldname")||e.get("world")||void 0,o=e.has("worldname")&&e.get("mapname")||void 0,a=[e.get("x")||"",e.get("y")||"64",e.get("z")||""].map(s=>parseFloat(s)).filter(s=>!isNaN(s)&&isFinite(s)),r=e.has("zoom")?parseInt(e.get("zoom")):void 0;return Ct({world:t,map:o,location:a.length===3?{x:a[0],y:a[1],z:a[2]}:void 0,zoom:r,legacy:!0})},Ct=e=>(typeof e.zoom!="undefined"&&(isNaN(e.zoom)||e.zoom<0||!isFinite(e.zoom))&&(e.zoom=void 0),e.world?e:null),Tt=(e,t,o)=>{const a=Math.round(t.x),r=Math.round(t.y),s=Math.round(t.z),n=`${a},${r},${s}`;return e?`#${e.world.name};${e.name};${n};${o}`:""},Mt=e=>{const t=document.querySelector(e);t&&t.focus()},At=document.createElement("textarea"),Lo=e=>(At.innerHTML=e,At.textContent||""),So={playerMarkersEnabled(e){return e.components.playerMarkers!==void 0},coordinatesControlEnabled(e){return e.components.coordinatesControl!==void 0},clockControlEnabled(e){return e.components.clockControl!==void 0},loginEnabled(e){return e.components.login||e.loginRequired},night(e){return ct(e.currentWorldState.timeOfDay).night},mapBackground(e){return e.currentMap?e.currentMap.nightAndDay?ct(e.currentWorldState.timeOfDay).night?e.currentMap.backgroundNight||e.currentMap.background||"transparent":e.currentMap.backgroundDay||e.currentMap.background||"transparent":e.currentMap.background||"transparent":"transparent"},url(e){const t=e.currentLocation.x,o=e.currentLocation.y,a=e.currentLocation.z,r=e.currentZoom;return!e.currentWorld||!e.currentMap?"":Tt(e.currentMap,{x:t,y:o,z:a},r)},pageTitle(e){var t,o;return e.configuration.title.replace(/{world}/gi,((t=e.currentWorld)==null?void 0:t.displayName)||"No world").replace(/{map}/gi,((o=e.currentMap)==null?void 0:o.displayName)||"No map")},playersHeading(e){return e.messages.playersHeading.replace("{cur}",e.players.size.toString()).replace("{max}",e.maxPlayers.toString())}};var p;(function(e){e.INIT="init",e.SET_SERVER_CONFIGURATION="setServerConfiguration",e.SET_SERVER_CONFIGURATION_HASH="setServerConfigurationHash",e.SET_SERVER_MESSAGES="setServerMessages",e.SET_WORLDS="setWorlds",e.SET_COMPONENTS="setComponents",e.SET_MARKER_SETS="setMarkerSets",e.SET_WORLD_STATE="setWorldState",e.ADD_MARKER_SET_UPDATES="addMarkerSetUpdates",e.ADD_TILE_UPDATES="addTileUpdates",e.ADD_CHAT="addChat",e.POP_MARKER_UPDATES="popMarkerUpdates",e.POP_AREA_UPDATES="popAreaUpdates",e.POP_CIRCLE_UPDATES="popCircleUpdates",e.POP_LINE_UPDATES="popLineUpdates",e.POP_TILE_UPDATES="popTileUpdates",e.SET_MAX_PLAYERS="setMaxPlayers",e.SET_PLAYERS_ASYNC="setPlayersAsync",e.SYNC_PLAYERS="syncPlayers",e.SET_CURRENT_SERVER="setCurrentServer",e.SET_CURRENT_MAP="setCurrentMap",e.SET_CURRENT_LOCATION="setCurrentLocation",e.SET_CURRENT_ZOOM="setCurrentZoom",e.SET_PARSED_URL="setParsedUrl",e.CLEAR_PARSED_URL="clearParsedUrl",e.SET_FOLLOW_TARGET="setFollowTarget",e.SET_PAN_TARGET="setPanTarget",e.CLEAR_FOLLOW_TARGET="clearFollow",e.CLEAR_PAN_TARGET="clearPanTarget",e.SET_SMALL_SCREEN="setSmallScreen",e.TOGGLE_UI_ELEMENT_VISIBILITY="toggleUIElementVisibility",e.SET_UI_ELEMENT_VISIBILITY="setUIElementVisibility",e.SHOW_UI_MODAL="showUIModal",e.HIDE_UI_MODAL="hideUIModal",e.TOGGLE_SIDEBAR_SECTION_COLLAPSED_STATE="toggleSidebarSectionCollapsedState",e.SET_LOGGED_IN="setLoggedIn",e.SET_LOGIN_REQUIRED="setLoginRequired",e.RESET="reset"})(p||(p={}));class Ye extends Error{constructor(t){super(t);this.name="ChatError"}}class Be{constructor(t){h(this,"store",_());h(this,"config");h(this,"currentWorldUnwatch");this.config=t;const o=l(()=>this.store.state.currentWorld);this.currentWorldUnwatch=C(o,a=>{a&&this.populateWorld(a)})}sendChatMessage(t){throw new Error("Provider does not support chat")}async login(t){throw new Error("Provider does not support logging in")}async logout(){throw new Error("Provider does not support logging out")}async register(t){throw new Error("Provider does not support registration")}destroy(){this.currentWorldUnwatch()}static async fetchJSON(t,o){let a,r;try{a=await fetch(t,o)}catch(s){throw s instanceof DOMException&&s.name==="AbortError"?(console.warn(`Request aborted (${t}`),s):(console.error(s),new Error("Network request failed"))}if(!a.ok)throw new Error(`Network request failed (${a.statusText||"Unknown"})`);try{r=await a.json()}catch(s){throw s instanceof DOMException&&s.name==="AbortError"?(console.warn(`Request aborted (${t}`),s):new Error("Request returned invalid json")}return r}static async getJSON(t,o){return Be.fetchJSON(t,{signal:o,credentials:"include"})}}var U;(function(e){e.LOAD_CONFIGURATION="loadConfiguration",e.START_UPDATES="startUpdates",e.STOP_UPDATES="stopUpdates",e.SET_PLAYERS="setPlayers",e.POP_MARKER_UPDATES="popMarkerUpdates",e.POP_AREA_UPDATES="popAreaUpdates",e.POP_CIRCLE_UPDATES="popCircleUpdates",e.POP_LINE_UPDATES="popLineUpdates",e.POP_TILE_UPDATES="popTileUpdates",e.SEND_CHAT_MESSAGE="sendChatMessage",e.LOGIN="login",e.LOGOUT="logout",e.REGISTER="register"})(U||(U={}));class pt extends g.exports.Polyline{constructor(t,o){super(t,o.style);this.options.minZoom=o.minZoom,this.options.maxZoom=o.maxZoom}}class Pt extends g.exports.Polygon{constructor(t,o){super(t,o.style)}}const mt={direction:"top",sticky:!0,opacity:1,interactive:!1},ko=(e,t)=>JSON.stringify(e)===JSON.stringify(t),Co=(e,t)=>e&&t&&e.color===t.color&&e.weight===t.weight&&e.opacity===t.opacity&&e.fillColor===t.fillColor&&e.fillOpacity===t.fillOpacity,se=(e,t)=>{const o=document.createElement("span");return e.isPopupHTML?(o.classList.add(t),o.insertAdjacentHTML("afterbegin",e.popupContent)):o.textContent=e.popupContent,o},It=(e,t)=>{const o=!e.style.fillOpacity||e.style.fillOpacity<=0,a=e.points.map(ut,t),r=o?new pt(a,e):new Pt(a,e);return e.popupContent&&r.bindPopup(()=>se(e,"AreaPopup")),e.tooltipContent&&r.bindTooltip(()=>e.tooltipContent,mt),r},Ut=(e,t,o)=>{if(!e)return It(t,o);const a=t.points.map(ut,o),r=e.getLatLngs();let s=!1;return Co(e.options,t.style)||(e.setStyle(t.style),s=!0),ko(r.length===1?r[0]:r,a)||(e.setLatLngs(a),s=!0),e.closePopup(),e.unbindPopup(),e.bindPopup(()=>se(t,"AreaPopup")),s&&e.redraw(),e},ut=function(e){return Array.isArray(e)?e.map(ut,this):this(e)},To=(e,t,o,a)=>e.length===2?t[0]===t[1]?Ao(e,t,o,a):Mo(e,t,o):t[0]===t[1]?Io(e,t,o,a):Po(e,t,o),Mo=(e,t,o)=>{const a=e[0],r=e[1],s=t[0],n=t[1],i=o[0],c=o[1];return[[{x:r,y:n,z:c},{x:a,y:n,z:c},{x:a,y:n,z:i},{x:r,y:n,z:i}],[{x:r,y:s,z:c},{x:a,y:s,z:c},{x:a,y:s,z:i},{x:r,y:s,z:i}],[{x:r,y:n,z:c},{x:r,y:s,z:c},{x:a,y:s,z:c},{x:a,y:n,z:c}],[{x:a,y:n,z:c},{x:a,y:s,z:c},{x:a,y:s,z:i},{x:a,y:n,z:i}],[{x:r,y:n,z:i},{x:r,y:s,z:i},{x:a,y:s,z:i},{x:a,y:n,z:i}],[{x:r,y:n,z:c},{x:r,y:s,z:c},{x:r,y:s,z:i},{x:r,y:n,z:i}]]},Ao=(e,t,o,a)=>{const r=e[0],s=e[1],n=t[1],i=o[0],c=o[1];return a?[{x:s,y:n,z:c},{x:r,y:n,z:c},{x:r,y:n,z:i},{x:s,y:n,z:i},{x:s,y:n,z:c}]:[{x:s,y:n,z:c},{x:r,y:n,z:c},{x:r,y:n,z:i},{x:s,y:n,z:i}]},Po=(e,t,o)=>{const a=[],r=[],s=[];for(let n=0;n<e.length;n++)a[n]={x:e[n],y:t[0],z:o[n]},r[n]={x:e[n],y:t[1],z:o[n]};for(let n=0;n<e.length;n++)s[n]=[a[n],r[n],r[(n+1)%e.length],a[(n+1)%e.length]];return s[e.length]=r,s[e.length+1]=a,s},Io=(e,t,o,a)=>{const r=[];for(let s=0;s<e.length;s++)r[s]={x:e[s],y:t[1],z:o[s]};return a&&r.push(r[0]),r},$t=(e,t)=>{const o=e.points.map(ht,t),a=new pt(o,e);return e.popupContent&&a.bindPopup(()=>se(e,"LinePopup")),e.tooltipContent&&a.bindTooltip(()=>e.tooltipContent,mt),a},zt=(e,t,o)=>e?(e.closePopup(),e.unbindPopup(),e.bindPopup(()=>se(t,"LinePopup")),e.setStyle(t.style),e.setLatLngs(t.points.map(ht,o)),e.redraw(),e):$t(t,o),ht=function(e){return Array.isArray(e)?ht(e):this(e)},Uo=(e,t,o)=>{const a=[];for(let r=0;r<e.length;r++)a.push({x:e[r],y:t[r],z:o[r]});return a};class $o{constructor(t){h(this,"mapToWorld");h(this,"worldToMap");h(this,"nativeZoomLevels");this.mapToWorld=t.mapToWorld||[0,0,0,0,0,0,0,0],this.worldToMap=t.worldToMap||[0,0,0,0,0,0,0,0],this.nativeZoomLevels=t.nativeZoomLevels||1}locationToLatLng(t){const o=this.worldToMap,a=o[3]*t.x+o[4]*t.y+o[5]*t.z,r=o[0]*t.x+o[1]*t.y+o[2]*t.z;return new g.exports.LatLng(-((128-a)/(1<<this.nativeZoomLevels)),r/(1<<this.nativeZoomLevels))}latLngToLocation(t,o){const a=this.mapToWorld,r=t.lng*(1<<this.nativeZoomLevels),s=128+t.lat*(1<<this.nativeZoomLevels),n=a[0]*r+a[1]*s+a[2]*o,i=a[6]*r+a[7]*s+a[8]*o;return{x:n,y:o,z:i}}}class Ot{constructor(t){h(this,"world");h(this,"name");h(this,"icon");h(this,"displayName");h(this,"background");h(this,"nightAndDay");h(this,"backgroundDay");h(this,"backgroundNight");h(this,"imageFormat");h(this,"prefix");h(this,"projection");h(this,"nativeZoomLevels");h(this,"extraZoomLevels");h(this,"scale");h(this,"tileUpdateInterval");this.world=t.world,this.name=t.name,this.icon=t.icon||void 0,this.displayName=t.displayName||"",this.background=t.background||"#000000",this.nightAndDay=t.nightAndDay||!1,this.backgroundDay=t.backgroundDay||"#000000",this.backgroundNight=t.backgroundNight||"#000000",this.imageFormat=t.imageFormat,this.prefix=t.prefix||"",this.nativeZoomLevels=t.nativeZoomLevels||1,this.extraZoomLevels=t.extraZoomLevels||0,this.scale=1/Math.pow(2,this.nativeZoomLevels),this.tileUpdateInterval=t.tileUpdateInterval||void 0,(t.mapToWorld||t.worldToMap)&&(this.projection=new $o({mapToWorld:t.mapToWorld||[0,0,0,0,0,0,0,0,0],worldToMap:t.worldToMap||[0,0,0,0,0,0,0,0,0],nativeZoomLevels:this.nativeZoomLevels}))}locationToLatLng(t){return this.projection?this.projection.locationToLatLng(t):new g.exports.LatLng(-t.z*this.scale,t.x*this.scale)}latLngToLocation(t,o){return this.projection?this.projection.latLngToLocation(t,o):{x:t.lng/this.scale,y:o,z:-t.lat/this.scale}}hasCustomIcon(){return!!this.icon}getIcon(){let t,o;if(this.icon)return this.icon;switch(this.world.dimension){case"nether":t="nether",o=["surface","nether"].includes(this.name)?"surface":"flat";break;case"end":t="the_end",o=["surface","the_end"].includes(this.name)?"surface":"flat";break;case"overworld":default:t="world",o=["surface","flat","biome","cave"].includes(this.name)?this.name:"flat";break}return`block_${t}_${o}`}}function zo(e){let t="Dynmap";e.title&&(t=e.title.replace(St,"")||t);const o=parseInt(e.followzoom||"",10);return{defaultMap:e.defaultmap||void 0,defaultWorld:e.defaultworld||void 0,defaultZoom:e.defaultzoom||0,followMap:e.followmap||void 0,followZoom:isNaN(o)?void 0:o,title:t,expandUI:!!e.sidebaropened&&e.sidebaropened!=="false"}}function Oo(e){return{chatPlayerJoin:e.joinmessage||"",chatPlayerQuit:e.quitmessage||"",chatAnonymousJoin:e["msg-hiddennamejoin"]||"",chatAnonymousQuit:e["msg-hiddennamequit"]||"",chatErrorNotAllowed:e["msg-chatnotallowed"]||"",chatErrorRequiresLogin:e["msg-chatrequireslogin"]||"",chatErrorCooldown:e.spammessage||"",worldsHeading:e["msg-maptypes"]||"",playersHeading:e["msg-players"]?`${e["msg-players"]} ({cur}/{max})`:""}}function No(e){const t=new Map;return(e.worlds||[]).forEach(o=>{let a="overworld";wo.test(o.name)||o.name=="DIM-1"?a="nether":(vo.test(o.name)||o.name=="DIM1")&&(a="end"),t.set(o.name,{name:o.name,displayName:o.title||"",dimension:a,seaLevel:o.sealevel||64,center:{x:o.center.x||0,y:o.center.y||0,z:o.center.z||0},maps:new Map})}),(e.worlds||[]).forEach(o=>{(o.maps||[]).forEach(a=>{const r=t.get(o.name),s=a.append_to_world||o.name,n=t.get(s);if(!n||!r){console.warn(`Ignoring map '${a.name}' associated with non-existent world '${s}'`);return}n.maps.set(a.name,Object.freeze(new Ot({world:r,background:a.background||"#000000",backgroundDay:a.backgroundday||"#000000",backgroundNight:a.backgroundnight||"#000000",icon:a.icon||void 0,imageFormat:a["image-format"]||"png",name:a.name||"(Unnamed map)",nightAndDay:a.nightandday||!1,prefix:a.prefix||"",displayName:a.title||"",mapToWorld:a.maptoworld||void 0,worldToMap:a.worldtomap||void 0,nativeZoomLevels:a.mapzoomout||1,extraZoomLevels:a.mapzoomin||0})))})}),Array.from(t.values())}function xo(e){const t={markers:{showLabels:!1},chatBox:void 0,chatBalloons:!1,playerMarkers:void 0,playerList:{showImages:e.showplayerfacesinmenu||!1},coordinatesControl:void 0,layerControl:!!e.showlayercontrol&&e.showlayercontrol!=="false",linkControl:!1,clockControl:void 0,logoControls:[],login:e["login-enabled"]||!1};return(e.components||[]).forEach(o=>{const a=o.type||"unknown";let r="large";switch(a){case"markers":t.markers={showLabels:o.showlabel||!1};break;case"playermarkers":o.showplayerfaces?o.smallplayerfaces?r="small":o.showplayerbody&&(r="body"):r="none",t.playerMarkers={grayHiddenPlayers:e.grayplayerswhenhidden||!1,hideByDefault:o.hidebydefault||!1,layerName:o.label||"Players",layerPriority:o.layerprio||0,imageSize:r,showHealth:o.showplayerhealth||!1,showArmor:o.showplayerhealth||!1,showYaw:!1};break;case"coord":t.coordinatesControl={showY:!o.hidey,label:o.label||"Location: ",showRegion:o["show-mcr"]||!1,showChunk:o["show-chunk"]||!1};break;case"link":t.linkControl=!0;break;case"digitalclock":t.clockControl={showDigitalClock:!0,showWeather:!1,showTimeOfDay:!1};break;case"timeofdayclock":t.clockControl={showTimeOfDay:!0,showDigitalClock:o.showdigitalclock||!1,showWeather:o.showweather||!1};break;case"logo":t.logoControls.push({text:o.text||"",url:o.linkurl||void 0,position:o.position.replace("-","")||"topleft",image:o.logourl||void 0});break;case"chat":e.allowwebchat&&(t.chatSending={loginRequired:e["webchat-requires-login"]||!1,maxLength:e.chatlengthlimit||256,cooldown:e["webchat-interval"]||5});break;case"chatbox":t.chatBox={allowUrlName:o.allowurlname||!1,showPlayerFaces:o.showplayerfaces||!1,messageLifetime:o.messagettl||1/0,messageHistory:o.scrollback||1/0};break;case"chatballoon":t.chatBalloons=!0}}),t}function Nt(e,t){return{id:e,label:t.label||"Unnamed set",hidden:t.hide||!1,priority:t.layerprio||0,showLabels:t.showlabels||void 0,minZoom:typeof t.minzoom!="undefined"&&t.minzoom>-1?t.minzoom:void 0,maxZoom:typeof t.maxzoom!="undefined"&&t.maxzoom>-1?t.maxzoom:void 0}}function Ro(e){const t=Object.freeze(new Map);for(const o in e)!Object.prototype.hasOwnProperty.call(e,o)||t.set(o,xt(e[o]));return t}function xt(e){let t;e.dim&&(t=e.dim.split("x").slice(0,2).map(a=>parseInt(a)),t.length!==2&&(t=void 0));const o=Object.seal({label:e.label||"",isLabelHTML:e.markup||!1,location:{x:e.x||0,y:e.y||0,z:e.z||0},dimensions:t||[16,16],icon:e.icon||"default",minZoom:typeof e.minzoom!="undefined"&&e.minzoom>-1?e.minzoom:void 0,maxZoom:typeof e.maxzoom!="undefined"&&e.maxzoom>-1?e.maxzoom:void 0,popupContent:e.desc||void 0});return o.isLabelHTML||(o.label=Lo(o.label)),o}function Do(e){const t=Object.freeze(new Map);for(const o in e)!Object.prototype.hasOwnProperty.call(e,o)||t.set(o,Rt(e[o]));return t}function Rt(e){const t=e.fillopacity||0,o=e.x||[0,0],a=[e.ybottom||0,e.ytop||0],r=e.z||[0,0];return Object.seal({style:{color:e.color||"#ff0000",opacity:e.opacity||1,weight:e.weight||1,fillColor:e.fillcolor||"#ff0000",fillOpacity:e.fillopacity||0},outline:!t,points:To(o,a,r,!t),minZoom:typeof e.minzoom!="undefined"&&e.minzoom>-1?e.minzoom:void 0,maxZoom:typeof e.maxzoom!="undefined"&&e.maxzoom>-1?e.maxzoom:void 0,isPopupHTML:e.desc?!0:e.markup||!1,popupContent:e.desc||e.label||void 0})}function Ho(e){const t=Object.freeze(new Map);for(const o in e)!Object.prototype.hasOwnProperty.call(e,o)||t.set(o,Dt(e[o]));return t}function Dt(e){return Object.seal({style:{color:e.color||"#ff0000",opacity:e.opacity||1,weight:e.weight||1},points:Uo(e.x||[0,0],e.y||[0,0],e.z||[0,0]),minZoom:typeof e.minzoom!="undefined"&&e.minzoom>-1?e.minzoom:void 0,maxZoom:typeof e.maxzoom!="undefined"&&e.maxzoom>-1?e.maxzoom:void 0,isPopupHTML:e.desc?!0:e.markup||!1,popupContent:e.desc||e.label||void 0})}function Bo(e){const t=Object.freeze(new Map);for(const o in e)!Object.prototype.hasOwnProperty.call(e,o)||t.set(o,Ht(e[o]));return t}function Ht(e){return Object.seal({location:{x:e.x||0,y:e.y||0,z:e.z||0},radius:[e.xr||0,e.zr||0],style:{fillColor:e.fillcolor||"#ff0000",fillOpacity:e.fillopacity||0,color:e.color||"#ff0000",opacity:e.opacity||1,weight:e.weight||1},minZoom:typeof e.minzoom!="undefined"&&e.minzoom>-1?e.minzoom:void 0,maxZoom:typeof e.maxzoom!="undefined"&&e.maxzoom>-1?e.maxzoom:void 0,isPopupHTML:e.desc?!0:e.markup||!1,popupContent:e.desc||e.label||void 0})}function jo(e,t){const o={markerSets:new Map,tiles:[],chat:[]},a={stale:0,noSet:0,noId:0,unknownType:0,unknownCType:0,incomplete:0,notImplemented:0};let r=0;for(const s of e)switch(s.type){case"component":{if(t&&s.timestamp<t){a.stale++;continue}if(!s.id){a.noId++;continue}const n=s.msg.startsWith("set")?s.id:s.set;if(!n){a.noSet++;continue}if(s.ctype!=="markers"){a.unknownCType++;continue}o.markerSets.has(n)||o.markerSets.set(n,{areaUpdates:[],markerUpdates:[],lineUpdates:[],circleUpdates:[],removed:!1});const i=o.markerSets.get(n),c={id:s.id,removed:s.msg.endsWith("deleted")};s.msg.startsWith("set")?(i.removed=c.removed,i.payload=c.removed?void 0:Nt(n,s)):s.msg.startsWith("marker")?(c.payload=c.removed?void 0:xt(s),i.markerUpdates.push(Object.freeze(c))):s.msg.startsWith("area")?(c.payload=c.removed?void 0:Rt(s),i.areaUpdates.push(Object.freeze(c))):s.msg.startsWith("circle")?(c.payload=c.removed?void 0:Ht(s),i.circleUpdates.push(Object.freeze(c))):s.msg.startsWith("line")&&(c.payload=c.removed?void 0:Dt(s),i.lineUpdates.push(Object.freeze(c))),r++;break}case"chat":if(!s.message||!s.timestamp){a.incomplete++;continue}if(s.timestamp<t){a.stale++;continue}if(s.source!=="player"&&s.source!=="web"&&s.source!=="plugin"){a.notImplemented++;continue}o.chat.push({type:"chat",source:s.source||void 0,playerAccount:s.account||void 0,playerName:s.playerName||void 0,message:s.message||"",timestamp:s.timestamp,channel:s.channel||void 0});break;case"playerjoin":if(!s.account||!s.timestamp){a.incomplete++;continue}if(s.timestamp<t){a.stale++;continue}o.chat.push({type:"playerjoin",playerAccount:s.account,playerName:s.playerName||"",timestamp:s.timestamp||void 0});break;case"playerquit":if(!s.account||!s.timestamp){a.incomplete++;continue}if(s.timestamp<t){a.stale++;continue}o.chat.push({type:"playerleave",playerAccount:s.account,playerName:s.playerName||"",timestamp:s.timestamp||void 0});break;case"tile":if(!s.name||!s.timestamp){a.incomplete++;continue}if(t&&s.timestamp<t){a.stale++;continue}o.tiles.push({name:s.name,timestamp:s.timestamp}),r++;break;default:a.unknownType++}return o.chat=o.chat.sort((s,n)=>n.timestamp-s.timestamp),console.debug(`Updates: ${r} accepted. Rejected: `,a),o}class je extends Be{constructor(t){super(t);h(this,"configurationAbort");h(this,"markersAbort");h(this,"updateAbort");h(this,"updatesEnabled",!1);h(this,"updateTimeout",null);h(this,"updateTimestamp",new Date);h(this,"updateInterval",3e3)}async getMarkerSets(t){const o=`${this.config.dynmap.markers}_markers_/marker_${t.name}.json`;this.markersAbort&&this.markersAbort.abort(),this.markersAbort=new AbortController;const a=await this.getJSON(o,this.markersAbort.signal),r=new Map;a.sets=a.sets||{};for(const s in a.sets){if(!Object.prototype.hasOwnProperty.call(a.sets,s))continue;const n=a.sets[s],i=Ro(n.markers||{}),c=Bo(n.circles||{}),d=Do(n.areas||{}),u=Ho(n.lines||{});r.set(s,Lt(Et({},Nt(s,n)),{markers:i,circles:c,areas:d,lines:u}))}return r}async loadServerConfiguration(){this.configurationAbort&&this.configurationAbort.abort(),this.configurationAbort=new AbortController;const t=await this.getJSON(this.config.dynmap.configuration,this.configurationAbort.signal);if(t.error)throw new Error(t.error);const o=zo(t);this.updateInterval=t.updaterate||3e3,this.store.commit(p.SET_SERVER_CONFIGURATION,o),this.store.commit(p.SET_SERVER_CONFIGURATION_HASH,t.confighash||0),this.store.commit(p.SET_MAX_PLAYERS,t.maxcount||0),this.store.commit(p.SET_SERVER_MESSAGES,Oo(t)),this.store.commit(p.SET_WORLDS,No(t)),this.store.commit(p.SET_COMPONENTS,xo(t)),this.store.commit(p.SET_LOGGED_IN,t.loggedin||!1)}async populateWorld(t){const o=await this.getMarkerSets(t);this.store.commit(p.SET_MARKER_SETS,o)}async getUpdate(){let t=this.config.dynmap.update;t=t.replace("{world}",this.store.state.currentWorld.name),t=t.replace("{timestamp}",this.updateTimestamp.getTime().toString()),this.updateAbort&&this.updateAbort.abort(),this.updateAbort=new AbortController;const o=await this.getJSON(t,this.updateAbort.signal),a=new Set,r=jo(o.updates||[],this.updateTimestamp),s={timeOfDay:o.servertime||0,thundering:o.isThundering||!1,raining:o.hasStorm||!1};(o.players||[]).forEach(n=>{const i=n.world&&n.world!=="-some-other-bogus-world-"?n.world:void 0;a.add({name:n.account||"",displayName:n.name||"",health:n.health||0,armor:n.armor||0,sort:n.sort||0,hidden:!i,location:{x:isNaN(n.x)?0:n.x+.5,y:isNaN(n.y)?0:n.y,z:isNaN(n.z)?0:n.z+.5,world:i}})}),this.updateTimestamp=new Date(o.timestamp||0),this.store.commit(p.SET_WORLD_STATE,s),this.store.commit(p.ADD_MARKER_SET_UPDATES,r.markerSets),this.store.commit(p.ADD_TILE_UPDATES,r.tiles),this.store.commit(p.ADD_CHAT,r.chat),o.confighash&&this.store.commit(p.SET_SERVER_CONFIGURATION_HASH,o.confighash),await this.store.dispatch(U.SET_PLAYERS,a)}sendChatMessage(t){return this.store.state.components.chatSending?fetch(this.config.dynmap.sendmessage,{method:"POST",credentials:"include",body:JSON.stringify({name:null,message:t})}).then(o=>{if(o.status===403)throw new Ye(this.store.state.messages.chatErrorCooldown.replace("%interval%",this.store.state.components.chatSending.cooldown.toString()));if(!o.ok)throw new Error("Network request failed");return o.json()}).then(o=>{if(o.error!=="none")throw new Ye(this.store.state.messages.chatErrorNotAllowed)}).catch(o=>{throw o instanceof Ye||(console.error(this.store.state.messages.chatErrorUnknown),console.trace(o)),o}):Promise.reject(this.store.state.messages.chatErrorDisabled)}startUpdates(){this.updatesEnabled=!0,this.update()}async update(){try{await this.getUpdate()}finally{this.updatesEnabled&&(this.updateTimeout&&clearTimeout(this.updateTimeout),this.updateTimeout=setTimeout(()=>this.update(),this.updateInterval))}}stopUpdates(){this.updatesEnabled=!1,this.updateTimeout&&clearTimeout(this.updateTimeout),this.updateTimeout=null}getTilesUrl(){return this.config.dynmap.tiles}getPlayerHeadUrl(t){const o=`${this.config.dynmap.markers}faces/`;if(t.size==="body")return`${o}body/${t.name}.png`;const a=kt(t.size);return`${o}${a}x${a}/${t.name}.png`}getMarkerIconUrl(t){return`${this.config.dynmap.markers}_markers_/${t}.png`}async login(t){if(!this.store.getters.loginEnabled)return Promise.reject(this.store.state.messages.loginErrorDisabled);this.store.commit(p.SET_LOGGED_IN,!1);try{const o=new URLSearchParams;switch(o.append("j_username",t.username||""),o.append("j_password",t.password||""),(await je.fetchJSON(this.config.dynmap.login,{method:"POST",body:o})).result){case"success":this.store.commit(p.SET_LOGGED_IN,!0);return;case"loginfailed":return Promise.reject(this.store.state.messages.loginErrorIncorrect);default:return Promise.reject(this.store.state.messages.loginErrorUnknown)}}catch(o){return console.error(this.store.state.messages.loginErrorUnknown),console.trace(o),Promise.reject(this.store.state.messages.loginErrorUnknown)}}async logout(){if(!this.store.getters.loginEnabled)return Promise.reject(this.store.state.messages.loginErrorDisabled);try{await je.fetchJSON(this.config.dynmap.login,{method:"POST"}),this.store.commit(p.SET_LOGGED_IN,!1)}catch{return Promise.reject(this.store.state.messages.logoutErrorUnknown)}}async register(t){if(!this.store.getters.loginEnabled)return Promise.reject(this.store.state.messages.loginErrorDisabled);this.store.commit(p.SET_LOGGED_IN,!1);try{const o=new URLSearchParams;switch(o.append("j_username",t.username||""),o.append("j_password",t.password||""),o.append("j_verify_password",t.password||""),o.append("j_passcode",t.code||""),(await je.fetchJSON(this.config.dynmap.register,{method:"POST",body:o})).result){case"success":this.store.commit(p.SET_LOGGED_IN,!0);return;case"verifyfailed":return Promise.reject(this.store.state.messages.registerErrorVerifyFailed);case"registerfailed":return Promise.reject(this.store.state.messages.registerErrorIncorrect);default:return Promise.reject(this.store.state.messages.registerErrorUnknown)}}catch(o){return console.error(this.store.state.messages.registerErrorUnknown),console.trace(o),Promise.reject(this.store.state.messages.registerErrorUnknown)}}destroy(){super.destroy(),this.configurationAbort&&this.configurationAbort.abort(),this.updateAbort&&this.updateAbort.abort(),this.markersAbort&&this.markersAbort.abort()}async getJSON(t,o){return Be.fetchJSON(t,{signal:o,credentials:"include"}).then(a=>{if(a.error==="login-required")throw this.store.commit(p.SET_LOGIN_REQUIRED,!0),new Error("Login required");return a})}}class G extends Be{constructor(t){super(t);h(this,"configurationAbort");h(this,"markersAbort");h(this,"playersAbort");h(this,"updatesEnabled",!1);h(this,"playerUpdateTimeout",null);h(this,"playerUpdateTimestamp",new Date);h(this,"playerUpdateInterval",3e3);h(this,"markerUpdateTimeout",null);h(this,"markerUpdateInterval",3e3);h(this,"worldPlayerUpdateIntervals",new Map);h(this,"worldMarkerUpdateIntervals",new Map);h(this,"worldComponents",new Map)}static buildServerConfig(t){var o,a,r;return{title:(((o=t.ui)==null?void 0:o.title)||"Pl3xmap").replace(St,""),expandUI:((r=(a=t.ui)==null?void 0:a.sidebar)==null?void 0:r.pinned)==="pinned",defaultZoom:1,defaultMap:void 0,defaultWorld:void 0,followMap:void 0,followZoom:void 0}}static buildMessagesConfig(t){var o,a,r,s;return{worldsHeading:((a=(o=t.ui)==null?void 0:o.sidebar)==null?void 0:a.world_list_label)||"",playersHeading:((s=(r=t.ui)==null?void 0:r.sidebar)==null?void 0:s.player_list_label)||"",chatPlayerJoin:"",chatPlayerQuit:"",chatAnonymousJoin:"",chatAnonymousQuit:"",chatErrorNotAllowed:"",chatErrorRequiresLogin:"",chatErrorCooldown:""}}buildWorlds(t,o){const a=[];return this.worldComponents.clear(),this.worldMarkerUpdateIntervals.clear(),this.worldPlayerUpdateIntervals.clear(),(t.worlds||[]).filter(s=>s&&!!s.name).sort((s,n)=>s.order-n.order).forEach((s,n)=>{var f,k,T,N,I,L,v,O,Y,V;const i=o[n],c={components:{}};if(this.worldMarkerUpdateIntervals.set(s.name,i.marker_update_interval||3e3),(f=i.player_tracker)==null?void 0:f.enabled){const R=!!((T=(k=i.player_tracker)==null?void 0:k.nameplates)==null?void 0:T.show_health),re=!!((I=(N=i.player_tracker)==null?void 0:N.nameplates)==null?void 0:I.show_armor),rt=!!((v=(L=i.player_tracker)==null?void 0:L.nameplates)==null?void 0:v.show_heads),st=i.player_tracker.update_interval?i.player_tracker.update_interval*1e3:3e3;this.worldPlayerUpdateIntervals.set(s.name,st),c.components.playerMarkers={grayHiddenPlayers:!0,hideByDefault:!!((O=i.player_tracker)==null?void 0:O.default_hidden),layerName:((Y=i.player_tracker)==null?void 0:Y.label)||"",layerPriority:(V=i.player_tracker)==null?void 0:V.priority,imageSize:rt?R&&re?"large":"small":"none",showHealth:R,showArmor:re,showYaw:!0}}else c.components.playerMarkers=void 0;if(this.worldComponents.set(s.name,c),!i){console.warn(`World ${s.name} has no matching world config. Ignoring.`);return}let d="overworld";s.type==="nether"?d="nether":s.type==="the_end"&&(d="end");const u=new Map,m={name:s.name||"(Unnamed world)",displayName:s.display_name||s.name,dimension:d,seaLevel:0,center:{x:i.spawn.x,y:0,z:i.spawn.z},defaultZoom:i.zoom.def||1,maps:u};u.set("flat",Object.freeze(new Ot({world:m,background:"transparent",backgroundDay:"transparent",backgroundNight:"transparent",icon:s.icon?`${this.config.pl3xmap}images/icon/${s.icon}.png`:void 0,imageFormat:"png",name:"flat",displayName:"Flat",nativeZoomLevels:i.zoom.max||1,extraZoomLevels:i.zoom.extra||0,tileUpdateInterval:i.tiles_update_interval?i.tiles_update_interval*1e3:void 0}))),a.push(m)}),Array.from(a.values())}static buildComponents(t){var a,r,s,n,i,c,d,u;const o={coordinatesControl:void 0,linkControl:!!((r=(a=t.ui)==null?void 0:a.link)==null?void 0:r.enabled),layerControl:!!((n=(s=t.ui)==null?void 0:s.coordinates)==null?void 0:n.enabled),playerMarkers:void 0,markers:{showLabels:!1},playerList:{showImages:!0},chatBox:void 0,chatBalloons:!1,clockControl:void 0,logoControls:[],login:!1};if((c=(i=t.ui)==null?void 0:i.coordinates)==null?void 0:c.enabled){const m=(((u=(d=t.ui)==null?void 0:d.coordinates)==null?void 0:u.html)||"Location: ").replace(/{x}.*{z}/gi,"").trim(),f=new DOMParser().parseFromString(m,"text/html").body.textContent||"";o.coordinatesControl={showY:!1,label:f,showRegion:!1,showChunk:!1}}return o}async getMarkerSets(t){const o=`${this.config.pl3xmap}tiles/${t.name}/markers.json`;this.markersAbort&&this.markersAbort.abort(),this.markersAbort=new AbortController;const a=await G.getJSON(o,this.markersAbort.signal),r=new Map;return Array.isArray(a)&&a.forEach(s=>{if(!s||!s.id){console.warn("Ignoring marker set without id");return}const n=s.id,i=Object.freeze(new Map),c=Object.freeze(new Map),d=Object.freeze(new Map),u=Object.freeze(new Map);(s.markers||[]).forEach(f=>{switch(f.type){case"icon":i.set(`marker-${i.size}`,G.buildMarker(f));break;case"polyline":u.set(`line-${u.size}`,G.buildLine(f));break;case"rectangle":d.set(`area-${d.size}`,G.buildRectangle(f));break;case"polygon":d.set(`area-${d.size}`,G.buildArea(f));break;case"circle":case"ellipse":c.set(`circle-${c.size}`,G.buildCircle(f));break;default:console.warn("Marker type "+f.type+" not supported")}});const m={id:n,label:s.name||"Unnamed set",hidden:s.hide||!1,priority:s.order||0,showLabels:!1,markers:i,circles:c,areas:d,lines:u};r.set(n,m)}),r}static buildMarker(t){var o,a;return Object.seal({location:{x:((o=t.point)==null?void 0:o.x)||0,y:0,z:((a=t.point)==null?void 0:a.z)||0},dimensions:t.size?[t.size.x||16,t.size.z||16]:[16,16],icon:t.icon||"default",label:(t.tooltip||"").trim(),isLabelHTML:!0})}static buildRectangle(t){return Object.seal({style:{stroke:typeof t.stroke!="undefined"?!!t.stroke:!0,color:t.color||"#3388ff",weight:t.weight||3,opacity:typeof t.opacity!="undefined"?t.opacity:1,fill:typeof t.stroke!="undefined"?!!t.stroke:!0,fillColor:t.fillColor||t.color||"#3388ff",fillOpacity:t.fillOpacity||.2,fillRule:t.fillRule},points:[t.points[0],{x:t.points[0].x,z:t.points[1].z},t.points[1],{x:t.points[1].x,z:t.points[0].z}],outline:!1,tooltipContent:t.tooltip,popupContent:t.popup,isPopupHTML:!0})}static buildArea(t){return Object.seal({style:{stroke:typeof t.stroke!="undefined"?!!t.stroke:!0,color:t.color||"#3388ff",weight:t.weight||3,opacity:typeof t.opacity!="undefined"?t.opacity:1,fill:typeof t.fill!="undefined"?!!t.fill:!0,fillColor:t.fillColor||t.color||"#3388ff",fillOpacity:t.fillOpacity||.2,fillRule:t.fillRule},points:t.points,outline:!1,tooltipContent:t.tooltip,popupContent:t.popup,isPopupHTML:!0})}static buildLine(t){return Object.seal({style:{stroke:typeof t.stroke!="undefined"?!!t.stroke:!0,color:t.color||"#3388ff",weight:t.weight||3,opacity:typeof t.opacity!="undefined"?t.opacity:1},points:t.points,tooltipContent:t.tooltip,popupContent:t.popup,isPopupHTML:!0})}static buildCircle(t){var o,a;return Object.seal({location:{x:((o=t.center)==null?void 0:o.x)||0,y:0,z:((a=t.center)==null?void 0:a.z)||0},radius:[t.radiusX||t.radius||0,t.radiusZ||t.radius||0],style:{stroke:typeof t.stroke!="undefined"?!!t.stroke:!0,color:t.color||"#3388ff",weight:t.weight||3,opacity:typeof t.opacity!="undefined"?t.opacity:1,fill:typeof t.stroke!="undefined"?!!t.stroke:!0,fillColor:t.fillColor||t.color||"#3388ff",fillOpacity:t.fillOpacity||.2,fillRule:t.fillRule},tooltipContent:t.tooltip,popupContent:t.popup,isPopupHTML:!0})}async loadServerConfiguration(){this.configurationAbort&&this.configurationAbort.abort(),this.configurationAbort=new AbortController;const t=this.config.pl3xmap,o=await G.getJSON(`${t}tiles/settings.json`,this.configurationAbort.signal);if(o.error)throw new Error(o.error);const a=G.buildServerConfig(o),r=(o.worlds||[]).filter(n=>n&&!!n.name).map(n=>n.name),s=await Promise.all(r.map(n=>G.getJSON(`${t}tiles/${n}/settings.json`,this.configurationAbort.signal)));this.store.commit(p.SET_SERVER_CONFIGURATION,a),this.store.commit(p.SET_SERVER_MESSAGES,G.buildMessagesConfig(o)),this.store.commit(p.SET_WORLDS,this.buildWorlds(o,s)),this.store.commit(p.SET_COMPONENTS,G.buildComponents(o))}async populateWorld(t){const o=await this.getMarkerSets(t),a=this.worldComponents.get(t.name);this.playerUpdateInterval=this.worldPlayerUpdateIntervals.get(t.name)||3e3,this.markerUpdateInterval=this.worldMarkerUpdateIntervals.get(t.name)||3e3,this.store.commit(p.SET_MARKER_SETS,o),this.store.commit(p.SET_COMPONENTS,a.components)}async getPlayers(){const t=`${this.config.pl3xmap}tiles/players.json`;this.playersAbort&&this.playersAbort.abort(),this.playersAbort=new AbortController;const o=await G.getJSON(t,this.playersAbort.signal),a=new Set;return(o.players||[]).forEach(r=>{a.add({name:(r.name||"").toLowerCase(),uuid:r.uuid,displayName:r.name||"",health:r.health||0,armor:r.armor||0,sort:0,hidden:!1,location:{x:isNaN(r.x)?0:r.x+.5,y:0,z:isNaN(r.z)?0:r.z+.5,world:r.world},yaw:isNaN(r.yaw)?0:parseFloat(r.yaw)+180})}),this.store.commit(p.SET_MAX_PLAYERS,o.max||0),a}startUpdates(){this.updatesEnabled=!0,this.updatePlayers(),this.updateMarkers()}async updatePlayers(){try{if(this.store.state.components.playerMarkers){const t=await this.getPlayers();this.playerUpdateTimestamp=new Date,await this.store.dispatch(U.SET_PLAYERS,t)}}finally{this.updatesEnabled&&(this.playerUpdateTimeout&&clearTimeout(this.playerUpdateTimeout),this.playerUpdateTimeout=setTimeout(()=>this.updatePlayers(),this.playerUpdateInterval))}}async updateMarkers(){}stopUpdates(){this.updatesEnabled=!1,this.markerUpdateTimeout&&clearTimeout(this.markerUpdateTimeout),this.playerUpdateTimeout&&clearTimeout(this.playerUpdateTimeout),this.markerUpdateTimeout=null,this.playerUpdateTimeout=null}getTilesUrl(){return`${this.config.pl3xmap}tiles/`}getPlayerHeadUrl(t){return"https://mc-heads.net/avatar/{uuid}/16".replace("{uuid}",t.uuid||"")}getMarkerIconUrl(t){return`${this.config.pl3xmap}images/icon/registered/${t}.png`}destroy(){super.destroy(),this.configurationAbort&&this.configurationAbort.abort(),this.playersAbort&&this.playersAbort.abort(),this.markersAbort&&this.markersAbort.abort()}}const Zo={[p.INIT](e,t){const o=localStorage.getItem("collapsedSections"),a=(t==null?void 0:t.messages)||{},r=(t==null?void 0:t.ui)||{};o&&(e.ui.sidebar.collapsedSections=new Set(JSON.parse(o)));const s={chatTitle:a.chatTitle||"",chatLogin:a.chatLogin||"",chatNoMessages:a.chatNoMessages||"",chatSend:a.chatSend||"",chatPlaceholder:a.chatPlaceholder||"",chatErrorDisabled:a.chatErrorDisabled||"",chatErrorUnknown:a.chatErrorUnknown||"",serversHeading:a.serversHeading||"",worldsSkeleton:a.worldsSkeleton||"",playersSkeleton:a.playersSkeleton||"",playersTitle:a.playersTitle||"",playersTitleHidden:a.playersTitleHidden||"",playersTitleOtherWorld:a.playersTitleOtherWorld||"",playersSearchPlaceholder:a.playersSearchPlaceholder||"",playersSearchSkeleton:a.playersSearchSkeleton||"",followingHeading:a.followingHeading||"",followingHidden:a.followingHidden||"",followingUnfollow:a.followingUnfollow||"",followingTitleUnfollow:a.followingTitleUnfollow||"",linkTitle:a.linkTitle||"",loadingTitle:a.loadingTitle||"",locationRegion:a.locationRegion||"",locationChunk:a.locationChunk||"",contextMenuCopyLink:a.contextMenuCopyLink||"",contextMenuCenterHere:a.contextMenuCenterHere||"",toggleTitle:a.toggleTitle||"",mapTitle:a.mapTitle||"",layersTitle:a.layersTitle||"",copyToClipboardSuccess:a.copyToClipboardSuccess||"",copyToClipboardError:a.copyToClipboardError||"",loginTitle:a.loginTitle||"",loginHeading:a.loginHeading||"",loginUsernameLabel:a.loginUsernameLabel||"",loginPasswordLabel:a.loginPasswordLabel||"",loginSubmit:a.loginSubmit||"",loginErrorUnknown:a.loginErrorUnknown||"",loginErrorDisabled:a.loginErrorDisabled||"",loginErrorIncorrect:a.loginErrorIncorrect||"",loginSuccess:a.loginSuccess||"",registerHeading:a.registerHeading||"",registerDescription:a.registerDescription||"",registerConfirmPasswordLabel:a.registerConfirmPasswordLabel||"",registerCodeLabel:a.registerCodeLabel||"",registerSubmit:a.registerSubmit||"",registerErrorUnknown:a.registerErrorUnknown||"",registerErrorDisabled:a.registerErrorDisabled||"",registerErrorVerifyFailed:a.registerErrorVerifyFailed||"",registerErrorIncorrect:a.registerErrorIncorrect||"",logoutTitle:a.logoutTitle||"",logoutErrorUnknown:a.logoutErrorUnknown||"",logoutSuccess:a.logoutSuccess||"",closeTitle:a.closeTitle||""};e.messages=Object.assign(e.messages,s),typeof r.playersAboveMarkers=="boolean"&&(e.ui.playersAboveMarkers=r.playersAboveMarkers),typeof r.compactPlayerMarkers=="boolean"&&(e.ui.compactPlayerMarkers=r.compactPlayerMarkers),typeof r.playersSearch=="boolean"&&(e.ui.playersSearch=r.playersSearch),e.servers=t.servers,e.currentServer&&!e.servers.has(e.currentServer.id)&&(e.currentServer=void 0)},[p.SET_SERVER_CONFIGURATION](e,t){e.configuration=Object.assign(e.configuration,t)},[p.SET_SERVER_CONFIGURATION_HASH](e,t){e.configurationHash=t},[p.SET_SERVER_MESSAGES](e,t){e.messages=Object.assign(e.messages,t)},[p.SET_WORLDS](e,t){e.worlds.clear(),e.maps.clear(),e.followTarget=void 0,e.panTarget=void 0,e.currentWorldState.timeOfDay=0,e.currentWorldState.raining=!1,e.currentWorldState.thundering=!1,t.forEach(o=>{e.worlds.set(o.name,o),o.maps.forEach(a=>e.maps.set([o.name,a.name].join("_"),a))}),e.currentWorld&&e.worlds.has(e.currentWorld.name)?e.currentWorld=e.worlds.get(e.currentWorld.name):e.currentWorld=void 0,e.currentWorld&&e.currentMap&&e.maps.has([e.currentWorld.name,e.currentMap.name].join("_"))?e.currentMap=e.maps.get([e.currentWorld.name,e.currentMap.name].join("_")):e.currentMap=void 0},[p.SET_COMPONENTS](e,t){e.components=Object.assign(e.components,t)},[p.SET_MARKER_SETS](e,t){e.markerSets.clear(),e.pendingSetUpdates.clear();for(const o of t)e.markerSets.set(o[0],o[1]),e.pendingSetUpdates.set(o[0],{markerUpdates:[],areaUpdates:[],circleUpdates:[],lineUpdates:[]})},[p.SET_WORLD_STATE](e,t){e.currentWorldState=Object.assign(e.currentWorldState,t)},[p.ADD_MARKER_SET_UPDATES](e,t){for(const o of t){if(!e.markerSets.has(o[0]))if(o[1].payload)e.markerSets.set(o[0],{id:o[0],showLabels:o[1].payload.showLabels,minZoom:o[1].payload.minZoom,maxZoom:o[1].payload.maxZoom,priority:o[1].payload.priority,label:o[1].payload.label,hidden:o[1].payload.hidden,markers:Object.freeze(new Map),areas:Object.freeze(new Map),circles:Object.freeze(new Map),lines:Object.freeze(new Map)}),e.pendingSetUpdates.set(o[0],{markerUpdates:[],areaUpdates:[],circleUpdates:[],lineUpdates:[]});else{console.warn(`ADD_MARKER_SET_UPDATES: Marker set ${o[0]} doesn't exist`);continue}const a=e.markerSets.get(o[0]),r=e.pendingSetUpdates.get(o[0]);if(o[1].removed){e.markerSets.delete(o[0]),e.pendingSetUpdates.delete(o[0]);continue}o[1].payload&&(a.showLabels=o[1].payload.showLabels,a.minZoom=o[1].payload.minZoom,a.maxZoom=o[1].payload.maxZoom,a.priority=o[1].payload.priority,a.label=o[1].payload.label,a.hidden=o[1].payload.hidden);for(const s of o[1].markerUpdates)s.removed?a.markers.delete(s.id):a.markers.set(s.id,s.payload);for(const s of o[1].areaUpdates)s.removed?a.areas.delete(s.id):a.areas.set(s.id,s.payload);for(const s of o[1].circleUpdates)s.removed?a.circles.delete(s.id):a.circles.set(s.id,s.payload);for(const s of o[1].lineUpdates)s.removed?a.lines.delete(s.id):a.lines.set(s.id,s.payload);r.markerUpdates=r.markerUpdates.concat(o[1].markerUpdates),r.areaUpdates=r.areaUpdates.concat(o[1].areaUpdates),r.circleUpdates=r.circleUpdates.concat(o[1].circleUpdates),r.lineUpdates=r.lineUpdates.concat(o[1].lineUpdates)}},[p.ADD_TILE_UPDATES](e,t){e.pendingTileUpdates=e.pendingTileUpdates.concat(t)},[p.ADD_CHAT](e,t){e.chat.messages.unshift(...t)},[p.POP_MARKER_UPDATES](e,{markerSet:t,amount:o}){if(!e.markerSets.has(t)){console.warn(`POP_MARKER_UPDATES: Marker set ${t} doesn't exist`);return}e.pendingSetUpdates.get(t).markerUpdates.splice(0,o)},[p.POP_AREA_UPDATES](e,{markerSet:t,amount:o}){if(!e.markerSets.has(t)){console.warn(`POP_AREA_UPDATES: Marker set ${t} doesn't exist`);return}e.pendingSetUpdates.get(t).areaUpdates.splice(0,o)},[p.POP_CIRCLE_UPDATES](e,{markerSet:t,amount:o}){if(!e.markerSets.has(t)){console.warn(`POP_CIRCLE_UPDATES: Marker set ${t} doesn't exist`);return}e.pendingSetUpdates.get(t).circleUpdates.splice(0,o)},[p.POP_LINE_UPDATES](e,{markerSet:t,amount:o}){if(!e.markerSets.has(t)){console.warn(`POP_LINE_UPDATES: Marker set ${t} doesn't exist`);return}e.pendingSetUpdates.get(t).lineUpdates.splice(0,o)},[p.POP_TILE_UPDATES](e,t){e.pendingTileUpdates.splice(0,t)},[p.SET_MAX_PLAYERS](e,t){e.maxPlayers=t},[p.SET_PLAYERS_ASYNC](e,t){let o=0;for(const a of t){if(e.players.has(a.name)){const r=e.players.get(a.name);r.health=a.health,r.uuid=a.uuid,r.armor=a.armor,r.location=Object.assign(r.location,a.location),r.yaw=a.yaw,r.hidden=a.hidden,r.displayName=a.displayName,r.sort=a.sort,(r.displayName!==a.displayName||r.sort!==a.sort)&&(e.sortedPlayers.dirty=!0)}else e.sortedPlayers.dirty=!0,e.players.set(a.name,{name:a.name,uuid:a.uuid,health:a.health,armor:a.armor,location:a.location,yaw:a.yaw,displayName:a.displayName,sort:a.sort,hidden:a.hidden});if(t.delete(a),++o>=10)break}return!t.size&&e.sortedPlayers.dirty&&(e.sortedPlayers=[...e.players.values()].sort((a,r)=>a.sort!==r.sort?a.sort-r.sort:a.name.toLowerCase().localeCompare(r.name.toLowerCase()))),t},[p.SYNC_PLAYERS](e,t){for(const[o,a]of e.players)t.has(a.name)||(e.sortedPlayers.splice(e.sortedPlayers.indexOf(a),1),e.players.delete(o))},[p.SET_CURRENT_SERVER](e,t){if(!e.servers.has(t))throw new RangeError(`Unknown server ${t}`);switch(e.currentServer=e.servers.get(t),e.currentMapProvider&&(e.currentMapProvider.stopUpdates(),e.currentMapProvider.destroy()),e.currentServer.type){case"pl3xmap":e.currentMapProvider=Object.seal(new G(e.servers.get(t)));break;case"dynmap":e.currentMapProvider=Object.seal(new je(e.servers.get(t)));break}},[p.SET_CURRENT_MAP](e,{worldName:t,mapName:o}){if(o=[t,o].join("_"),!e.worlds.has(t))throw new RangeError(`Unknown world ${t}`);if(!e.maps.has(o))throw new RangeError(`Unknown map ${o}`);const a=e.worlds.get(t);e.currentWorld!==a&&(e.currentWorld=e.worlds.get(t),e.markerSets.clear(),e.pendingSetUpdates.clear(),e.pendingTileUpdates=[]),e.currentMap=e.maps.get(o)},[p.SET_CURRENT_LOCATION](e,t){e.currentLocation=t},[p.SET_CURRENT_ZOOM](e,t){e.currentZoom=t},[p.SET_PARSED_URL](e,t){e.parsedUrl=t},[p.CLEAR_PARSED_URL](e){e.parsedUrl=void 0},[p.SET_FOLLOW_TARGET](e,t){e.followTarget=t},[p.SET_PAN_TARGET](e,t){e.panTarget=t},[p.CLEAR_FOLLOW_TARGET](e){e.followTarget=void 0},[p.CLEAR_PAN_TARGET](e){e.panTarget=void 0},[p.SET_SMALL_SCREEN](e,t){!e.ui.smallScreen&&t&&e.ui.visibleElements.size>1&&e.ui.visibleElements.clear(),e.ui.smallScreen=t},[p.TOGGLE_UI_ELEMENT_VISIBILITY](e,t){const o=!e.ui.visibleElements.has(t);o&&e.ui.smallScreen&&e.ui.visibleElements.clear(),e.ui.previouslyVisibleElements.add(t),o?e.ui.visibleElements.add(t):e.ui.visibleElements.delete(t)},[p.SET_UI_ELEMENT_VISIBILITY](e,t){t.state&&e.ui.smallScreen&&e.ui.visibleElements.clear(),(t.state||e.ui.visibleElements.has(t.element))&&e.ui.previouslyVisibleElements.add(t.element),t.state?e.ui.visibleElements.add(t.element):e.ui.visibleElements.delete(t.element)},[p.SHOW_UI_MODAL](e,t){e.ui.smallScreen&&e.ui.visibleElements.clear(),e.ui.visibleModal=t},[p.HIDE_UI_MODAL](e,t){e.ui.visibleModal===t&&(e.ui.visibleModal=void 0)},[p.TOGGLE_SIDEBAR_SECTION_COLLAPSED_STATE](e,t){e.ui.sidebar.collapsedSections.has(t)?e.ui.sidebar.collapsedSections.delete(t):e.ui.sidebar.collapsedSections.add(t)},[p.SET_LOGGED_IN](e,t){e.loggedIn=t},[p.SET_LOGIN_REQUIRED](e,t){t&&(e.loggedIn=!1),e.loginRequired=t},[p.RESET](e){e.followTarget=void 0,e.panTarget=void 0,e.players.clear(),e.sortedPlayers.splice(0,e.sortedPlayers.length),e.maxPlayers=0,e.currentWorld=void 0,e.currentMap=void 0,e.markerSets.clear(),e.pendingSetUpdates.clear(),e.pendingTileUpdates=[],e.worlds.clear(),e.maps.clear(),e.currentZoom=0,e.currentLocation={x:0,y:0,z:0},e.currentWorldState.timeOfDay=0,e.currentWorldState.raining=!1,e.currentWorldState.thundering=!1,e.configurationHash=void 0,e.configuration.title="",e.components.markers.showLabels=!1,e.components.playerMarkers=void 0,e.components.coordinatesControl=void 0,e.components.clockControl=void 0,e.components.linkControl=!1,e.components.layerControl=!1,e.components.logoControls=[],e.components.chatSending=void 0,e.components.chatBox=void 0,e.components.chatBalloons=!1,e.components.login=!1,e.ui.visibleModal=void 0,e.chat.messages=[],e.loggedIn=!1,e.loginRequired=!1}},Wo={version:"2.0.1",servers:new Map,configuration:{defaultMap:"",defaultWorld:"",defaultZoom:0,followMap:"",followZoom:0,title:"",expandUI:!1},configurationHash:void 0,messages:{chatPlayerJoin:"",chatPlayerQuit:"",chatAnonymousJoin:"",chatAnonymousQuit:"",chatNoMessages:"",chatTitle:"",chatLogin:"",chatSend:"",chatPlaceholder:"",chatErrorNotAllowed:"",chatErrorRequiresLogin:"",chatErrorCooldown:"",chatErrorDisabled:"",chatErrorUnknown:"",serversHeading:"",worldsHeading:"",worldsSkeleton:"",playersSkeleton:"",playersHeading:"",playersTitle:"",playersTitleHidden:"",playersTitleOtherWorld:"",playersSearchPlaceholder:"",playersSearchSkeleton:"",followingHeading:"",followingUnfollow:"",followingTitleUnfollow:"",followingHidden:"",linkTitle:"",loadingTitle:"",locationRegion:"",locationChunk:"",contextMenuCopyLink:"",contextMenuCenterHere:"",toggleTitle:"",mapTitle:"",layersTitle:"",copyToClipboardSuccess:"",copyToClipboardError:"",loginTitle:"",loginHeading:"",loginUsernameLabel:"",loginPasswordLabel:"",loginSubmit:"",loginErrorUnknown:"",loginErrorDisabled:"",loginErrorIncorrect:"",loginSuccess:"",registerHeading:"",registerDescription:"",registerConfirmPasswordLabel:"",registerCodeLabel:"",registerSubmit:"",registerErrorUnknown:"",registerErrorDisabled:"",registerErrorVerifyFailed:"",registerErrorIncorrect:"",logoutTitle:"",logoutErrorUnknown:"",logoutSuccess:"",closeTitle:""},loggedIn:!1,loginRequired:!1,worlds:new Map,maps:new Map,players:new Map,sortedPlayers:[],maxPlayers:0,chat:{unread:0,messages:[]},markerSets:new Map,pendingSetUpdates:new Map,pendingTileUpdates:[],components:{markers:{showLabels:!1},playerMarkers:void 0,playerList:{showImages:!1},coordinatesControl:void 0,clockControl:void 0,linkControl:!1,layerControl:!1,logoControls:[],chatSending:void 0,chatBox:void 0,chatBalloons:!1,login:!1},followTarget:void 0,panTarget:void 0,currentMapProvider:void 0,currentServer:void 0,currentWorld:void 0,currentMap:void 0,currentLocation:{x:0,y:0,z:0},currentZoom:0,currentWorldState:{raining:!1,thundering:!1,timeOfDay:0},ui:{playersAboveMarkers:!0,playersSearch:!0,compactPlayerMarkers:!1,smallScreen:!1,visibleElements:new Set,visibleModal:void 0,previouslyVisibleElements:new Set,sidebar:{collapsedSections:new Set}}},Go={async[U.LOAD_CONFIGURATION]({commit:e,state:t,dispatch:o}){var s,n;if(await o(U.STOP_UPDATES,void 0),e(p.RESET,void 0),!t.currentServer){console.warn("No current server");return}if(await t.currentMapProvider.loadServerConfiguration(),t.currentMap)return;!t.ui.visibleElements.size&&t.configuration.expandUI&&!t.ui.smallScreen&&(e(p.SET_UI_ELEMENT_VISIBILITY,{element:"players",state:!0}),e(p.SET_UI_ELEMENT_VISIBILITY,{element:"maps",state:!0}));let a,r;if(t.configuration.defaultWorld&&t.worlds.has(t.configuration.defaultWorld)&&(a=t.configuration.defaultWorld),((s=t.parsedUrl)==null?void 0:s.world)&&t.worlds.has(t.parsedUrl.world)&&(a=t.parsedUrl.world),a||(a=t.worlds.size?t.worlds.entries().next().value[1].name:void 0),a){const i=t.worlds.get(a);t.configuration.defaultMap&&i.maps.has(t.configuration.defaultMap)&&(r=t.configuration.defaultMap),((n=t.parsedUrl)==null?void 0:n.map)&&i.maps.has(t.parsedUrl.map)&&(r=t.parsedUrl.map),r||(r=i.maps.size?i.maps.entries().next().value[1].name:void 0)}a&&r&&e(p.SET_CURRENT_MAP,{worldName:a,mapName:r})},async[U.START_UPDATES]({state:e}){if(!e.currentWorld)return Promise.reject("No current world");e.currentMapProvider.startUpdates()},async[U.STOP_UPDATES]({state:e}){e.currentMapProvider.stopUpdates()},[U.SET_PLAYERS]({commit:e,state:t},o){const a=new Set;for(const s of o)a.add(s.name);e(p.SYNC_PLAYERS,a);const r=(s,n)=>{e(p.SET_PLAYERS_ASYNC,s),s.size?requestAnimationFrame(()=>r(s,n)):n()};return new Promise(s=>{requestAnimationFrame(()=>r(o,s))})},async[U.POP_MARKER_UPDATES]({commit:e,state:t},{markerSet:o,amount:a}){if(!t.markerSets.has(o))return console.warn(`POP_MARKER_UPDATES: Marker set ${o} doesn't exist`),[];const r=t.pendingSetUpdates.get(o).markerUpdates.slice(0,a);return e(p.POP_MARKER_UPDATES,{markerSet:o,amount:a}),r},async[U.POP_AREA_UPDATES]({commit:e,state:t},{markerSet:o,amount:a}){if(!t.markerSets.has(o))return console.warn(`POP_AREA_UPDATES: Marker set ${o} doesn't exist`),[];const r=t.pendingSetUpdates.get(o).areaUpdates.slice(0,a);return e(p.POP_AREA_UPDATES,{markerSet:o,amount:a}),r},async[U.POP_CIRCLE_UPDATES]({commit:e,state:t},{markerSet:o,amount:a}){if(!t.markerSets.has(o))return console.warn(`POP_CIRCLE_UPDATES: Marker set ${o} doesn't exist`),[];const r=t.pendingSetUpdates.get(o).circleUpdates.slice(0,a);return e(p.POP_CIRCLE_UPDATES,{markerSet:o,amount:a}),r},async[U.POP_LINE_UPDATES]({commit:e,state:t},{markerSet:o,amount:a}){if(!t.markerSets.has(o))return console.warn(`POP_LINE_UPDATES: Marker set ${o} doesn't exist`),[];const r=t.pendingSetUpdates.get(o).lineUpdates.slice(0,a);return e(p.POP_LINE_UPDATES,{markerSet:o,amount:a}),r},async[U.POP_TILE_UPDATES]({commit:e,state:t},o){const a=t.pendingTileUpdates.slice(0,o);return e(p.POP_TILE_UPDATES,o),a},async[U.SEND_CHAT_MESSAGE]({commit:e,state:t},o){await t.currentMapProvider.sendChatMessage(o)},async[U.LOGIN]({state:e,commit:t},o){await e.currentMapProvider.login(o)},async[U.LOGOUT]({state:e}){await e.currentMapProvider.logout()},async[U.REGISTER]({state:e},t){await e.currentMapProvider.register(t)}},q=no({state:Wo,mutations:Zo,getters:So,actions:Go});function _(){return q}const Fo=g.exports.Util.falseFn,_t=class extends g.exports.TileLayer{constructor(t,o){super(t,o);h(this,"_mapSettings");h(this,"tileTemplate");h(this,"loadQueue",[]);h(this,"loadingTiles",Object.seal(new Set));if(this._mapSettings=o.mapSettings,this.tileTemplate=g.exports.DomUtil.create("img","leaflet-tile"),this.tileTemplate.style.width=this.tileTemplate.style.height=this.options.tileSize+"px",this.tileTemplate.alt="",this.tileTemplate.tileName="",this.tileTemplate.callback=Fo,this.tileTemplate.setAttribute("role","presentation"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(this.tileTemplate.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),Object.seal(this.tileTemplate),o.maxZoom=this._mapSettings.nativeZoomLevels+this._mapSettings.extraZoomLevels,o.maxNativeZoom=this._mapSettings.nativeZoomLevels,o.zoomReverse=!0,o.tileSize=128,o.minZoom=0,g.exports.Util.setOptions(this,o),o.mapSettings===null)throw new TypeError("mapSettings missing")}createTile(t,o){const a=this.tileTemplate.cloneNode(!1);return this.loadQueue.push(a),a.onload=()=>{URL.revokeObjectURL(a.src),this._tileOnLoad(o,a),this.loadingTiles.delete(a),this.tickLoadQueue()},a.onerror=()=>{this._tileOnError(o,a,_t.genericLoadError),this.loadingTiles.delete(a),this.tickLoadQueue()},a.url=this.getTileUrl(t),a.callback=o,this.tickLoadQueue(),a}async fetchTile(t){t.abortController&&!t.abortController.signal.aborted&&t.abortController.abort(),t.abortController=new AbortController;try{const o=await fetch(t.url,{signal:t.abortController.signal});if(!o.ok){this._tileOnError(t.callback,t,new Error("Response was not ok"));return}const a=await o.blob();t.src=URL.createObjectURL(a)}catch(o){if(o instanceof DOMException&&o.name==="AbortError")return;console.error(o),this._tileOnError(t.callback,t,o)}}tickLoadQueue(){if(this.loadingTiles.size>6)return;const t=this.loadQueue.shift();!t||(this.loadingTiles.add(t),this.fetchTile(t))}refresh(){for(const t in this._tiles){if(!Object.prototype.hasOwnProperty.call(this._tiles,t))continue;const o=this._tiles[t];o.loaded&&this.loadQueue.push(o.el)}this.tickLoadQueue()}_abortLoading(){let t;for(const o in this._tiles)!Object.prototype.hasOwnProperty.call(this._tiles,o)||(t=this._tiles[o],t.coords.z!==this._tileZoom&&(!t.loaded&&t.el&&t.el.abortController&&t.el.abortController.abort(),this.loadQueue.includes(t.el)&&this.loadQueue.splice(this.loadQueue.indexOf(t.el),1),this.loadingTiles.delete(t.el)));super._abortLoading.call(this)}_removeTile(t){const o=this._tiles[t];!o||(this.loadingTiles.delete(o.el),this.loadQueue.includes(o.el)&&this.loadQueue.splice(this.loadQueue.indexOf(o.el),1),o.el.onerror=null,o.el.onload=null,!o.loaded&&o.el.abortController&&o.el.abortController.abort(),super._removeTile(t))}};let Qe=_t;h(Qe,"genericLoadError",new Error("Tile failed to load"));const Je=_();class qo extends Qe{constructor(t){super("",t);h(this,"_namedTiles");h(this,"_baseUrl");h(this,"_night");h(this,"_pendingUpdates");h(this,"_nightUnwatch",null);h(this,"_updateUnwatch",null);h(this,"_updateFrame",0);this._mapSettings=t.mapSettings,this._baseUrl=Je.state.currentMapProvider.getTilesUrl(),this._namedTiles=Object.seal(new Map),this._pendingUpdates=l(()=>!!Je.state.pendingTileUpdates.length),this._night=l(()=>Je.getters.night)}onAdd(t){return super.onAdd(t),this._updateUnwatch=C(this._pendingUpdates,(o,a)=>{o&&!a&&!this._updateFrame&&this.handlePendingUpdates()}),this._nightUnwatch=C(this._night,()=>{this._mapSettings.nightAndDay&&this.redraw()}),this}getTileName(t){const o=this.getTileInfo(t);return o.y=-o.y,o.scaledy=o.y>>5,`${o.prefix}${o.nightday}/${o.scaledx}_${o.scaledy}/${o.zoom}${o.x}_${o.y}.${o.fmt}`}getTileUrl(t){return this.getTileUrlFromName(this.getTileName(t))}getTileUrlFromName(t,o){const a=escape(`${this._mapSettings.world.name}/${t}`);let r=`${this._baseUrl}${a}`;return typeof o!="undefined"&&(r+=r.indexOf("?")===-1?`?timestamp=${o}`:`&timestamp=${o}`),r}updateNamedTile(t,o){const a=this._namedTiles.get(t);a&&(a.classList.remove("leaflet-tile-loaded"),a.dataset.src=this.getTileUrlFromName(t,o),this.loadQueue.push(a),this.tickLoadQueue())}createTile(t,o){const a=super.createTile(t,o);return a.tileName=this.getTileName(t),this._namedTiles.set(a.tileName,a),a}_abortLoading(){let t;for(const o in this._tiles)!Object.prototype.hasOwnProperty.call(this._tiles,o)||(t=this._tiles[o],t.coords.z!==this._tileZoom&&t.loaded&&t.el&&t.el.tileName&&this._namedTiles.delete(t.el.tileName));super._abortLoading.call(this)}_removeTile(t){const o=this._tiles[t];if(!o)return;const a=o.el.tileName;a&&this._namedTiles.delete(a),super._removeTile.call(this,t)}zoomprefix(t){return"z".repeat(t)+(t===0?"":"_")}getTileInfo(t){const o=this._getZoomForUrl(),a=Math.max(0,o-this._mapSettings.extraZoomLevels),r=1<<a,s=r*t.x,n=r*t.y;return{prefix:this._mapSettings.prefix,nightday:this._mapSettings.nightAndDay&&!this._night.value?"_day":"",scaledx:s>>5,scaledy:n>>5,zoom:this.zoomprefix(a),zoomprefix:a==0?"":this.zoomprefix(a)+"_",x:s,y:n,fmt:this._mapSettings.imageFormat||"png"}}async handlePendingUpdates(){const t=await Je.dispatch(U.POP_TILE_UPDATES,10);for(const o of t)this.updateNamedTile(o.name,o.timestamp);this._pendingUpdates.value?this._updateFrame=requestAnimationFrame(()=>this.handlePendingUpdates()):this._updateFrame=0}remove(){return super.remove(),this._nightUnwatch&&this._nightUnwatch(),this._updateFrame&&cancelAnimationFrame(this._updateFrame),this._updateUnwatch&&this._updateUnwatch(),this}}class Vo extends Qe{constructor(t){const o=t.mapSettings.world.name,a=_().state.currentMapProvider.getTilesUrl();super(`${a}${o}/{z}/{x}_{y}.png`,t);t.tileSize=512,t.zoomReverse=!1,g.exports.Util.setOptions(this,t)}}const Ko=M({props:{name:{type:String,required:!0},map:{type:Object,required:!0},leaflet:{type:Object,required:!0}},setup(e){var c;const t=_(),o=l(()=>e.map===t.state.currentMap);let a=null,r;const s=()=>{o.value&&r.refresh(),a=setTimeout(s,e.map.tileUpdateInterval)};((c=t.state.currentServer)==null?void 0:c.type)==="dynmap"?r=new qo({errorTileUrl:"images/blank.png",mapSettings:Object.freeze(JSON.parse(JSON.stringify(e.map)))}):r=new Vo({errorTileUrl:"images/blank.png",mapSettings:Object.freeze(JSON.parse(JSON.stringify(e.map)))});const n=()=>{e.leaflet.addLayer(r)},i=()=>{r.remove()};C(o,d=>d?n():i()),o.value&&n(),e.map.tileUpdateInterval&&(a=setTimeout(s,e.map.tileUpdateInterval)),Z(()=>{i(),a&&clearTimeout(a)})},render(){return null}});var Ze="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAXVBMVEUrHQ1DIAxsQi29jXOqfWYnGwr///9SPYm7iXK0hG20e2ScaUyQXkCKTD2CVDpAKhMzJBEvHw7GloC3gnKtgG22iWy+iGycclysdlqiakecY0aWX0CAUzR6TjMkGAjN/gIgAAAAbElEQVQY02XKRw7AIAxEUTuYGkJI79z/mDESO39pNk8D0wQ8rUvRGjgBrZxHDqCihG1Tap4Vd545SyDynmhdj8O5npPgvTHWhuCctcYQSbjvEJal4/b9ut5XQozPgzhwiDGmJKGesZXS9wn4AR4zCfm0oDjBAAAAAElFTkSuQmCC";const gt=document.createElement("img");gt.src=Ze;gt.className="player__icon";class Yo extends g.exports.Layer{constructor(t,o){super(o);h(this,"_player");h(this,"_container");h(this,"_playerImage");h(this,"_playerInfo");h(this,"_playerName");h(this,"_currentName");h(this,"_playerHealth");h(this,"_playerArmor");h(this,"_playerYaw");h(this,"_currentYaw",0);g.exports.Util.setOptions(this,o),this._player=t}createIcon(t){return t&&g.exports.DomUtil.remove(t),this._currentName=void 0,this._container=document.createElement("div"),this._container.classList.add("marker","marker--player","leaflet-marker-icon"),this._playerInfo=document.createElement("div"),this._playerInfo.className="marker__label",this._playerName=document.createElement("span"),this._playerName.className="player__name",this.options.compact&&this._container.classList.add("marker--compact"),this.options.imageSize!="none"&&(this._playerImage=gt.cloneNode(),this._playerImage.height=this._playerImage.width=kt(this.options.imageSize),Ve(this._player,this.options.imageSize).then(o=>{this._playerImage.src=o.src}).catch(()=>{}),this._playerInfo.appendChild(this._playerImage)),this._playerInfo.appendChild(this._playerName),this.options.showHealth&&(this._playerHealth=document.createElement("meter"),this._playerHealth.className="player__health",this._playerHealth.hidden=!0,this._playerHealth.max=20,this._playerInfo.appendChild(this._playerHealth)),this.options.showArmor&&(this._playerArmor=document.createElement("meter"),this._playerArmor.className="player__armor",this._playerArmor.hidden=!0,this._playerArmor.max=20,this._playerInfo.appendChild(this._playerArmor)),this.options.showYaw&&(this._container.classList.add("player--yaw"),this._playerYaw=document.createElement("div"),this._playerYaw.className="player__yaw",this._container.appendChild(this._playerYaw)),this._container.appendChild(this._playerInfo),this.update(),this._container}createShadow(t){return null}update(){if(!!this._container&&(this._player.displayName!==this._currentName&&(this._playerName.innerHTML=this._currentName=this._player.displayName),this.options.showHealth&&(this._player.health!==void 0?(this._playerHealth.hidden=!1,this._playerHealth.value=this._player.health):this._playerHealth.hidden=!0),this.options.showArmor&&(this._player.armor!==void 0?(this._playerArmor.hidden=!1,this._playerArmor.value=this._player.armor):this._playerArmor.hidden=!0),this.options.showYaw&&this._player.yaw!==void 0)){const t=((this._player.yaw-this._currentYaw)%360+540)%360-180;this._currentYaw=this._currentYaw+t,this._playerYaw.style.setProperty("--player-yaw",`${this._currentYaw}deg`)}}}class Qo extends g.exports.Marker{constructor(t,o){super(new g.exports.LatLng(0,0),o);h(this,"_PlayerIcon");h(this,"_player");h(this,"_playerUnwatch");this._player=t,this._PlayerIcon=o.icon=new Yo(t,{imageSize:o.imageSize,showHealth:o.showHealth,showArmor:o.showArmor,showYaw:o.showYaw,compact:o.compact}),g.exports.Util.setOptions(this,o)}onAdd(t){return this._playerUnwatch=C(this._player,()=>this._PlayerIcon.update(),{deep:!0}),super.onAdd(t)}onRemove(t){return this._playerUnwatch&&this._playerUnwatch(),super.onRemove(t)}_resetZIndex(){}}const Jo=M({props:{player:{type:Object,required:!0},layerGroup:{type:Object,required:!0}},setup(e){let t=0;const o=_(),a=l(()=>o.state.components.playerMarkers),r=l(()=>o.state.currentMap),s=l(()=>o.state.currentWorld),n=l(()=>o.state.components.chatBalloons),i=S(!1),c=new Qo(e.player,{compact:o.state.ui.compactPlayerMarkers,imageSize:a.value.imageSize,showHealth:a.value.showHealth,showArmor:a.value.showArmor,showYaw:a.value.showYaw,pane:"players"}),d=new g.exports.Popup({autoClose:!1,autoPan:!1,keepInView:!1,closeButton:!1,closeOnEscapeKey:!1,closeOnClick:!1,className:"leaflet-popup--chat",minWidth:0}),u=S(!1),m=S(null),f=l(()=>{const L=[];if(!n.value)return L;for(const v of o.state.chat.messages){if(v.timestamp<=t||L.length===5)break;v.type==="chat"&&v.playerAccount===e.player.name&&L.push(v)}return!L.length&&o.state.chat.messages.length&&(t=o.state.chat.messages[0].timestamp),L}),k=()=>{const L=f.value.reduceRight((v,O)=>v+`<span>${O.message}</span>`,"");(L!=d.getContent()||!u.value)&&(d.setContent(L),u.value||(e.layerGroup.addLayer(d),u.value=!0,t=f.value[f.value.length-1].timestamp-1),m.value&&clearTimeout(m.value),m.value=setTimeout(()=>T(),8e3))},T=()=>{e.layerGroup.removeLayer(d),u.value=!1,f.value[0]&&(t=f.value[0].timestamp)},N=()=>{if(r.value&&!i.value){const L=r.value.locationToLatLng(e.player.location);e.layerGroup.addLayer(c),c.setLatLng(L),d.setLatLng(L),i.value=!0,t=new Date().getTime()}},I=()=>{i.value&&(e.layerGroup.removeLayer(c),e.layerGroup.removeLayer(d),i.value=!1,T(),m.value&&clearTimeout(m.value))};return H(()=>{r.value&&s.value.name===e.player.location.world&&N()}),Z(()=>I()),{componentSettings:a,currentMap:r,currentWorld:s,chatBalloonsEnabled:n,marker:c,markerVisible:i,chatBalloon:d,playerChat:f,updateChatBalloon:k,enableLayer:N,disableLayer:I}},watch:{player:{deep:!0,handler(e){if(this.currentMap&&e.location.world===this.currentWorld.name)if(!this.markerVisible)this.enableLayer();else{const t=this.currentMap.locationToLatLng(e.location);this.marker.setLatLng(t),this.chatBalloon.setLatLng(t)}else this.markerVisible&&this.disableLayer()}},playerChat(e){!this.chatBalloonsEnabled||!this.markerVisible||!e.length||this.updateChatBalloon()},currentWorld(e){e&&e.name===this.player.location.world?this.enableLayer():this.markerVisible&&this.disableLayer()},currentMap(e){if(e){const t=e.locationToLatLng(this.player.location);this.marker.setLatLng(t),this.chatBalloon.setLatLng(t)}}},render(){return null}});var x=(e,t)=>{const o=e.__vccOpts||e;for(const[a,r]of t)o[a]=r;return o};const Xo=M({components:{PlayerMarker:Jo},props:{leaflet:{type:Object,required:!0}},setup(e){const t=_(),o=e.leaflet.getPane("players")||e.leaflet.createPane("players"),a=l(()=>t.state.players),r=l(()=>t.state.players.size),s=l(()=>t.state.ui.playersAboveMarkers),n=l(()=>t.state.components.playerMarkers),i=new g.exports.LayerGroup([],{pane:"players"});return C(r,c=>o.classList.toggle("no-animations",c>150)),H(()=>{n.value.hideByDefault?e.leaflet.getLayerManager().addHiddenLayer(i,t.state.components.playerMarkers.layerName,n.value.layerPriority):e.leaflet.getLayerManager().addLayer(i,!0,t.state.components.playerMarkers.layerName,n.value.layerPriority)}),Z(()=>e.leaflet.getLayerManager().removeLayer(i)),s.value&&(o.style.zIndex="600"),{players:a,componentSettings:n,layerGroup:i}},render(){return null}});function ea(e,t,o,a,r,s){const n=E("PlayerMarker");return y(!0),b(j,null,Q(e.players,([i,c])=>(y(),z(n,{key:i,player:c,layerGroup:e.layerGroup},null,8,["player","layerGroup"]))),128)}var ta=x(Xo,[["render",ea]]);const oa=M({props:{set:{type:Object,required:!0},layerGroup:{type:Object,required:!0}},setup(e){let t=0;const o=_(),a=l(()=>o.state.currentMap),r=l(()=>{const d=o.state.pendingSetUpdates.get(e.set.id);return d&&d.areaUpdates.length}),s=Object.freeze(new Map),n=()=>{const d=a.value.locationToLatLng.bind(a.value);e.set.areas.forEach((u,m)=>{const f=It(u,d);s.set(m,f),e.layerGroup.addLayer(f)})},i=d=>{let u=s.get(d);!u||(e.layerGroup.removeLayer(u),s.delete(d))},c=async()=>{const d=await o.dispatch(U.POP_AREA_UPDATES,{markerSet:e.set.id,amount:10}),u=a.value.locationToLatLng.bind(a.value);for(const m of d)if(m.removed)i(m.id);else{const f=Ut(s.get(m.id),m.payload,u);s.has(m.id)||e.layerGroup.addLayer(f),s.set(m.id,f)}r.value?t=requestAnimationFrame(()=>c()):t=0};C(a,(d,u)=>{if(d&&(!u||u.world===d.world)){const m=d.locationToLatLng.bind(d);for(const[f,k]of e.set.areas)Ut(s.get(f),k,m)}}),C(r,(d,u)=>{d&&d>0&&u===0&&!t&&(t=requestAnimationFrame(()=>c()))}),H(()=>n()),Z(()=>t&&cancelAnimationFrame(t))},render(){return null}}),Bt=(e,t)=>{const o=!e.style.fillOpacity||e.style.fillOpacity<=0,a=Zt(e,t,o),r=o?new pt(a,e):new Pt(a,e);return e.popupContent&&r.bindPopup(()=>se(e,"CirclePopup")),e.tooltipContent&&r.bindTooltip(()=>e.tooltipContent,mt),r},jt=(e,t,o)=>{if(!e)return Bt(t,o);const a=t.style&&t.style.fillOpacity&&t.style.fillOpacity<=0;return e.closePopup(),e.unbindPopup(),e.bindPopup(()=>se(t,"CirclePopup")),e.setStyle(t.style),e.setLatLngs(Zt(t,o,a)),e.redraw(),e},Zt=(e,t,o)=>{const a=[];for(let r=0;r<360;r++){const s=r*Math.PI/180,n=e.radius[0]*Math.sin(s)+e.location.x,i=e.radius[1]*Math.cos(s)+e.location.z;a.push(t({x:n,y:e.location.y,z:i}))}return o&&a.length&&a.push(a[0]),a},aa=M({props:{set:{type:Object,required:!0},layerGroup:{type:Object,required:!0}},setup(e){let t=0;const o=_(),a=l(()=>o.state.currentMap),r=l(()=>{const d=o.state.pendingSetUpdates.get(e.set.id);return d&&d.circleUpdates.length}),s=Object.freeze(new Map),n=()=>{const d=a.value.locationToLatLng.bind(o.state.currentMap);e.set.circles.forEach((u,m)=>{const f=Bt(u,d);s.set(m,f),e.layerGroup.addLayer(f)})},i=d=>{let u=s.get(d);!u||(e.layerGroup.removeLayer(u),s.delete(d))},c=async()=>{const d=await o.dispatch(U.POP_CIRCLE_UPDATES,{markerSet:e.set.id,amount:10}),u=a.value.locationToLatLng.bind(o.state.currentMap);for(const m of d)if(m.removed)i(m.id);else{const f=jt(s.get(m.id),m.payload,u);s.has(m.id)||e.layerGroup.addLayer(f),s.set(m.id,f)}r.value?t=requestAnimationFrame(()=>c()):t=0};C(a,(d,u)=>{if(d&&(!u||u.world===d.world)){const m=a.value.locationToLatLng.bind(o.state.currentMap);for(const[f,k]of e.set.circles)jt(s.get(f),k,m)}}),C(r,(d,u)=>{d&&d>0&&u===0&&!t&&(t=requestAnimationFrame(()=>c()))}),H(()=>n()),Z(()=>t&&cancelAnimationFrame(t))},render(){return null}}),ra=M({props:{set:{type:Object,required:!0},layerGroup:{type:Object,required:!0}},setup(e){let t=0;const o=_(),a=l(()=>o.state.currentMap),r=l(()=>{const d=o.state.pendingSetUpdates.get(e.set.id);return d&&d.lineUpdates.length}),s=Object.freeze(new Map),n=()=>{const d=a.value.locationToLatLng.bind(o.state.currentMap);e.set.lines.forEach((u,m)=>{const f=$t(u,d);s.set(m,f),e.layerGroup.addLayer(f)})},i=d=>{let u=s.get(d);!u||(e.layerGroup.removeLayer(u),s.delete(d))},c=async()=>{const d=await o.dispatch(U.POP_LINE_UPDATES,{markerSet:e.set.id,amount:10}),u=a.value.locationToLatLng.bind(o.state.currentMap);for(const m of d)if(m.removed)i(m.id);else{const f=zt(s.get(m.id),m.payload,u);s.has(m.id)||e.layerGroup.addLayer(f),s.set(m.id,f)}r.value?t=requestAnimationFrame(()=>c()):t=0};C(a,(d,u)=>{if(d&&(!u||u.world===d.world)){const m=a.value.locationToLatLng.bind(o.state.currentMap);for(const[f,k]of e.set.lines)zt(s.get(f),k,m)}}),C(r,(d,u)=>{d&&d>0&&u===0&&!t&&(t=requestAnimationFrame(()=>c()))}),H(()=>n()),Z(()=>t&&cancelAnimationFrame(t))},render(){return null}}),Wt=document.createElement("div");Wt.className="marker";const Gt=document.createElement("img");Gt.className="marker__icon";const Ft=document.createElement("span");Ft.className="marker__label";const sa={icon:"default",label:"",iconSize:[16,16],popupAnchor:[0,0],iconAnchor:[0,0],tooltipAnchor:[0,0],isHtml:!1,className:""};class qt extends g.exports.Layer{constructor(t){super(t);h(this,"_image");h(this,"_label");h(this,"_container");h(this,"_labelCreated",!1);h(this,"_onHover",()=>{this.createLabel()});g.exports.Util.setOptions(this,Object.assign(sa,t))}createIcon(t){t&&g.exports.DomUtil.remove(t);const o=Wt.cloneNode(!1),a=_().state.currentMapProvider.getMarkerIconUrl(this.options.icon),r=g.exports.point(this.options.iconSize);return this._image=Gt.cloneNode(!1),this._image.width=r.x,this._image.height=r.y,this._image.src=a,o.appendChild(this._image),o.style.marginLeft=`${-(r.x/2)}px`,o.style.marginTop=`${-(r.y/2)}px`,o.style.height=`${r.y}px`,o.classList.add("marker","leaflet-marker-icon"),this.options.className&&o.classList.add(this.options.className),this._image.addEventListener("mouseover",this._onHover),this._container=o,o}createShadow(t){return null}createLabel(){var a;if(!this._container||this._labelCreated)return;(a=this._image)==null||a.removeEventListener("mouseover",this._onHover);const t=g.exports.point(this.options.iconSize),o=[t.x,t.y].join("x");this._label=Ft.cloneNode(!1),this._label.classList.add(`marker__label--${o}`),this.options.isHtml?this._label.innerHTML=this.options.label:this._label.textContent=this.options.label,this._container.appendChild(this._label),this._labelCreated=!0}removeLabel(){!this._container||!this._labelCreated||(this._label.remove(),this._label=void 0,this._labelCreated=!1)}update(t){this._image&&t.icon!==this.options.icon&&(this._image.src=_().state.currentMapProvider.getMarkerIconUrl(this.options.icon),this.options.icon=t.icon);const o=g.exports.point(t.iconSize||[16,16]),a=g.exports.point(this.options.iconSize);this._image&&(o.x!==a.x||o.y!==a.y)&&(this._image.width=o.x,this._image.height=o.y,this.options.iconSize=t.iconSize),this._label&&(t.label!==this.options.label||t.isHtml!==this.options.isHtml)&&(t.isHtml?this._label.innerHTML=t.label:this._label.textContent=t.label,this.options.isHtml=t.isHtml,this.options.label=t.label)}}class Xe extends g.exports.Marker{constructor(t,o){super(t,{});this.options.icon=new qt({icon:o.icon,label:o.label,iconSize:o.dimensions,isHtml:o.isLabelHTML}),this.options.maxZoom=o.maxZoom,this.options.minZoom=o.maxZoom}_resetZIndex(){}getIcon(){return this.options.icon}createLabel(){this.options.icon.createLabel()}removeLabel(){this.options.icon.createLabel()}onRemove(t){return this.options.icon.removeLabel(),super.onRemove(t),this}}const Vt=(e,t)=>{const o=new Xe(t(e.location),e);return o.on("click",a=>{(!a.target.getPopup()||a.target.isPopupOpen())&&a.target._map.panTo(a.target.getLatLng())}),e.popupContent&&o.bindPopup(()=>Yt(e)),o},Kt=(e,t,o)=>{if(!e)return Vt(t,o);const a=e.getLatLng(),r=o(t.location);if(a.equals(r)||e.setLatLng(r),e instanceof Xe){const s=e.getIcon();s&&s instanceof qt&&s.update({icon:t.icon,label:t.label,iconSize:t.dimensions,isHtml:t.isLabelHTML})}return e.closePopup(),e.unbindPopup(),t.popupContent&&e.bindPopup(()=>Yt(t)),e},Yt=e=>{const t=document.createElement("span");return e.popupContent&&(t.classList.add("MarkerPopup"),t.insertAdjacentHTML("afterbegin",e.popupContent)),t},na=M({props:{set:{type:Object,required:!0},layerGroup:{type:Object,required:!0}},setup(e){let t=0;const o=_(),a=l(()=>o.state.currentMap),r=l(()=>{const d=o.state.pendingSetUpdates.get(e.set.id);return d&&d.markerUpdates.length}),s=Object.freeze(new Map),n=()=>{const d=a.value.locationToLatLng.bind(o.state.currentMap);e.set.markers.forEach((u,m)=>{const f=Vt(u,d);s.set(m,f),e.layerGroup.addLayer(f)})},i=d=>{let u=s.get(d);!u||(e.layerGroup.removeLayer(u),s.delete(d))},c=async()=>{const d=await o.dispatch(U.POP_MARKER_UPDATES,{markerSet:e.set.id,amount:10}),u=a.value.locationToLatLng.bind(o.state.currentMap);for(const m of d)if(m.removed)i(m.id);else{const f=Kt(s.get(m.id),m.payload,u);s.has(m.id)||e.layerGroup.addLayer(f),s.set(m.id,f)}r.value?t=requestAnimationFrame(()=>c()):t=0};C(a,(d,u)=>{if(d&&(!u||u.world===d.world)){const m=a.value.locationToLatLng.bind(o.state.currentMap);for(const[f,k]of e.set.markers)Kt(s.get(f),k,m)}}),C(r,(d,u)=>{d&&d>0&&u===0&&!t&&(t=requestAnimationFrame(()=>c()))}),H(()=>n()),Z(()=>t&&cancelAnimationFrame(t))},render(){return null}});class ne extends g.exports.LayerGroup{constructor(t){super([],t);h(this,"_zoomLimitedLayers");h(this,"_markerPane");h(this,"_zoomEndCallback",()=>this._updateLayerVisibility());g.exports.Util.setOptions(this,t),this._zoomLimitedLayers=new Set}onAdd(t){return t.on("zoomend",this._zoomEndCallback,this),this._map=t,this._markerPane=t.getPane(`${this.options.id}-markers`)||t.createPane(`${this.options.id}-markers`),this._markerPane.classList.toggle("leaflet-pane--show-labels",this.options.showLabels),this._markerPane.style.zIndex=(401+this.options.priority).toString(),this._updateLayerVisibility(!0),this}onRemove(t){return super.onRemove(t),t.off("zoomend",this._zoomEndCallback,this),this}clearLayers(){return this._zoomLimitedLayers.clear(),super.clearLayers()}addLayer(t){const o=this.getLayerId(t);this._layers[o]=t,t instanceof g.exports.Marker?t.options.pane=`${this.options.id}-markers`:t instanceof g.exports.Path&&(t.options.pane="vectors");const a=ne._isLayerZoomLimited(t);return a&&this._zoomLimitedLayers.add(t),this._map&&(a?ne._isLayerVisible(t,this._map.getZoom())&&this._addToMap(t):this._addToMap(t)),this}removeLayer(t){return this._zoomLimitedLayers.delete(t),super.removeLayer(t)}update(t){this.options.showLabels!==t.showLabels&&(this.eachLayer(o=>{o instanceof Xe&&(t.showLabels?o.createLabel():o.removeLabel())}),this.options.showLabels=t.showLabels),this._markerPane&&this._markerPane.classList.toggle("leaflet-pane--show-labels",t.showLabels),(t.minZoom!==this.options.minZoom||t.maxZoom!==this.options.maxZoom)&&(this.options.minZoom=t.minZoom,this.options.maxZoom=t.maxZoom,this._updateLayerVisibility()),t.priority!==this.options.priority&&(this.options.priority=t.priority,this._markerPane&&(this._markerPane.style.zIndex=(401+this.options.priority).toString()))}_updateLayerVisibility(t){if(!this._map)return;const o=this._map.getZoom();if(this._isZoomLimited()){const a=o>=(this.options.minZoom||-1/0)&&o<=(this.options.maxZoom||1/0);this.eachLayer(r=>{this._zoomLimitedLayers.has(r)?ne._isLayerVisible(r,o)?this._addToMap(r):this._removeFromMap(r):a?this._addToMap(r):this._removeFromMap(r)},this)}else this._zoomLimitedLayers.size?this._zoomLimitedLayers.forEach(a=>{ne._isLayerVisible(a,o)?this._addToMap(a):this._removeFromMap(a)}):t&&this.eachLayer(a=>this._addToMap(a),this._map)}_isZoomLimited(){return this.options.maxZoom!==void 0||this.options.minZoom!==void 0}static _isLayerZoomLimited(t){return t.options&&t.options.minZoom!==void 0&&t.options&&t.options.maxZoom!==void 0}static _isLayerVisible(t,o){let a=-1/0,r=1/0;return t.options&&t.options.minZoom!==void 0&&(a=t.options.minZoom),t.options&&t.options.maxZoom!==void 0&&(r=t.options.maxZoom),o>=a&&o<=r}_addToMap(t){this._map.addLayer(t),t instanceof Xe&&this.options.showLabels&&t.createLabel()}_removeFromMap(t){this._map.removeLayer(t)}}const ia=M({components:{Areas:oa,Circles:aa,Lines:ra,Markers:na},props:{leaflet:{type:Object,required:!0},markerSet:{type:Object,required:!0}},setup(e){const t=_(),o=l(()=>t.state.components.markers),a=new ne({id:e.markerSet.id,minZoom:e.markerSet.minZoom,maxZoom:e.markerSet.maxZoom,showLabels:e.markerSet.showLabels||t.state.components.markers.showLabels,priority:e.markerSet.priority});return C(e.markerSet,r=>{r&&a&&(a.update({id:e.markerSet.id,minZoom:e.markerSet.minZoom,maxZoom:e.markerSet.maxZoom,showLabels:e.markerSet.showLabels||t.state.components.markers.showLabels,priority:e.markerSet.priority}),r.hidden?e.leaflet.getLayerManager().addHiddenLayer(a,r.label,e.markerSet.priority):e.leaflet.getLayerManager().addLayer(a,!0,r.label,e.markerSet.priority))},{deep:!0}),H(()=>{e.markerSet.hidden?e.leaflet.getLayerManager().addHiddenLayer(a,e.markerSet.label,e.markerSet.priority):e.leaflet.getLayerManager().addLayer(a,!0,e.markerSet.label,e.markerSet.priority)}),Z(()=>e.leaflet.getLayerManager().removeLayer(a)),{markerSettings:o,layerGroup:a}},render(){return null}});function la(e,t,o,a,r,s){const n=E("Areas"),i=E("Circles"),c=E("Lines"),d=E("Markers");return y(),b(j,null,[W(n,{"layer-group":e.layerGroup,set:e.markerSet},null,8,["layer-group","set"]),W(i,{"layer-group":e.layerGroup,set:e.markerSet},null,8,["layer-group","set"]),W(c,{"layer-group":e.layerGroup,set:e.markerSet},null,8,["layer-group","set"]),W(d,{"layer-group":e.layerGroup,set:e.markerSet},null,8,["layer-group","set"])],64)}var da=x(ia,[["render",la]]);const ie=_();class Qt extends g.exports.Control{constructor(t){super(t);h(this,"_location");h(this,"_locationChanged",!1);h(this,"_coordsContainer");h(this,"_regionContainer");h(this,"_chunkContainer");this._coordsContainer=g.exports.DomUtil.create("span","value coordinates"),this._chunkContainer=g.exports.DomUtil.create("span","value chunk"),this._regionContainer=g.exports.DomUtil.create("span","value region"),t.position="bottomleft",g.exports.Util.setOptions(this,t)}onAdd(t){const o=g.exports.DomUtil.create("div","leaflet-control-coordinates");return this._coordsContainer.textContent=this.options.showY?"-----, ---, -----":"-----, -----",this._coordsContainer.dataset.label=this.options.label,o.appendChild(this._coordsContainer),this.options.showRegion&&(this._regionContainer.textContent="--------------",this._regionContainer.dataset.label=ie.state.messages.locationRegion,o.appendChild(this._regionContainer)),this.options.showChunk&&(this._chunkContainer.textContent="----, ----",this._chunkContainer.dataset.label=ie.state.messages.locationChunk,o.appendChild(this._chunkContainer)),t.on("mousemove",this._onMouseMove,this),t.on("mouseout",this._onMouseOut,this),o}remove(){return this._map?(this._map.off("mousemove",this._onMouseMove,this),this._map.off("mouseout",this._onMouseOut,this),super.remove(),this):this}_onMouseMove(t){!this._map||!ie.state.currentMap||(this._location=ie.state.currentMap.latLngToLocation(t.latlng,ie.state.currentWorld.seaLevel+1),this._locationChanged||(this._locationChanged=!0,requestAnimationFrame(()=>this._update())))}_onMouseOut(){!this._map||(this._location=void 0,this._locationChanged||(this._locationChanged=!0,requestAnimationFrame(()=>this._update())))}_update(){if(!this._map||!ie.state.currentWorld||!this._locationChanged)return;if(this._locationChanged=!1,!this._location){this.options.showY?this._coordsContainer.textContent="-----, ---, -----":this._coordsContainer.textContent="-----, -----",this.options.showRegion&&(this._regionContainer.textContent="--------------"),this.options.showChunk&&(this._chunkContainer.textContent="----, ----");return}const t=Math.round(this._location.x).toString().padStart(5," "),o=this._location.y.toString().padStart(3," "),a=Math.round(this._location.z).toString().padStart(5," "),r=Math.floor(this._location.x/512).toString().padStart(3," "),s=Math.floor(this._location.z/512).toString().padStart(3," "),n=Math.floor(this._location.x/16).toString().padStart(4," "),i=Math.floor(this._location.z/16).toString().padStart(4," ");this.options.showY?this._coordsContainer.textContent=`${t}, ${o}, ${a}`:this._coordsContainer.textContent=`${t}, ${a}`,this.options.showRegion&&(this._regionContainer.textContent=`r.${r}, ${s}.mca`),this.options.showChunk&&(this._chunkContainer.textContent=`${n}, ${i}`)}}const ca=M({props:{leaflet:{type:Object,required:!0}},setup(e){const t=_(),o=l(()=>t.state.components.coordinatesControl);let a=new Qt(o.value);C(o,r=>{e.leaflet.removeControl(a),!!r&&(a=new Qt(r),e.leaflet.addControl(a))},{deep:!0}),H(()=>e.leaflet.addControl(a)),Z(()=>e.leaflet.removeControl(a))},render(){return null}});let pa=document.getElementById("icon--clock_moon"),le=document.getElementById("svg-sprite-component-wrap");le||(le=document.createElementNS("http://www.w3.org/2000/svg","svg"),le.id="svg-sprite-component-wrap",le.style.setProperty("display","none"),document.body.appendChild(le));if(!pa){let e=document.createElementNS("http://www.w3.org/2000/svg","symbol");le.appendChild(e),e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.setAttribute("id","icon--clock_moon"),e.setAttribute("viewBox","0 0 200 160"),e.innerHTML='<path d="M85.562 65.682v9.225h6.469v6.75h-6.469V94.79h12.031V89h3.469v-3.625h5.406v9.415h8.203V65.683H98.874v4.974H92.25v-4.974h-6.687zm25.545 5.367v7.215h-7.521v-7.213l7.521-.002zM79.347 55.26a1.068 1.068 0 0 0-1.068 1.066v6.74a1.068 1.068 0 0 0 1.068 1.069 1.068 1.068 0 0 0 1.066-1.069v-6.74a1.068 1.068 0 0 0-1.066-1.066z"></path><path d="M75.973 58.629a1.068 1.068 0 0 0-1.066 1.068 1.068 1.068 0 0 0 1.066 1.067h6.74a1.068 1.068 0 0 0 1.069-1.067 1.068 1.068 0 0 0-1.069-1.068h-6.74zM115.424 98.608a1.068 1.068 0 0 0-1.068 1.068 1.068 1.068 0 0 0 1.069 1.069h6.74a1.068 1.068 0 0 0 1.068-1.069 1.068 1.068 0 0 0-1.068-1.068h-6.74z"></path><path d="M118.784 95.239a1.068 1.068 0 0 0-1.066 1.068v6.739a1.068 1.068 0 0 0 1.066 1.068 1.068 1.068 0 0 0 1.069-1.068v-6.739a1.068 1.068 0 0 0-1.069-1.068z"></path>'}let ma=document.getElementById("icon--clock_moon_rain"),de=document.getElementById("svg-sprite-component-wrap");de||(de=document.createElementNS("http://www.w3.org/2000/svg","svg"),de.id="svg-sprite-component-wrap",de.style.setProperty("display","none"),document.body.appendChild(de));if(!ma){let e=document.createElementNS("http://www.w3.org/2000/svg","symbol");de.appendChild(e),e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.setAttribute("id","icon--clock_moon_rain"),e.setAttribute("viewBox","0 0 200 160"),e.innerHTML='<path d="M89.938 59.713v9.225h6.469v3.078c.242.244.462.516.664.808.91 1.027.916 1.781.916 1.781 4.571-2.083 9.359-1.688 10.61 4.801h2.247v5.62c1.729.898 2.598 2.319 2.875 3.794h5.328V59.713H103.25v4.975h-6.625v-4.975zm25.545 5.367v7.215h-7.521v-7.213zm-36.14-9.851a1.068 1.068 0 0 0-1.068 1.066v6.74a1.068 1.068 0 0 0 1.068 1.069 1.068 1.068 0 0 0 1.066-1.068v-6.74a1.068 1.068 0 0 0-1.066-1.067z"></path><path d="M75.972 58.598a1.068 1.068 0 0 0-1.066 1.068 1.068 1.068 0 0 0 1.066 1.067h6.74a1.068 1.068 0 0 0 1.069-1.067 1.068 1.068 0 0 0-1.069-1.068zm39.448 38.417a1.068 1.068 0 0 0-1.068 1.068 1.068 1.068 0 0 0 1.068 1.069h6.74a1.068 1.068 0 0 0 1.069-1.069 1.068 1.068 0 0 0-1.069-1.068z"></path><path d="M118.79 93.646a1.068 1.068 0 0 0-1.066 1.068v6.739a1.068 1.068 0 0 0 1.066 1.068 1.068 1.068 0 0 0 1.068-1.068v-6.739a1.068 1.068 0 0 0-1.068-1.068zm-27.686-22.58a9.532 9.532 0 0 0-3.443.615c-2.191.834-3.889 2.415-4.305 4.422-.416 2.008.344 4.71 3.793 8.031a1.071 1.071 0 0 1 .03 1.514 1.071 1.071 0 0 1-1.514.03c-1.215-1.17-2.147-2.321-2.856-3.446-4.735-1.035-7.512.638-8.758 3.023-1.22 2.338-.859 5.482 1.291 7.8h36.11c.846-.747 1.59-2.604 1.173-4.29-.418-1.692-1.724-3.247-5.195-3.562-.955 1.204-2.293 2.169-4.041 2.67a1.071 1.071 0 0 1-1.324-.735 1.071 1.071 0 0 1 .734-1.324c1.408-.403 2.444-1.178 3.146-2.139a1.071 1.071 0 0 1 .246-.365l.004-.006c.926-1.506 1.108-3.38.657-5.004-.396-1.422-1.26-2.577-2.537-3.154-1.21-.547-2.883-.616-5.123.33.126.756.184 1.562.127 2.438a1.071 1.071 0 0 1-1.14.998 1.071 1.071 0 0 1-.997-1.14c.218-3.333-1.042-5.06-2.89-5.995-.925-.468-2.035-.7-3.188-.711zM80.875 96.59a1.071 1.071 0 0 0-.902.496l-2.455 3.856a1.071 1.071 0 0 0 .328 1.478 1.071 1.071 0 0 0 1.478-.328l2.455-3.856a1.071 1.071 0 0 0-.326-1.478 1.071 1.071 0 0 0-.578-.168zm13.258 0a1.071 1.071 0 0 0-.9.496l-2.457 3.856a1.071 1.071 0 0 0 .328 1.478 1.071 1.071 0 0 0 1.478-.328l2.457-3.856a1.071 1.071 0 0 0-.328-1.478 1.071 1.071 0 0 0-.578-.168zm13.257 0a1.071 1.071 0 0 0-.9.496l-2.455 3.856a1.071 1.071 0 0 0 .328 1.478 1.071 1.071 0 0 0 1.478-.328l2.455-3.856a1.071 1.071 0 0 0-.328-1.478 1.071 1.071 0 0 0-.578-.168zm-21.212 7.95a1.071 1.071 0 0 0-.9.494l-2.457 3.856a1.071 1.071 0 0 0 .328 1.48 1.071 1.071 0 0 0 1.478-.328l2.457-3.855a1.071 1.071 0 0 0-.328-1.479 1.071 1.071 0 0 0-.578-.168zm13.26 0a1.071 1.071 0 0 0-.902.494l-2.455 3.856a1.071 1.071 0 0 0 .328 1.48 1.071 1.071 0 0 0 1.478-.328l2.455-3.855a1.071 1.071 0 0 0-.328-1.479 1.071 1.071 0 0 0-.576-.168z"></path>'}let ua=document.getElementById("icon--clock_moon_storm"),ce=document.getElementById("svg-sprite-component-wrap");ce||(ce=document.createElementNS("http://www.w3.org/2000/svg","svg"),ce.id="svg-sprite-component-wrap",ce.style.setProperty("display","none"),document.body.appendChild(ce));if(!ua){let e=document.createElementNS("http://www.w3.org/2000/svg","symbol");ce.appendChild(e),e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.setAttribute("id","icon--clock_moon_storm"),e.setAttribute("viewBox","0 0 200 160"),e.innerHTML='<path d="M89.938 59.713v9.225h6.469v3.078c.242.244.462.516.664.808.91 1.027.916 1.781.916 1.781 4.571-2.083 9.359-1.688 10.61 4.801h2.247v5.62c1.729.898 2.598 2.319 2.875 3.794h5.328V59.713H103.25v4.975h-6.625v-4.975zm25.545 5.367v7.215h-7.521v-7.213z"></path><path d="M91.104 71.066a9.532 9.532 0 0 0-3.443.615c-2.191.834-3.889 2.415-4.305 4.422-.416 2.008.344 4.71 3.793 8.031a1.071 1.071 0 0 1 .03 1.514 1.071 1.071 0 0 1-1.514.03c-1.215-1.17-2.147-2.321-2.856-3.446-4.735-1.035-7.512.638-8.758 3.023-1.22 2.338-.859 5.482 1.291 7.8h36.11c.846-.747 1.59-2.604 1.173-4.29-.418-1.692-1.724-3.247-5.195-3.562-.955 1.204-2.293 2.169-4.041 2.67a1.071 1.071 0 0 1-1.324-.735 1.071 1.071 0 0 1 .734-1.324c1.408-.403 2.444-1.178 3.146-2.139a1.071 1.071 0 0 1 .246-.365l.004-.006c.926-1.506 1.108-3.38.657-5.004-.396-1.422-1.26-2.577-2.537-3.154-1.21-.547-2.883-.616-5.123.33.126.756.184 1.562.127 2.438a1.071 1.071 0 0 1-1.14.998 1.071 1.071 0 0 1-.997-1.14c.218-3.333-1.042-5.06-2.89-5.995-.925-.468-2.035-.7-3.188-.711zm-4.758 24.989a1.071 1.071 0 0 0-.879.535l-2.506 4.34a1.071 1.071 0 0 0 .733 1.588l1.892.351-3.385 5.862a1.071 1.071 0 0 0 .393 1.463 1.071 1.071 0 0 0 1.463-.393l4.14-7.172a1.071 1.071 0 0 0-.732-1.588l-1.89-.351 1.747-3.03a1.071 1.071 0 0 0-.392-1.463 1.071 1.071 0 0 0-.584-.142zm15.464 0a1.071 1.071 0 0 0-.879.535l-2.506 4.34a1.071 1.071 0 0 0 .733 1.588l1.892.351-3.385 5.862a1.071 1.071 0 0 0 .393 1.463 1.071 1.071 0 0 0 1.463-.393l4.14-7.172a1.071 1.071 0 0 0-.732-1.588l-1.89-.351 1.747-3.03a1.071 1.071 0 0 0-.392-1.463 1.071 1.071 0 0 0-.584-.142z"></path>'}let ha=document.getElementById("icon--clock_sun"),pe=document.getElementById("svg-sprite-component-wrap");pe||(pe=document.createElementNS("http://www.w3.org/2000/svg","svg"),pe.id="svg-sprite-component-wrap",pe.style.setProperty("display","none"),document.body.appendChild(pe));if(!ha){let e=document.createElementNS("http://www.w3.org/2000/svg","symbol");pe.appendChild(e),e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.setAttribute("id","icon--clock_sun"),e.setAttribute("viewBox","0 0 200 160"),e.innerHTML='<path d="M118.96 79.605a1.068 1.068 0 0 0-1.068 1.068 1.068 1.068 0 0 0 1.068 1.069h6.74a1.068 1.068 0 0 0 1.069-1.069 1.068 1.068 0 0 0-1.069-1.068h-6.74zm6.63-11.654a1.068 1.068 0 0 0-.283.035l-6.512 1.744a1.068 1.068 0 0 0-.754 1.309 1.068 1.068 0 0 0 1.307.756l6.511-1.746a1.068 1.068 0 0 0 .754-1.307 1.068 1.068 0 0 0-1.023-.791zm-6.5 21.565a1.068 1.068 0 0 0-1.05.791 1.068 1.068 0 0 0 .753 1.309l6.512 1.744a1.068 1.068 0 0 0 1.306-.756 1.068 1.068 0 0 0-.753-1.307l-6.512-1.744a1.068 1.068 0 0 0-.256-.037zm4.84-33.807a1.068 1.068 0 0 0-.725.31l-4.765 4.766a1.068 1.068 0 0 0 0 1.512 1.068 1.068 0 0 0 1.51 0l4.765-4.766a1.068 1.068 0 0 0 0-1.511 1.068 1.068 0 0 0-.785-.311zM99.68 98.006a1.068 1.068 0 0 0-1.068 1.068v6.739a1.068 1.068 0 0 0 1.068 1.068 1.068 1.068 0 0 0 1.068-1.068v-6.739a1.068 1.068 0 0 0-1.068-1.068zm9.92.115a1.068 1.068 0 0 0-.283.035 1.068 1.068 0 0 0-.754 1.309l1.744 6.51a1.068 1.068 0 0 0 1.307.753 1.068 1.068 0 0 0 .755-1.306l-1.744-6.51a1.068 1.068 0 0 0-1.025-.791zm-19.811-.004a1.068 1.068 0 0 0-1.05.791l-1.745 6.51a1.068 1.068 0 0 0 .756 1.306 1.068 1.068 0 0 0 1.307-.753l1.746-6.51a1.068 1.068 0 0 0-.756-1.309 1.068 1.068 0 0 0-.258-.035zm28.991.129a1.068 1.068 0 0 0-.725.313 1.068 1.068 0 0 0 0 1.51l4.766 4.765a1.068 1.068 0 0 0 1.51 0 1.068 1.068 0 0 0 0-1.51l-4.766-4.765a1.068 1.068 0 0 0-.785-.313zM74.541 78.73a1.068 1.068 0 0 0-1.068 1.066 1.068 1.068 0 0 0 1.068 1.069h6.74a1.068 1.068 0 0 0 1.067-1.069 1.068 1.068 0 0 0-1.067-1.066h-6.74zm6.633 9.911a1.068 1.068 0 0 0-.285.037l-6.51 1.744a1.068 1.068 0 0 0-.754 1.309 1.068 1.068 0 0 0 1.307.754l6.51-1.744a1.068 1.068 0 0 0 .755-1.307 1.068 1.068 0 0 0-1.023-.793zm-6.496-21.565a1.068 1.068 0 0 0-1.049.791 1.068 1.068 0 0 0 .754 1.309l6.51 1.744a1.068 1.068 0 0 0 1.309-.756 1.068 1.068 0 0 0-.756-1.307l-6.51-1.744a1.068 1.068 0 0 0-.258-.037zm6.334 30.787a1.068 1.068 0 0 0-.727.313l-4.765 4.765a1.068 1.068 0 0 0 0 1.51 1.068 1.068 0 0 0 1.512 0l4.765-4.766a1.068 1.068 0 0 0 0-1.51 1.068 1.068 0 0 0-.785-.312zm19.548-44.371a1.068 1.068 0 0 0-1.068 1.066v6.74a1.068 1.068 0 0 0 1.068 1.069 1.068 1.068 0 0 0 1.066-1.068v-6.74a1.068 1.068 0 0 0-1.066-1.067zm-11.652.115a1.068 1.068 0 0 0-.285.035 1.068 1.068 0 0 0-.754 1.309l1.744 6.51a1.068 1.068 0 0 0 1.309.753 1.068 1.068 0 0 0 .754-1.306l-1.745-6.51a1.068 1.068 0 0 0-1.023-.791zm23.322.004a1.068 1.068 0 0 0-1.05.791l-1.745 6.51a1.068 1.068 0 0 0 .756 1.306 1.068 1.068 0 0 0 1.307-.753l1.744-6.51a1.068 1.068 0 0 0-.754-1.309 1.068 1.068 0 0 0-.258-.035zm-35.603 1.616a1.067 1.067 0 0 0-.725.313 1.067 1.067 0 0 0 0 1.51l4.766 4.765a1.067 1.067 0 0 0 1.51 0 1.067 1.067 0 0 0 0-1.51l-4.766-4.766a1.067 1.067 0 0 0-.785-.312zm8.936 10.454h29.108V94.79H85.563z"></path>'}let ga=document.getElementById("icon--clock_sun_rain"),me=document.getElementById("svg-sprite-component-wrap");me||(me=document.createElementNS("http://www.w3.org/2000/svg","svg"),me.id="svg-sprite-component-wrap",me.style.setProperty("display","none"),document.body.appendChild(me));if(!ga){let e=document.createElementNS("http://www.w3.org/2000/svg","symbol");me.appendChild(e),e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.setAttribute("id","icon--clock_sun_rain"),e.setAttribute("viewBox","0 0 200 160"),e.innerHTML='<path d="M123.33 73.355a1.068 1.068 0 0 0-1.068 1.068 1.068 1.068 0 0 0 1.068 1.069h6.74a1.068 1.068 0 0 0 1.069-1.069 1.068 1.068 0 0 0-1.069-1.068zm6.63-11.654a1.068 1.068 0 0 0-.283.035l-6.512 1.744a1.068 1.068 0 0 0-.754 1.309 1.068 1.068 0 0 0 1.307.756l6.511-1.746a1.068 1.068 0 0 0 .754-1.307 1.068 1.068 0 0 0-1.023-.791zm-6.5 21.565a1.068 1.068 0 0 0-1.05.791 1.068 1.068 0 0 0 .753 1.309l6.512 1.744a1.068 1.068 0 0 0 1.306-.756 1.068 1.068 0 0 0-.753-1.307l-6.512-1.744a1.068 1.068 0 0 0-.256-.037zm4.84-33.807a1.068 1.068 0 0 0-.725.31l-4.765 4.766a1.068 1.068 0 0 0 0 1.512 1.068 1.068 0 0 0 1.51 0l4.765-4.766a1.068 1.068 0 0 0 0-1.511 1.068 1.068 0 0 0-.785-.311zm-13.93 44.744a1.068 1.068 0 0 0-.283.047 1.068 1.068 0 0 0-.701 1.338l1.302 4.177a1.068 1.068 0 0 0 1.336.702 1.068 1.068 0 0 0 .703-1.336l-1.302-4.18a1.068 1.068 0 0 0-1.055-.748zm8.79-2.207a1.068 1.068 0 0 0-.725.313 1.068 1.068 0 0 0 0 1.51l4.766 4.765a1.068 1.068 0 0 0 1.51 0 1.068 1.068 0 0 0 0-1.51l-4.766-4.765a1.068 1.068 0 0 0-.785-.313zm-18.23-44.754a1.068 1.068 0 0 0-1.068 1.066v6.74a1.068 1.068 0 0 0 1.068 1.069 1.068 1.068 0 0 0 1.066-1.068v-6.74a1.068 1.068 0 0 0-1.066-1.067zm-11.647.115a1.068 1.068 0 0 0-.285.035 1.068 1.068 0 0 0-.754 1.309l1.744 6.51a1.068 1.068 0 0 0 1.309.753 1.068 1.068 0 0 0 .754-1.306l-1.745-6.51a1.068 1.068 0 0 0-1.023-.791zm23.317.004a1.068 1.068 0 0 0-1.05.791l-1.745 6.51a1.068 1.068 0 0 0 .756 1.306 1.068 1.068 0 0 0 1.307-.753l1.744-6.51a1.068 1.068 0 0 0-.754-1.309 1.068 1.068 0 0 0-.258-.035zm-35.598 1.616a1.068 1.068 0 0 0-.725.313 1.068 1.068 0 0 0 0 1.51l4.766 4.765a1.068 1.068 0 0 0 1.51 0 1.068 1.068 0 0 0 0-1.51l-4.766-4.766a1.068 1.068 0 0 0-.785-.312zm8.936 10.455v10.852c3.426-.394 6.93.938 7.992 4.61.404-.213.359-.19.446-.237 8.372-3.856 11.803 4.574 8.57 9.422 4.24.207 6.19 2.239 6.726 4.46h5.375V59.434zm8.621 15.486c-65.706-49.945-32.853-24.973 0 0zM80.875 96.59a1.071 1.071 0 0 0-.902.496l-2.455 3.856a1.071 1.071 0 0 0 .328 1.478 1.071 1.071 0 0 0 1.478-.328l2.455-3.856a1.071 1.071 0 0 0-.326-1.478 1.071 1.071 0 0 0-.578-.168zm13.258 0a1.071 1.071 0 0 0-.9.496l-2.457 3.856a1.071 1.071 0 0 0 .328 1.478 1.071 1.071 0 0 0 1.478-.328l2.457-3.856a1.071 1.071 0 0 0-.328-1.478 1.071 1.071 0 0 0-.578-.168zm13.257 0a1.071 1.071 0 0 0-.9.496l-2.455 3.856a1.071 1.071 0 0 0 .328 1.478 1.071 1.071 0 0 0 1.478-.328l2.455-3.856a1.071 1.071 0 0 0-.328-1.478 1.071 1.071 0 0 0-.578-.168zm-21.212 7.95a1.071 1.071 0 0 0-.9.494l-2.457 3.856a1.071 1.071 0 0 0 .328 1.48 1.071 1.071 0 0 0 1.478-.328l2.457-3.855a1.071 1.071 0 0 0-.328-1.479 1.071 1.071 0 0 0-.578-.168zm13.26 0a1.071 1.071 0 0 0-.902.494l-2.455 3.856a1.071 1.071 0 0 0 .328 1.48 1.071 1.071 0 0 0 1.478-.328l2.455-3.855a1.071 1.071 0 0 0-.328-1.479 1.071 1.071 0 0 0-.576-.168z"></path><path d="M91.104 71.066a9.532 9.532 0 0 0-3.443.615c-2.191.834-3.889 2.415-4.305 4.422-.416 2.008.344 4.71 3.793 8.031a1.071 1.071 0 0 1 .03 1.514 1.071 1.071 0 0 1-1.514.03c-1.215-1.17-2.147-2.321-2.856-3.446-4.735-1.035-7.512.638-8.758 3.023-1.22 2.338-.859 5.482 1.291 7.8h36.11c.846-.747 1.59-2.604 1.173-4.29-.418-1.692-1.724-3.247-5.195-3.562-.955 1.204-2.293 2.169-4.041 2.67a1.071 1.071 0 0 1-1.324-.735 1.071 1.071 0 0 1 .734-1.324c1.408-.403 2.444-1.178 3.146-2.139a1.071 1.071 0 0 1 .246-.365l.004-.006c.926-1.506 1.108-3.38.657-5.004-.396-1.422-1.26-2.577-2.537-3.154-1.21-.547-2.883-.616-5.123.33.126.756.184 1.562.127 2.438a1.071 1.071 0 0 1-1.14.998 1.071 1.071 0 0 1-.997-1.14c.218-3.333-1.042-5.06-2.89-5.995-.925-.468-2.035-.7-3.188-.711z"></path>'}let fa=document.getElementById("icon--clock_sun_storm"),ue=document.getElementById("svg-sprite-component-wrap");ue||(ue=document.createElementNS("http://www.w3.org/2000/svg","svg"),ue.id="svg-sprite-component-wrap",ue.style.setProperty("display","none"),document.body.appendChild(ue));if(!fa){let e=document.createElementNS("http://www.w3.org/2000/svg","symbol");ue.appendChild(e),e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.setAttribute("id","icon--clock_sun_storm"),e.setAttribute("viewBox","0 0 200 160"),e.innerHTML='<path d="M123.33 73.355a1.068 1.068 0 0 0-1.068 1.068 1.068 1.068 0 0 0 1.068 1.069h6.74a1.068 1.068 0 0 0 1.069-1.069 1.068 1.068 0 0 0-1.069-1.068zm6.63-11.654a1.068 1.068 0 0 0-.283.035l-6.512 1.744a1.068 1.068 0 0 0-.754 1.309 1.068 1.068 0 0 0 1.307.756l6.511-1.746a1.068 1.068 0 0 0 .754-1.307 1.068 1.068 0 0 0-1.023-.791zm-6.5 21.565a1.068 1.068 0 0 0-1.05.791 1.068 1.068 0 0 0 .753 1.309l6.512 1.744a1.068 1.068 0 0 0 1.306-.756 1.068 1.068 0 0 0-.753-1.307l-6.512-1.744a1.068 1.068 0 0 0-.256-.037zm4.84-33.807a1.068 1.068 0 0 0-.725.31l-4.765 4.766a1.068 1.068 0 0 0 0 1.512 1.068 1.068 0 0 0 1.51 0l4.765-4.766a1.068 1.068 0 0 0 0-1.511 1.068 1.068 0 0 0-.785-.311zm-13.93 44.744a1.068 1.068 0 0 0-.283.047 1.068 1.068 0 0 0-.701 1.338l1.302 4.177a1.068 1.068 0 0 0 1.336.702 1.068 1.068 0 0 0 .703-1.336l-1.302-4.18a1.068 1.068 0 0 0-1.055-.748zm8.79-2.207a1.068 1.068 0 0 0-.725.313 1.068 1.068 0 0 0 0 1.51l4.766 4.765a1.068 1.068 0 0 0 1.51 0 1.068 1.068 0 0 0 0-1.51l-4.766-4.765a1.068 1.068 0 0 0-.785-.313zm-18.23-44.754a1.068 1.068 0 0 0-1.068 1.066v6.74a1.068 1.068 0 0 0 1.068 1.069 1.068 1.068 0 0 0 1.066-1.068v-6.74a1.068 1.068 0 0 0-1.066-1.067zm-11.647.115a1.068 1.068 0 0 0-.285.035 1.068 1.068 0 0 0-.754 1.309l1.744 6.51a1.068 1.068 0 0 0 1.309.753 1.068 1.068 0 0 0 .754-1.306l-1.745-6.51a1.068 1.068 0 0 0-1.023-.791zm23.317.004a1.068 1.068 0 0 0-1.05.791l-1.745 6.51a1.068 1.068 0 0 0 .756 1.306 1.068 1.068 0 0 0 1.307-.753l1.744-6.51a1.068 1.068 0 0 0-.754-1.309 1.068 1.068 0 0 0-.258-.035zm-35.598 1.616a1.068 1.068 0 0 0-.725.313 1.068 1.068 0 0 0 0 1.51l4.766 4.765a1.068 1.068 0 0 0 1.51 0 1.068 1.068 0 0 0 0-1.51l-4.766-4.766a1.068 1.068 0 0 0-.785-.312zm8.936 10.455v10.852c3.426-.394 6.93.938 7.992 4.61.404-.213.359-.19.446-.237 8.372-3.856 11.803 4.574 8.57 9.422 4.24.207 6.19 2.239 6.726 4.46h5.375V59.434zm8.621 15.486c-65.706-49.945-32.853-24.973 0 0z"></path><path d="M91.104 71.066a9.532 9.532 0 0 0-3.443.615c-2.191.834-3.889 2.415-4.305 4.422-.416 2.008.344 4.71 3.793 8.031a1.071 1.071 0 0 1 .03 1.514 1.071 1.071 0 0 1-1.514.03c-1.215-1.17-2.147-2.321-2.856-3.446-4.735-1.035-7.512.638-8.758 3.023-1.22 2.338-.859 5.482 1.291 7.8h36.11c.846-.747 1.59-2.604 1.173-4.29-.418-1.692-1.724-3.247-5.195-3.562-.955 1.204-2.293 2.169-4.041 2.67a1.071 1.071 0 0 1-1.324-.735 1.071 1.071 0 0 1 .734-1.324c1.408-.403 2.444-1.178 3.146-2.139a1.071 1.071 0 0 1 .246-.365l.004-.006c.926-1.506 1.108-3.38.657-5.004-.396-1.422-1.26-2.577-2.537-3.154-1.21-.547-2.883-.616-5.123.33.126.756.184 1.562.127 2.438a1.071 1.071 0 0 1-1.14.998 1.071 1.071 0 0 1-.997-1.14c.218-3.333-1.042-5.06-2.89-5.995-.925-.468-2.035-.7-3.188-.711zm-4.758 24.989a1.071 1.071 0 0 0-.879.535l-2.506 4.34a1.071 1.071 0 0 0 .733 1.588l1.892.351-3.385 5.862a1.071 1.071 0 0 0 .393 1.463 1.071 1.071 0 0 0 1.463-.393l4.14-7.172a1.071 1.071 0 0 0-.732-1.588l-1.89-.351 1.747-3.03a1.071 1.071 0 0 0-.392-1.463 1.071 1.071 0 0 0-.584-.142zm15.464 0a1.071 1.071 0 0 0-.879.535l-2.506 4.34a1.071 1.071 0 0 0 .733 1.588l1.892.351-3.385 5.862a1.071 1.071 0 0 0 .393 1.463 1.071 1.071 0 0 0 1.463-.393l4.14-7.172a1.071 1.071 0 0 0-.732-1.588l-1.89-.351 1.747-3.03a1.071 1.071 0 0 0-.392-1.463 1.071 1.071 0 0 0-.584-.142z"></path>'}class Jt extends g.exports.Control{constructor(t){super(Object.assign(t,{position:"topcenter"}));h(this,"_sun");h(this,"_moon");h(this,"_clock");h(this,"_currentMoonIcon");h(this,"_currentSunIcon");h(this,"_unwatchHandler");g.exports.Util.setOptions(this,t)}onAdd(){const t=!this.options.showTimeOfDay&&!this.options.showWeather&&this.options.showDigitalClock,o=_().state.currentWorldState;return this._container=g.exports.DomUtil.create("div","clock"+(t?" clock--digital":"")),this._sun=g.exports.DomUtil.create("div","clock__sun",this._container),this._moon=g.exports.DomUtil.create("div","clock__moon",this._container),this._sun.style.transform="translate(-150px, -150px)",this._moon.style.transform="translate(-150px, -150px)",this._sun.innerHTML=`
		<svg class="svg-icon" aria-hidden="true">
	  		<use xlink:href="#icon--clock_sun" />
		</svg>`,this._moon.innerHTML=`
		<svg class="svg-icon" aria-hidden="true">
	  		<use xlink:href="#icon--clock_moon" />
		</svg>`,this.options.showDigitalClock&&(this._clock=g.exports.DomUtil.create("div","clock__time",this._container)),this._unwatchHandler=C(o,a=>{this._update(a)},{deep:!0}),this._container}onRemove(){this._unwatchHandler&&this._unwatchHandler()}_update(t){const o=t.timeOfDay;let a;if(o>23100||o<12900){let n=o+900;n=n>=24e3?n-24e3:n,a=n/27600*2*Math.PI}else{const n=o-12900;a=Math.PI+n/20400*2*Math.PI}const r=a+Math.PI;o>=0?(this._sun.style.transform="translate("+Math.round(-50*Math.cos(a))+"px, "+Math.round(-50*Math.sin(a))+"px)",this._moon.style.transform="translate("+Math.round(-50*Math.cos(r))+"px, "+Math.round(-50*Math.sin(r))+"px)"):(this._sun.style.transform="translate(-150px, -150px)",this._moon.style.transform="translate(-150px, -150px)");const s=ct(o);this.options.showDigitalClock&&(o>=0?(this._clock.classList.remove(s.night?"day":"night"),this._clock.classList.add(s.day?"day":"night"),this._clock.textContent=[s.hours.toString().padStart(2,"0"),s.minutes.toString().padStart(2,"0")].join(":")):(this._clock.classList.remove(s.night?"day":"night"),this._clock.textContent="")),this.options.showWeather&&(t.thundering?(this._setSunIcon("clock_sun_storm"),this._setMoonIcon("clock_moon_storm")):t.raining?(this._setSunIcon("clock_sun_rain"),this._setMoonIcon("clock_moon_rain")):(this._setSunIcon("clock_sun"),this._setMoonIcon("clock_moon")))}_setSunIcon(t){this._sun&&this._currentSunIcon!==t&&(this._sun.innerHTML=`
				<svg class="svg-icon" aria-hidden="true">
					<use xlink:href="#icon--${t}" />
				</svg>`,this._currentSunIcon=t)}_setMoonIcon(t){this._moon&&this._currentMoonIcon!==t&&(this._moon.innerHTML=`
				<svg class="svg-icon" aria-hidden="true">
					<use xlink:href="#icon--${t}" />
				</svg>`,this._currentMoonIcon=t)}}const ya=M({props:{leaflet:{type:Object,required:!0}},setup(e){const t=_(),o=l(()=>t.state.components.clockControl);let a=new Jt(o.value);C(o,r=>{e.leaflet.removeControl(a),!!r&&(a=new Jt(r),e.leaflet.addControl(a))},{deep:!0}),H(()=>e.leaflet.addControl(a)),Z(()=>e.leaflet.removeControl(a))},render(){return null}});let wa=document.getElementById("icon--link"),he=document.getElementById("svg-sprite-component-wrap");he||(he=document.createElementNS("http://www.w3.org/2000/svg","svg"),he.id="svg-sprite-component-wrap",he.style.setProperty("display","none"),document.body.appendChild(he));if(!wa){let e=document.createElementNS("http://www.w3.org/2000/svg","symbol");he.appendChild(e),e.setAttribute("version","1.0"),e.setAttribute("viewBox","0 0 269.4 271.84"),e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.setAttribute("id","icon--link"),e.innerHTML='<path d="M110.774 86.501c-13.432 0-26.865 5.12-37.01 15.357l-58.551 59.088c-20.29 20.476-20.29 53.87 0 74.346l21.008 21.201c20.29 20.476 53.704 20.448 74.006.012l38.221-38.473a13.5 13.5 0 0 0-.064-19.092 13.5 13.5 0 0 0-19.092.062l-38.22 38.473c-10.117 10.185-25.582 10.195-35.673.012l-21.006-21.199c-10.091-10.183-10.091-26.155 0-36.338l58.55-59.086c10.092-10.183 25.57-10.183 35.66 0l10.995 11.094a13.5 13.5 0 0 0 19.092.086 13.5 13.5 0 0 0 .086-19.092l-10.992-11.094C137.639 91.62 124.206 86.5 110.774 86.5z"></path><path d="M196.174 0c-13.428.002-26.857 5.117-37.008 15.336l-38.219 38.473a13.5 13.5 0 0 0 .063 19.092 13.5 13.5 0 0 0 19.091-.063l38.22-38.473c10.117-10.185 25.582-10.195 35.673-.012l21.008 21.2c10.091 10.182 10.091 26.154 0 36.337l-58.55 59.088c-10.091 10.183-25.571 10.183-35.662 0l-10.992-11.094a13.5 13.5 0 0 0-19.092-.088 13.5 13.5 0 0 0-.088 19.092l10.994 11.094c20.29 20.476 53.727 20.476 74.018 0l58.55-59.088c20.29-20.476 20.29-53.87 0-74.346l-21.007-21.2c-10.145-10.24-23.57-15.351-36.998-15.35z"></path>'}class va extends g.exports.Control{constructor(t){super(t)}onAdd(){const t=_(),o=g.exports.DomUtil.create("button","leaflet-control-button leaflet-control-link"),a=l(()=>t.state.messages.copyToClipboardSuccess),r=l(()=>t.state.messages.copyToClipboardError);return o.type="button",o.title=t.state.messages.linkTitle,o.innerHTML=`
		<svg class="svg-icon" aria-hidden="true">
		  <use xlink:href="#icon--link" />
		</svg>`,o.addEventListener("click",s=>{s.preventDefault(),io(window.location.href.split("#")[0]+t.getters.url).then(()=>{J(a.value)}).catch(n=>{J({type:"error",text:r.value}),console.error("Error copying to clipboard",n)})}),o}}const _a=M({props:{leaflet:{type:Object,required:!0}},setup(e){const t=new va({position:"bottomleft"});H(()=>e.leaflet.addControl(t)),Z(()=>e.leaflet.removeControl(t))},render(){return null}});let ba=document.getElementById("icon--chat"),ge=document.getElementById("svg-sprite-component-wrap");ge||(ge=document.createElementNS("http://www.w3.org/2000/svg","svg"),ge.id="svg-sprite-component-wrap",ge.style.setProperty("display","none"),document.body.appendChild(ge));if(!ba){let e=document.createElementNS("http://www.w3.org/2000/svg","symbol");ge.appendChild(e),e.setAttribute("version","1.0"),e.setAttribute("viewBox","0 0 255.35 204.89"),e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.setAttribute("id","icon--chat"),e.innerHTML='<path d="M61.254 0C27.32 0 0 27.318 0 61.252v42.163c0 33.934 27.319 61.252 61.254 61.252h15.259l-21.095 38.319c-.46 1.82.236 2.723 3.955.918 13.531-6.566 53.741-27.223 77.092-39.237h57.636c33.934 0 61.254-27.318 61.254-61.252V61.252C255.355 27.317 228.036 0 194.101 0zm.053 80.558a17.531 17.531 0 0 1 .095 0 17.531 17.531 0 0 1 17.53 17.531 17.531 17.531 0 0 1-17.53 17.531A17.531 17.531 0 0 1 43.87 98.089a17.531 17.531 0 0 1 17.436-17.531zm67.688 0a17.531 17.531 0 0 1 .095 0 17.531 17.531 0 0 1 17.53 17.531 17.531 17.531 0 0 1-17.53 17.531 17.531 17.531 0 0 1-17.531-17.531 17.531 17.531 0 0 1 17.436-17.531zm67.733 0a17.531 17.531 0 0 1 .095 0 17.531 17.531 0 0 1 17.53 17.531 17.531 17.531 0 0 1-17.53 17.531 17.531 17.531 0 0 1-17.531-17.531 17.531 17.531 0 0 1 17.436-17.531z"></path>'}class Ea extends g.exports.Control{constructor(t){super(t)}onAdd(){const t=_(),o=g.exports.DomUtil.create("button","leaflet-control-bottom leaflet-control-button leaflet-control-chat");return o.type="button",o.title=t.state.messages.chatTitle,o.innerHTML=`
		<svg class="svg-icon">
		  <use xlink:href="#icon--chat" />
		</svg>`,o.addEventListener("click",a=>{t.commit(p.TOGGLE_UI_ELEMENT_VISIBILITY,"chat"),a.stopPropagation(),a.preventDefault()}),g.exports.DomEvent.on(o,"keydown",a=>{a.key==="ArrowRight"&&t.commit(p.SET_UI_ELEMENT_VISIBILITY,{element:"chat",state:!0})}),C(t.state.ui.visibleElements,a=>{o.setAttribute("aria-expanded",a.has("chat").toString())}),o}}const La=M({props:{leaflet:{type:Object,required:!0}},setup(e){const t=new Ea({position:"topleft"});H(()=>e.leaflet.addControl(t)),Z(()=>e.leaflet.removeControl(t))},render(){return null}});class Sa extends g.exports.Control{constructor(t){super(t)}onAdd(){const t=g.exports.DomUtil.create("div","leaflet-control-logo");let o;if(this.options.url&&(o=g.exports.DomUtil.create("a","",t),o.href=this.options.url,o.setAttribute("aria-label",this.options.text)),this.options.image){const a=g.exports.DomUtil.create("img","",o);a.src=this.options.image,a.alt=this.options.text}else t.textContent=this.options.text;return t}}const ka=M({props:{options:{type:Object,required:!0},leaflet:{type:Object,required:!0}},setup(e){return{control:new Sa(e.options)}},mounted(){this.leaflet.addControl(this.control)},unmounted(){this.leaflet.removeControl(this.control)},render(){return null}});let Ca=document.getElementById("icon--layers"),fe=document.getElementById("svg-sprite-component-wrap");fe||(fe=document.createElementNS("http://www.w3.org/2000/svg","svg"),fe.id="svg-sprite-component-wrap",fe.style.setProperty("display","none"),document.body.appendChild(fe));if(!Ca){let e=document.createElementNS("http://www.w3.org/2000/svg","symbol");fe.appendChild(e),e.setAttribute("version","1.0"),e.setAttribute("viewBox","0 0 234.46 247.78"),e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.setAttribute("id","icon--layers"),e.innerHTML='<path d="m130.947 2.453 100.256 70.392c4.44 3.118 4.327 7.968-.254 10.876l-111.155 70.56c-4.58 2.908-11.842 2.739-16.282-.379L3.257 83.51c-4.44-3.117-4.327-7.968.253-10.875l111.155-70.56c4.58-2.908 11.842-2.74 16.282.378z"></path><path d="M217.846 154.897 119.79 217.14c-4.58 2.907-11.843 2.738-16.283-.38l-86.895-61.013-13.104 8.317c-4.58 2.908-4.693 7.757-.253 10.875l100.252 70.393c4.44 3.117 11.703 3.285 16.284.378l111.157-70.559c4.58-2.907 4.694-7.759.254-10.876z"></path><path d="m217.846 109.185-98.048 62.24c-4.58 2.908-11.843 2.739-16.283-.378L16.62 110.033 3.517 118.35c-4.58 2.908-4.694 7.759-.254 10.877l100.253 70.39c4.44 3.118 11.703 3.288 16.283.38l111.158-70.56c4.58-2.907 4.693-7.757.253-10.875z"></path>'}let Ta=document.getElementById("icon--checkbox"),ye=document.getElementById("svg-sprite-component-wrap");ye||(ye=document.createElementNS("http://www.w3.org/2000/svg","svg"),ye.id="svg-sprite-component-wrap",ye.style.setProperty("display","none"),document.body.appendChild(ye));if(!Ta){let e=document.createElementNS("http://www.w3.org/2000/svg","symbol");ye.appendChild(e),e.setAttribute("viewBox","0 0 105.15 95.879"),e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.setAttribute("id","icon--checkbox"),e.innerHTML='<path d="M97.014 14.81 48.221 63.603 26.547 41.929l-9.191 9.193L48.22 81.987l57.984-57.986z" stroke="#222" stroke-width="6"></path>'}const Ma=new Set(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Home","End"]),et=(e,t)=>{if(!!e.target){if(Ma.has(e.key)){const o=t.indexOf(e.target);if(o<0)return;let a=o;switch(e.key){case"ArrowUp":case"ArrowLeft":a=o-1;break;case"ArrowDown":case"ArrowRight":a=o+1;break;case"Home":a=0;break;case"End":a=t.length-1;break}a<0?a=t.length-1:a>=t.length&&(a=0),t[a].focus(),e.preventDefault()}else if(e.key==="Enter"&&e.target){const o=new MouseEvent("click",{ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,metaKey:e.metaKey,altKey:e.altKey,bubbles:!0});e.target.dispatchEvent(o),e.preventDefault()}}};g.exports.Control.LayersObject;g.exports.Control.LayersOptions;const te=_();class Aa extends g.exports.Control.Layers{constructor(t,o,a){super(t,o,Object.assign(a,{sortLayers:!0,sortFunction:(r,s,n,i)=>{const c=this._layerPositions.get(r)||0,d=this._layerPositions.get(s)||0;return c!==d?c-d:n<i?-1:n>i?1:0}}));h(this,"_layersButton");h(this,"_layerPositions");h(this,"visible",!1);this._layerPositions=new Map}hasLayer(t){return!!super._getLayer(g.exports.Util.stamp(t))}expand(){this._layersButton.setAttribute("aria-expanded","true"),this._section.style.display="",this.handleResize();const t=this._container.querySelector("input");return t&&t.focus(),super._checkDisabledLayers(),this}collapse(){return this._layersButton.setAttribute("aria-expanded","false"),this._section.style.display="none",this}_initLayout(){const t="leaflet-control-layers",o=this._container=g.exports.DomUtil.create("div",t),a=this._section=g.exports.DomUtil.create("section",t+"-list"),r=this._layersButton=g.exports.DomUtil.create("button",t+"-toggle",o);g.exports.DomEvent.disableClickPropagation(o),g.exports.DomEvent.disableScrollPropagation(o),g.exports.DomEvent.on(r,"keydown",s=>{s.key==="ArrowRight"&&te.commit(p.SET_UI_ELEMENT_VISIBILITY,{element:"layers",state:!0})}),g.exports.DomEvent.on(o,"keydown",s=>{s.key==="ArrowLeft"&&(s.preventDefault(),te.commit(p.SET_UI_ELEMENT_VISIBILITY,{element:"layers",state:!1}),Re(()=>r.focus()));const n=Array.from(o.querySelectorAll("input"));et(s,n)}),g.exports.DomEvent.on(r,"click",()=>te.commit(p.TOGGLE_UI_ELEMENT_VISIBILITY,"layers")),a.style.display="none",r.title=te.state.messages.layersTitle,r.setAttribute("aria-expanded","false"),r.innerHTML=`
			<svg class="svg-icon" aria-hidden="true">
			  <use xlink:href="#icon--layers" />
			</svg>`,C(te.state.ui.visibleElements,s=>{s.has("layers")&&!this.visible?this.expand():this.visible&&!s.has("layers")&&this.collapse(),this.visible=te.state.ui.visibleElements.has("layers")}),C(te.state.messages,s=>r.title=s.layersTitle),this.visible=te.state.ui.visibleElements.has("layers"),this.visible&&this.expand(),this._baseLayersList=g.exports.DomUtil.create("div",t+"-base",a),this._separator=g.exports.DomUtil.create("div",t+"-separator",a),this._overlaysList=g.exports.DomUtil.create("div",t+"-overlays",a),o.appendChild(a),window.addEventListener("resize",()=>this.handleResize()),this.handleResize()}handleResize(){const t=this._layersButton.getBoundingClientRect().y;this._section.style.maxHeight=`calc(100vh - ${t+30+10+55}px)`}addOverlayAtPosition(t,o,a){return this._layerPositions.set(t,a),super.addOverlay(t,o)}addOverlay(t,o){return this._layerPositions.set(t,0),super.addOverlay(t,o)}removeLayer(t){return this._layerPositions.delete(t),super.removeLayer(t)}_addItem(t){const o=t.overlay?this._overlaysList:this._baseLayersList,a=document.createElement("label"),r=document.createElement("span"),s=this._map.hasLayer(t.layer);let n;return a.className="layer checkbox",t.overlay?(n=document.createElement("input"),n.type="checkbox",n.className="leaflet-control-layers-selector",n.defaultChecked=s):n=super._createRadioElement("leaflet-base-layers_"+g.exports.Util.stamp(this),s),n.layerId=g.exports.Util.stamp(t.layer),this._layerControlInputs.push(n),r.textContent=t.name,g.exports.DomEvent.on(n,"click",i=>super._onInputClick(i),this),a.appendChild(n),a.insertAdjacentHTML("beforeend",`
		<svg class="svg-icon" aria-hidden="true">
	  		<use xlink:href="#icon--checkbox" />
		</svg>`),a.appendChild(r),o.appendChild(a),super._checkDisabledLayers(),r}onRemove(t){this._layerControlInputs=[],super.onRemove(t)}}class Pa{constructor(t){h(this,"layerControl");h(this,"map");const o=l(()=>_().state.components.layerControl);this.map=t,this.layerControl=new Aa({},{},{position:"topleft"}),o.value&&this.map.addControl(this.layerControl),C(o,a=>{a?this.map.addControl(this.layerControl):this.map.removeControl(this.layerControl)})}addLayer(t,o,a,r){this.map.addLayer(t),o&&(this.layerControl.hasLayer(t)&&this.layerControl.removeLayer(t),typeof r!="undefined"?this.layerControl.addOverlayAtPosition(t,a,r):this.layerControl.addOverlay(t,a))}addHiddenLayer(t,o,a){this.layerControl.hasLayer(t)&&this.layerControl.removeLayer(t),typeof a!="undefined"?this.layerControl.addOverlayAtPosition(t,o,a):this.layerControl.addOverlay(t,o)}removeLayer(t){this.map.removeLayer(t),this.layerControl.removeLayer(t)}}class Ia extends g.exports.Map{constructor(t,o){super(t,o);h(this,"_layerManager");this._layerManager=Object.seal(new Pa(this))}getLayerManager(){return this._layerManager}_initControlPos(){const t=this._controlCorners={},o="leaflet-",a=this._controlContainer=g.exports.DomUtil.create("div",o+"control-container",this._container);function r(s,n){const i=o+s+" "+o+n;t[`${s}${n}`]=g.exports.DomUtil.create("div",i,a)}r("top","left"),r("top","right"),r("top","center"),r("bottom","center"),r("bottom","left"),r("bottom","right")}}let Ua=document.getElementById("icon--loading"),we=document.getElementById("svg-sprite-component-wrap");we||(we=document.createElementNS("http://www.w3.org/2000/svg","svg"),we.id="svg-sprite-component-wrap",we.style.setProperty("display","none"),document.body.appendChild(we));if(!Ua){let e=document.createElementNS("http://www.w3.org/2000/svg","symbol");we.appendChild(e),e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.setAttribute("stroke","#fff"),e.setAttribute("id","icon--loading"),e.setAttribute("viewBox","0 0 38 38"),e.innerHTML='<g transform="translate(1 1)" stroke-width="2" fill="none"><circle stroke-opacity=".5" cx="18" cy="18" r="18"></circle><path d="M36 18c0-9.94-8.06-18-18-18"><animatetransform attributeName="transform" type="rotate" from="0 18 18" to="360 18 18" dur="1s" repeatCount="indefinite"></animatetransform></path></g>'}class $a extends g.exports.Control{constructor(t){super(t);h(this,"_dataLoaders",new Set);h(this,"_loadingIndicator");h(this,"_delayIndicatorTimeout",null);this._loadingIndicator=g.exports.DomUtil.create("div","leaflet-control-button leaflet-control-loading")}onAdd(t){return this._loadingIndicator.title=_().state.messages.loadingTitle,this._loadingIndicator.hidden=!0,this._loadingIndicator.innerHTML=`
		<svg class="svg-icon">
		  <use xlink:href="#icon--loading" />
		</svg>`,this._addLayerListeners(t),this._addMapListeners(t),this._loadingIndicator}onRemove(t){this._removeLayerListeners(t),this._removeMapListeners(t)}addLoader(t){this._dataLoaders.add(t),this.options.delayIndicator&&!this._delayIndicatorTimeout?this._delayIndicatorTimeout=setTimeout(()=>{this.updateIndicator(),this._delayIndicatorTimeout=null},this.options.delayIndicator):this.updateIndicator()}removeLoader(t){this._dataLoaders.delete(t),this.updateIndicator(),this.options.delayIndicator&&this._delayIndicatorTimeout&&!this.isLoading()&&(clearTimeout(this._delayIndicatorTimeout),this._delayIndicatorTimeout=null)}updateIndicator(){this.isLoading()?this._showIndicator():this._hideIndicator()}isLoading(){return this._countLoaders()>0}_countLoaders(){return this._dataLoaders.size}_showIndicator(){this._loadingIndicator.hidden=!1}_hideIndicator(){this._loadingIndicator.hidden=!0}_handleLoading(t){this.addLoader(this.getEventId(t))}_handleBaseLayerChange(t){t.layer&&t.layer.eachLayer&&typeof t.layer.eachLayer=="function"&&t.layer.eachLayer(o=>{this._handleBaseLayerChange({layer:o})})}_handleLoad(t){this.removeLoader(this.getEventId(t))}getEventId(t){return t.id?t.id:t.layer?t.layer._leaflet_id:t.target._leaflet_id}_layerAdd(t){if(t.layer instanceof g.exports.TileLayer)try{t.layer.isLoading()&&this.addLoader(t.layer._leaflet_id),t.layer.on("loading",this._handleLoading,this),t.layer.on("load",this._handleLoad,this)}catch(o){console.warn("L.Control.Loading: Tried and failed to add  event handlers to layer",t.layer),console.warn("L.Control.Loading: Full details",o)}}_layerRemove(t){if(t.layer instanceof g.exports.TileLayer)try{t.layer.off("loading",this._handleLoading,this),t.layer.off("load",this._handleLoad,this)}catch(o){console.warn("L.Control.Loading: Tried and failed to remove event handlers from layer",t.layer),console.warn("L.Control.Loading: Full details",o)}}_addLayerListeners(t){t.eachLayer(o=>{o instanceof g.exports.TileLayer&&(o.isLoading()&&this.addLoader(o._leaflet_id),o.on("loading",this._handleLoading,this),o.on("load",this._handleLoad,this))}),t.on("layeradd",this._layerAdd,this),t.on("layerremove",this._layerRemove,this)}_removeLayerListeners(t){t.eachLayer(o=>{o instanceof g.exports.TileLayer&&(this.removeLoader(o._leaflet_id),o.off("loading",this._handleLoading,this),o.off("load",this._handleLoad,this))}),t.off("layeradd",this._layerAdd,this),t.off("layerremove",this._layerRemove,this)}_addMapListeners(t){t.on("baselayerchange",this._handleBaseLayerChange,this),t.on("dataloading",this._handleLoading,this),t.on("dataload",this._handleLoad,this),t.on("layerremove",this._handleLoad,this)}_removeMapListeners(t){t.off("baselayerchange",this._handleBaseLayerChange,this),t.off("dataloading",this._handleLoading,this),t.off("dataload",this._handleLoad,this),t.off("layerremove",this._handleLoad,this)}}const za={name:"svg-icon",props:{name:{type:String,required:!0},title:{type:String,default:null}},setup(e){const t=l(()=>`#icon--${e.name}`),o=l(()=>`svg-icon svg-icon--${e.name}`);return{iconPath:t,className:o}}},Oa={key:0},Na=["xlink:href"];function xa(e,t,o,a,r,s){return y(),b("svg",{class:K(a.className),xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true"},[o.title?(y(),b("title",Oa,A(o.title),1)):P("",!0),w("use",{"xlink:href":a.iconPath},null,8,Na)],2)}var We=x(za,[["render",xa]]);let Ra=document.getElementById("icon--block_world_surface"),ve=document.getElementById("svg-sprite-component-wrap");ve||(ve=document.createElementNS("http://www.w3.org/2000/svg","svg"),ve.id="svg-sprite-component-wrap",ve.style.setProperty("display","none"),document.body.appendChild(ve));if(!Ra){let e=document.createElementNS("http://www.w3.org/2000/svg","symbol");ve.appendChild(e),e.setAttribute("version","1.0"),e.setAttribute("viewBox","0 0 232.45 263.09"),e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.setAttribute("id","icon--block_world_surface"),e.innerHTML='<path d="M116.257.415.867 55.325l21.416 10.26 93.994-44.638 93.893 44.636 21.412-10.259z" fill="#66a443" stroke="#66a443"></path><path d="m116.257 110.235-93.894-44.65 93.912-44.635 93.717 44.623z" fill="#77b551" stroke="#77b551"></path><path d="M.87 207.725v-152.4l21.345 10.226c.06 39.51.07 86.343.082 132.49l93.97 44.597v19.867z" fill="#468234" stroke="#468234"></path><path d="m22.296 198.035.048-132.43 93.923 44.642v132.37z" fill="#549141" stroke="#549141"></path><path d="m210.227 197.975-.044-132.39-93.913 44.674v132.37z" fill="#3b823b" stroke="#3b823b"></path><path d="m210.237 65.552-.013 132.42-93.957 44.64V262.5l115.32-54.774v-152.4z" fill="#2c722d" stroke="#2c722d"></path>'}let Da=document.getElementById("icon--block_world_cave"),_e=document.getElementById("svg-sprite-component-wrap");_e||(_e=document.createElementNS("http://www.w3.org/2000/svg","svg"),_e.id="svg-sprite-component-wrap",_e.style.setProperty("display","none"),document.body.appendChild(_e));if(!Da){let e=document.createElementNS("http://www.w3.org/2000/svg","symbol");_e.appendChild(e),e.setAttribute("version","1.0"),e.setAttribute("viewBox","0 0 232.45 263.09"),e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.setAttribute("id","icon--block_world_cave"),e.innerHTML='<path d="M116.257.415.867 55.325l21.416 10.26 93.994-44.638 93.893 44.636 21.412-10.259z" fill="#61585b" stroke="#61585b"></path><path d="m116.257 110.235-93.894-44.65 93.912-44.635 93.717 44.623z" fill="#9ba2a3" stroke="#9ba2a3"></path><path d="m22.296 198.035.048-132.43 93.923 44.642v132.37z" fill="#776d70" stroke="#776d70"></path><path d="M116.267 244.095v-90.23L9.157 204.708z" fill="#7b777e" stroke="#7b777e"></path><path d="M.87 207.725v-152.4l21.345 10.226c.06 39.51.07 86.343.082 132.49l93.97 44.597v19.867z" fill="#67656a" stroke="#67656a"></path><path d="m210.227 197.975-.044-132.39-93.913 44.674v132.37z" fill="#84858b" stroke="#84858b"></path><path d="m210.237 65.552-.013 132.42-93.957 44.64V262.5l115.32-54.774v-152.4z" fill="#838e90" stroke="#838e90"></path>'}let Ha=document.getElementById("icon--block_world_biome"),be=document.getElementById("svg-sprite-component-wrap");be||(be=document.createElementNS("http://www.w3.org/2000/svg","svg"),be.id="svg-sprite-component-wrap",be.style.setProperty("display","none"),document.body.appendChild(be));if(!Ha){let e=document.createElementNS("http://www.w3.org/2000/svg","symbol");be.appendChild(e),e.setAttribute("version","1.0"),e.setAttribute("viewBox","0 0 232.45 263.09"),e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.setAttribute("id","icon--block_world_biome"),e.innerHTML='<path d="M116.257.415.867 55.325l21.416 10.26 93.994-44.638 93.893 44.636 21.412-10.259z" fill="#2c8ed9" stroke="#2c8ed9"></path><path d="m116.257 110.235-93.894-44.65 93.912-44.635 93.717 44.623z" fill="#46c0f1" stroke="#46c0f1"></path><path d="m22.296 198.035.048-132.43 93.923 44.642v132.37z" fill="#ea952b" stroke="#ea952b"></path><path d="M.87 207.725v-152.4l21.345 10.226c.06 39.51.07 86.343.082 132.49l93.97 44.597v19.867z" fill="#e15915" stroke="#e15915"></path><path d="m210.227 197.975-.044-132.39-93.913 44.674v132.37z" fill="#b5279f" stroke="#b5279f"></path><path d="m210.237 65.552-.013 132.42-93.957 44.64V262.5l115.32-54.774v-152.4z" fill="#94116a" stroke="#94116a"></path>'}let Ba=document.getElementById("icon--block_world_flat"),Ee=document.getElementById("svg-sprite-component-wrap");Ee||(Ee=document.createElementNS("http://www.w3.org/2000/svg","svg"),Ee.id="svg-sprite-component-wrap",Ee.style.setProperty("display","none"),document.body.appendChild(Ee));if(!Ba){let e=document.createElementNS("http://www.w3.org/2000/svg","symbol");Ee.appendChild(e),e.setAttribute("version","1.0"),e.setAttribute("viewBox","0 0 224.88 224.88"),e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.setAttribute("id","icon--block_world_flat"),e.innerHTML='<g transform="translate(-3.866 -14.578)"><rect x="11.366" y="22.078" width="209.88" height="209.88" ry="13.523" fill="#56bc3a"></rect><path d="M62.314 231.96h145.41a13.493 13.493 0 0 0 13.523-13.523V86.977c-109.53-19.382-158.93 144.98-158.93 144.98z" fill="#36c1df"></path></g><path opacity=".335" d="M173.19 92.012c-2.987 6.581 23.116 21.259 7.869 36.129-18.502 16.613 8.56 36.592-21.823 51.472-16.422 4.782-43.518-38.241-47.51-10.136-2.672 36.879-43.356 18.551-16.493 53.526H48.02c-4.77-46.459 15.402-83.567 38.889-91.661 63.696-21.95 27.812-40.803 67.037-69.23 24.344-20.731 39.502-33.812 69.05-22.989l-.694 39.645c-15.225 10.522-44.572 3.239-49.113 13.244z" fill="#dece95"></path><g transform="translate(-3.866 -14.578)"><path d="M171.44 100.97c-2.987 6.581 23.116 21.259 7.869 36.129-18.502 16.613 8.56 36.592-21.823 51.472-16.422 4.782-43.518-38.241-47.51-10.136-2.672 36.879-43.356 18.551-16.493 53.526H46.27c-4.77-46.459 15.402-83.567 38.889-91.661 63.695-21.95 27.812-40.803 67.037-69.23 24.344-20.731 39.502-33.812 69.05-22.989l-.694 39.645c-15.225 10.522-44.572 3.239-49.113 13.244z" fill="#dece95"></path><rect x="11.366" y="22.078" width="209.88" height="209.88" ry="13.523" fill="none" stroke="#437c33" stroke-width="15"></rect></g>'}let ja=document.getElementById("icon--block_nether_flat"),Le=document.getElementById("svg-sprite-component-wrap");Le||(Le=document.createElementNS("http://www.w3.org/2000/svg","svg"),Le.id="svg-sprite-component-wrap",Le.style.setProperty("display","none"),document.body.appendChild(Le));if(!ja){let e=document.createElementNS("http://www.w3.org/2000/svg","symbol");Le.appendChild(e),e.setAttribute("version","1.0"),e.setAttribute("viewBox","0 0 224.88 224.88"),e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.setAttribute("id","icon--block_nether_flat"),e.innerHTML='<rect x="11.366" y="22.078" width="209.88" height="209.88" ry="13.523" fill="#443937" transform="translate(-3.866 -14.578)"></rect><path d="M58.448 217.382h145.41a13.493 13.493 0 0 0 13.523-13.523V72.399c-109.53-19.382-158.93 144.98-158.93 144.98z" fill="#dc6725"></path><path opacity=".335" d="M173.19 92.012c-2.987 6.581 23.116 21.259 7.869 36.129-18.502 16.613 8.56 36.592-21.823 51.472-16.422 4.782-43.518-38.241-47.51-10.136-2.672 36.879-43.356 18.551-16.493 53.526H48.02c-4.77-46.459 15.402-83.567 38.889-91.661 63.696-21.95 27.812-40.803 67.037-69.23 24.344-20.731 39.502-33.812 69.05-22.989l-.694 39.645c-15.225 10.522-44.572 3.239-49.113 13.244z" fill="#932626"></path><path d="M167.574 86.392c-2.987 6.581 23.116 21.259 7.869 36.129-18.502 16.613 8.56 36.592-21.823 51.472-16.422 4.782-43.518-38.241-47.51-10.136-2.672 36.879-43.356 18.551-16.493 53.526H42.404c-4.77-46.459 15.402-83.567 38.889-91.661 63.695-21.95 27.812-40.803 67.037-69.23 24.344-20.731 39.502-33.812 69.051-22.989l-.695 39.645c-15.225 10.522-44.572 3.239-49.113 13.244z" fill="#932626"></path><rect x="11.366" y="22.078" width="209.88" height="209.88" ry="13.523" fill="none" stroke="#532727" stroke-width="15" transform="translate(-3.866 -14.578)"></rect>'}let Za=document.getElementById("icon--block_nether_surface"),Se=document.getElementById("svg-sprite-component-wrap");Se||(Se=document.createElementNS("http://www.w3.org/2000/svg","svg"),Se.id="svg-sprite-component-wrap",Se.style.setProperty("display","none"),document.body.appendChild(Se));if(!Za){let e=document.createElementNS("http://www.w3.org/2000/svg","symbol");Se.appendChild(e),e.setAttribute("version","1.0"),e.setAttribute("viewBox","0 0 232.45 263.09"),e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.setAttribute("id","icon--block_nether_surface"),e.innerHTML='<path d="M116.257.415.867 55.325l21.416 10.26 93.994-44.638 93.893 44.636 21.412-10.259z" fill="#ca2717" stroke="#ca2717"></path><path d="m116.257 110.235-93.894-44.65 93.912-44.635 93.717 44.623z" fill="#dc442b" stroke="#dc442b"></path><path d="M.87 207.725v-152.4l21.345 10.226c.06 39.51.07 86.343.082 132.49l93.97 44.597v19.867z" fill="#9d0a17" stroke="#9d0a17"></path><path d="m22.296 198.035.048-132.43 93.923 44.642v132.37z" fill="#b02222" stroke="#b02222"></path><path d="m210.227 197.975-.044-132.39-93.913 44.674v132.37z" fill="#9b212d" stroke="#9b212d"></path><path d="m210.237 65.552-.013 132.42-93.957 44.64V262.5l115.32-54.774v-152.4z" fill="#8a0822" stroke="#8a0822"></path>'}let Wa=document.getElementById("icon--block_the_end_flat"),ke=document.getElementById("svg-sprite-component-wrap");ke||(ke=document.createElementNS("http://www.w3.org/2000/svg","svg"),ke.id="svg-sprite-component-wrap",ke.style.setProperty("display","none"),document.body.appendChild(ke));if(!Wa){let e=document.createElementNS("http://www.w3.org/2000/svg","symbol");ke.appendChild(e),e.setAttribute("version","1.0"),e.setAttribute("viewBox","0 0 224.88 224.88"),e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.setAttribute("id","icon--block_the_end_flat"),e.innerHTML='<g transform="translate(-3.866 -14.578)"><rect x="11.366" y="22.078" width="209.88" height="209.88" ry="13.523" fill="#bfbd7a"></rect><path d="M62.314 231.96h145.41a13.493 13.493 0 0 0 13.523-13.523V86.977c-109.53-19.382-158.93 144.98-158.93 144.98z" fill="#0c0902"></path><path d="M171.44 100.97c-2.987 6.581 23.116 21.259 7.869 36.129-18.502 16.613 8.56 36.592-21.823 51.472-16.422 4.782-43.518-38.241-47.51-10.136-2.672 36.879-43.356 18.551-16.493 53.526H46.27c-4.77-46.459 15.402-83.567 38.889-91.661 63.695-21.95 27.812-40.803 67.037-69.23 24.344-20.731 39.502-33.812 69.05-22.989l-.694 39.645c-15.225 10.522-44.572 3.239-49.113 13.244z" fill="#e6eca4"></path><rect x="11.366" y="22.078" width="209.88" height="209.88" ry="13.523" fill="none" stroke="#534427" stroke-width="15"></rect></g>'}let Ga=document.getElementById("icon--block_the_end_surface"),Ce=document.getElementById("svg-sprite-component-wrap");Ce||(Ce=document.createElementNS("http://www.w3.org/2000/svg","svg"),Ce.id="svg-sprite-component-wrap",Ce.style.setProperty("display","none"),document.body.appendChild(Ce));if(!Ga){let e=document.createElementNS("http://www.w3.org/2000/svg","symbol");Ce.appendChild(e),e.setAttribute("version","1.0"),e.setAttribute("viewBox","0 0 232.45 263.09"),e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.setAttribute("id","icon--block_the_end_surface"),e.innerHTML='<path d="M116.257.415.867 55.325l21.416 10.26 93.994-44.638 93.893 44.636 21.412-10.259z" fill="#cdc683" stroke="#cdc683"></path><path d="m116.257 110.235-93.894-44.65 93.912-44.635 93.717 44.623z" fill="#e1e5ab" stroke="#e1e5ab"></path><path d="M.87 207.725v-152.4l21.345 10.226c.06 39.51.07 86.343.082 132.49l93.97 44.597v19.867z" fill="#b8b372" stroke="#b8b372"></path><path d="m22.296 198.035.048-132.43 93.923 44.642v132.37z" fill="#cdc683" stroke="#cdc683"></path><path d="m210.227 197.975-.044-132.39-93.913 44.674v132.37z" fill="#b4a665" stroke="#b4a665"></path><path d="m210.237 65.552-.013 132.42-93.957 44.64V262.5l115.32-54.774v-152.4z" fill="#908046" stroke="#908046"></path>'}let Fa=document.getElementById("icon--block_other"),Te=document.getElementById("svg-sprite-component-wrap");Te||(Te=document.createElementNS("http://www.w3.org/2000/svg","svg"),Te.id="svg-sprite-component-wrap",Te.style.setProperty("display","none"),document.body.appendChild(Te));if(!Fa){let e=document.createElementNS("http://www.w3.org/2000/svg","symbol");Te.appendChild(e),e.setAttribute("version","1.0"),e.setAttribute("viewBox","0 0 232.45 263.09"),e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.setAttribute("id","icon--block_other"),e.innerHTML='<path d="M116.257.415.867 55.325l21.416 10.26 93.994-44.638 93.893 44.636 21.412-10.259z" fill="#5e6464" stroke="#5e6464"></path><path d="m116.257 110.235-93.894-44.65 93.912-44.635 93.717 44.623z" fill="#929594" stroke="#929594"></path><path d="M.87 207.725v-152.4l21.345 10.226c.06 39.51.07 86.343.082 132.49l93.97 44.597v19.867z" fill="#525252" stroke="#525252"></path><path d="m22.296 198.035.048-132.43 93.923 44.642v132.37z" fill="#696969" stroke="#696969"></path><path d="m210.227 197.975-.044-132.39-93.913 44.674v132.37z" fill="#555356" stroke="#555356"></path><path d="m210.237 65.552-.013 132.42-93.957 44.64V262.5l115.32-54.774v-152.4z" fill="#3c373d" stroke="#3c373d"></path>'}let qa=document.getElementById("icon--block_other_flat"),Me=document.getElementById("svg-sprite-component-wrap");Me||(Me=document.createElementNS("http://www.w3.org/2000/svg","svg"),Me.id="svg-sprite-component-wrap",Me.style.setProperty("display","none"),document.body.appendChild(Me));if(!qa){let e=document.createElementNS("http://www.w3.org/2000/svg","symbol");Me.appendChild(e),e.setAttribute("version","1.0"),e.setAttribute("viewBox","0 0 224.88 224.88"),e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.setAttribute("id","icon--block_other_flat"),e.innerHTML='<g transform="translate(-3.866 -14.578)"><rect x="11.366" y="22.078" width="209.88" height="209.88" ry="13.523" fill="#4c4b51"></rect><path d="M62.314 231.96h145.41a13.493 13.493 0 0 0 13.523-13.523V86.977c-109.53-19.382-158.93 144.98-158.93 144.98z" fill="#332f2e"></path></g><path opacity=".335" d="M173.19 92.012c-2.987 6.581 23.116 21.259 7.869 36.129-18.502 16.613 8.56 36.592-21.823 51.472-16.422 4.782-43.518-38.241-47.51-10.136-2.672 36.879-43.356 18.551-16.493 53.526H48.02c-4.77-46.459 15.402-83.567 38.889-91.661 63.696-21.95 27.812-40.803 67.037-69.23 24.344-20.731 39.502-33.812 69.05-22.989l-.694 39.645c-15.225 10.522-44.572 3.239-49.113 13.244z" fill="#6a7072"></path><g transform="translate(-3.866 -14.578)"><path d="M171.44 100.97c-2.987 6.581 23.116 21.259 7.869 36.129-18.502 16.613 8.56 36.592-21.823 51.472-16.422 4.782-43.518-38.241-47.51-10.136-2.672 36.879-43.356 18.551-16.493 53.526H46.27c-4.77-46.459 15.402-83.567 38.889-91.661 63.695-21.95 27.812-40.803 67.037-69.23 24.344-20.731 39.502-33.812 69.05-22.989l-.694 39.645c-15.225 10.522-44.572 3.239-49.113 13.244z" fill="#6a7072"></path><rect x="11.366" y="22.078" width="209.88" height="209.88" ry="13.523" fill="none" stroke="#13212c" stroke-width="15"></rect></g>'}let Va=document.getElementById("icon--block_skylands"),Ae=document.getElementById("svg-sprite-component-wrap");Ae||(Ae=document.createElementNS("http://www.w3.org/2000/svg","svg"),Ae.id="svg-sprite-component-wrap",Ae.style.setProperty("display","none"),document.body.appendChild(Ae));if(!Va){let e=document.createElementNS("http://www.w3.org/2000/svg","symbol");Ae.appendChild(e),e.setAttribute("version","1.0"),e.setAttribute("viewBox","0 0 232.45 263.09"),e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.setAttribute("id","icon--block_skylands"),e.innerHTML='<path d="M116.257.415.867 55.325l21.416 10.26 93.994-44.638 93.893 44.636 21.412-10.259z" fill="#5cd1e9" stroke="#5cd1e9"></path><path d="m116.257 110.235-93.894-44.65 93.912-44.635 93.717 44.623z" fill="#79edf4" stroke="#79edf4"></path><path d="M.87 207.725v-152.4l21.345 10.226c.06 39.51.07 86.343.082 132.49l93.97 44.597v19.867z" fill="#2076bf" stroke="#2076bf"></path><path d="m22.296 198.035.048-132.43 93.923 44.642v132.37z" fill="#34a7dc" stroke="#34a7dc"></path><path d="m210.227 197.975-.044-132.39-93.913 44.674v132.37z" fill="#005ec9" stroke="#005ec9"></path><path d="m210.237 65.552-.013 132.42-93.957 44.64V262.5l115.32-54.774v-152.4z" fill="#0043aa" stroke="#0043aa"></path>'}const Ka=M({name:"WorldListItem",components:{SvgIcon:We},props:{world:{type:Object,required:!0},name:{type:String,default:"map"}},setup(){const e=_();return{currentMap:l({get:()=>e.state.currentMap?[e.state.currentWorld.name,e.state.currentMap.name]:void 0,set:o=>o&&e.commit(p.SET_CURRENT_MAP,{worldName:o[0],mapName:o[1]})})}}}),Ya={class:"world"},Qa={class:"world__name","aria-hidden":"true"},Ja={class:"world__maps menu"},Xa=["id","name","value","aria-labelledby"],er=["id","for","title"],tr=["src"];function or(e,t,o,a,r,s){const n=E("SvgIcon");return y(),b("div",Ya,[w("span",Qa,A(e.world.displayName),1),w("div",Ja,[(y(!0),b(j,null,Q(e.world.maps,([i,c])=>(y(),b(j,{key:`${e.world.name}_${i}`},[D(w("input",{id:`${e.name}-${e.world.name}-${i}`,type:"radio",name:e.name,value:[e.world.name,c.name],"onUpdate:modelValue":t[0]||(t[0]=d=>e.currentMap=d),"aria-labelledby":`${e.name}-${e.world.name}-${i}-label`},null,8,Xa),[[it,e.currentMap]]),w("label",{id:`${e.name}-${e.world.name}-${i}-label`,class:"map",for:`${e.name}-${e.world.name}-${i}`,title:`${e.world.displayName} - ${c.displayName}`},[c.hasCustomIcon()?(y(),b("img",{key:0,src:c.getIcon(),alt:""},null,8,tr)):(y(),z(n,{key:1,name:c.getIcon()},null,8,["name"]))],8,er)],64))),128))])])}var Xt=x(Ka,[["render",or],["__scopeId","data-v-83fd2ab4"]]);const ar=M({name:"MapContextMenu",components:{WorldListItem:Xt},props:{leaflet:{type:Object,required:!0}},setup(e){const t=_(),o=S(null),a=S(null),r=l(()=>t.state.messages.contextMenuCopyLink),s=l(()=>t.state.messages.contextMenuCenterHere),n=l(()=>t.state.messages.copyToClipboardSuccess),i=l(()=>t.state.messages.copyToClipboardError),c=S(null),d=l(()=>!!o.value),u=l(()=>t.state.currentWorld),m=l(()=>t.state.currentMap),f=l(()=>t.state.currentZoom),k=l(()=>u.value?u.value.maps.size:0),T=l(()=>!o.value||!m.value?{x:0,y:0,z:0}:m.value.latLngToLocation(o.value.latlng,64)),N=l(()=>`X: ${Math.round(T.value.x)}, Z: ${Math.round(T.value.z)}`),I=l(()=>`${Math.round(T.value.x)}, ${Math.round(T.value.z)}`),L=l(()=>{if(!m.value)return"";const $=new URL(window.location.href);return $.hash=Tt(m.value,T.value,f.value),$}),v=l(()=>{if(!o.value)return{visibility:"hidden",left:"-1000px"};const $=Math.min(window.innerWidth-c.value.offsetWidth-10,o.value.originalEvent.clientX),eo=Math.min(window.innerHeight-c.value.offsetHeight-10,o.value.originalEvent.clientY);return{transform:`translate(${$}px, ${eo}px)`}}),O=$=>{$.key==="Escape"&&d.value&&R()},Y=$=>{et($,Array.from(c.value.querySelectorAll("button, input")))},V=()=>{if(c.value){const $=c.value.querySelector("button");$&&$.focus()}},R=()=>o.value=null,re=()=>{o.value&&(e.leaflet.panTo(o.value.latlng),e.leaflet.getContainer().focus())},rt=()=>J(n.value),st=$=>{J({type:"error",text:i.value}),console.error("Error copying to clipboard",$)};return C(o,$=>{$&&(e.leaflet.closePopup(),e.leaflet.closeTooltip(),Re(()=>c.value&&V()))}),H(()=>{window.addEventListener("click",R),window.addEventListener("keyup",O)}),Z(()=>{window.removeEventListener("click",R),window.removeEventListener("keyup",O)}),e.leaflet.on("movestart",R),e.leaflet.on("zoomstart",R),e.leaflet.on("contextmenu",$=>{$.originalEvent.target&&$.originalEvent.target.closest(".leaflet-control")||($.originalEvent.stopImmediatePropagation(),$.originalEvent.preventDefault(),o.value=$)}),e.leaflet.on("mousemove",$=>{a.value=$}),window.addEventListener("contextmenu",$=>{$.target&&$.target instanceof HTMLElement&&$.target.classList.contains("leaflet-zoom-animated")&&($.preventDefault(),$.stopImmediatePropagation(),a.value&&(o.value=a.value))}),{messageCopyLink:r,messageCenterHere:s,copySuccess:rt,copyError:st,menuVisible:d,menuElement:c,url:L,locationLabel:N,locationCopy:I,currentWorld:u,mapCount:k,style:v,pan:re,handleKeydown:Y}}}),rr={class:"menu",role:"menu"},sr={role:"none"},nr={type:"button",role:"menuitem"},ir={role:"none"},lr={type:"button",role:"menuitem"},dr={role:"none"};function cr(e,t,o,a,r,s){const n=E("WorldListItem"),i=lo("clipboard");return y(),b("nav",{role:"none",id:"map-context-menu",ref:"menuElement",style:co(e.style),onKeydown:t[1]||(t[1]=(...c)=>e.handleKeydown&&e.handleKeydown(...c))},[w("ul",rr,[w("li",sr,[D(w("button",nr,[De(A(e.locationLabel),1)],512),[[i,e.locationCopy,"copy"],[i,e.copySuccess,"success"],[i,e.copyError,"error"]])]),w("li",ir,[D(w("button",lr,[De(A(e.messageCopyLink),1)],512),[[i,e.url,"copy"],[i,e.copySuccess,"success"],[i,e.copyError,"error"]])]),w("li",dr,[w("button",{type:"button",role:"menuitem",onClick:t[0]||(t[0]=X((...c)=>e.pan&&e.pan(...c),["prevent"]))},A(e.messageCenterHere),1)]),e.currentWorld&&e.mapCount>1?(y(),z(n,{key:0,world:e.currentWorld,name:"context"},null,8,["world"])):P("",!0)])],36)}var pr=x(ar,[["render",cr],["__scopeId","data-v-46c52050"]]);let mr=document.getElementById("icon--login"),Pe=document.getElementById("svg-sprite-component-wrap");Pe||(Pe=document.createElementNS("http://www.w3.org/2000/svg","svg"),Pe.id="svg-sprite-component-wrap",Pe.style.setProperty("display","none"),document.body.appendChild(Pe));if(!mr){let e=document.createElementNS("http://www.w3.org/2000/svg","symbol");Pe.appendChild(e),e.setAttribute("version","1.0"),e.setAttribute("viewBox","0 0 281.34 277.13"),e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.setAttribute("id","icon--login"),e.innerHTML='<g stroke-linecap="round"><path d="M117.345 0c-15.437 0-28.178 12.74-28.178 28.176v87.008h20V28.176c0-4.702 3.476-8.175 8.178-8.175h135.817c4.703 0 8.177 3.473 8.177 8.175v220.778c0 4.702-3.474 8.176-8.176 8.176H117.344c-4.702 0-8.178-3.474-8.178-8.176V167.24h-20v81.712c0 15.437 12.742 28.178 28.178 28.178h135.817c15.437 0 28.176-12.741 28.176-28.178V28.176C281.339 12.74 268.6 0 253.163 0H117.345z"></path><path d="M148.458 77.933a12.5 12.5 0 0 0-8.848 3.643 12.5 12.5 0 0 0-.04 17.678l29.329 29.457H12.508a12.5 12.5 0 0 0-12.5 12.501 12.5 12.5 0 0 0 12.5 12.5h156.39l-29.328 29.457a12.5 12.5 0 0 0 .04 17.678 12.5 12.5 0 0 0 17.677-.038l50.552-50.777a12.501 12.501 0 0 0 0-17.64l-50.551-50.774a12.5 12.5 0 0 0-8.83-3.683z"></path></g>'}let ur=document.getElementById("icon--logout"),Ie=document.getElementById("svg-sprite-component-wrap");Ie||(Ie=document.createElementNS("http://www.w3.org/2000/svg","svg"),Ie.id="svg-sprite-component-wrap",Ie.style.setProperty("display","none"),document.body.appendChild(Ie));if(!ur){let e=document.createElementNS("http://www.w3.org/2000/svg","symbol");Ie.appendChild(e),e.setAttribute("version","1.0"),e.setAttribute("viewBox","0 0 281.34 277.13"),e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.setAttribute("id","icon--logout"),e.innerHTML='<g stroke-linecap="round"><path d="M117.345 0c-15.437 0-28.178 12.74-28.178 28.176v87.008h20V28.176c0-4.702 3.476-8.175 8.178-8.175h135.817c4.703 0 8.177 3.473 8.177 8.175v220.778c0 4.702-3.474 8.176-8.176 8.176H117.344c-4.702 0-8.178-3.474-8.178-8.176V167.24h-20v81.712c0 15.437 12.742 28.178 28.178 28.178h135.817c15.437 0 28.176-12.741 28.176-28.178V28.176C281.339 12.74 268.6 0 253.163 0z"></path><path d="M63.024 77.933a12.5 12.5 0 0 1 8.848 3.643 12.5 12.5 0 0 1 .04 17.678l-29.329 29.457h156.39a12.5 12.5 0 0 1 12.5 12.501 12.5 12.5 0 0 1-12.5 12.5H42.583l29.328 29.457a12.5 12.5 0 0 1-.04 17.678 12.5 12.5 0 0 1-17.677-.038L3.642 150.032a12.501 12.501 0 0 1 0-17.64l50.552-50.774a12.5 12.5 0 0 1 8.83-3.683z"></path></g>'}class hr extends g.exports.Control{constructor(t){super(t);h(this,"store",_());h(this,"loggedIn",l(()=>this.store.state.loggedIn));h(this,"_button");this._button=g.exports.DomUtil.create("button","leaflet-control-bottom leaflet-control-button leaflet-control-login"),this._button.type="button",this._button.addEventListener("click",async a=>{a.stopPropagation(),a.preventDefault(),await this.handleClick()}),g.exports.DomEvent.on(this._button,"keydown",async a=>{a.key==="ArrowRight"&&(a.stopPropagation(),a.preventDefault(),await this.handleClick())}),C(this.loggedIn,()=>{this.update()});const o=l(()=>this.store.state.ui.visibleModal);C(o,(a,r)=>{this._button.setAttribute("aria-expanded",(a==="login").toString()),this._map&&!a&&r==="login"&&this._button.focus()}),this.update()}onAdd(){return this._button}update(){this._button.title=this.loggedIn.value?this.store.state.messages.logoutTitle:this.store.state.messages.loginTitle,this._button.innerHTML=`
			<svg class="svg-icon">
			  <use xlink:href="#icon--${this.loggedIn.value?"logout":"login"}" />
			</svg>`}async handleClick(){const t=l(()=>this.store.state.messages.logoutSuccess),o=l(()=>this.store.state.messages.logoutErrorUnknown);if(this.loggedIn.value)try{await this.store.dispatch(U.LOGOUT,void 0),J(t.value)}catch{J(o.value)}else this.store.commit(p.SHOW_UI_MODAL,"login")}}const gr=M({props:{leaflet:{type:Object,required:!0}},setup(e){const t=new hr({position:"topleft"});H(()=>e.leaflet.addControl(t)),Z(()=>e.leaflet.removeControl(t))},render(){return null}});const fr=M({components:{MapContextMenu:pr,MapLayer:Ko,PlayersLayer:ta,MarkerSetLayer:da,CoordinatesControl:ca,ClockControl:ya,LinkControl:_a,ChatControl:La,LogoControl:ka,LoginControl:gr},setup(){const e=_(),t=void 0,o=l(()=>e.state.maps),a=l(()=>e.state.markerSets),r=l(()=>e.state.configuration),s=l(()=>e.getters.playerMarkersEnabled),n=l(()=>e.getters.coordinatesControlEnabled),i=l(()=>e.getters.clockControlEnabled),c=l(()=>e.state.components.linkControl),d=l(()=>e.state.components.chatBox),u=l(()=>e.state.components.login),m=l(()=>e.state.components.logoControls),f=l(()=>e.state.currentWorld),k=l(()=>e.state.currentMap),T=l(()=>e.getters.mapBackground),N=l(()=>e.state.followTarget),I=l(()=>e.state.panTarget),L=l(()=>e.state.parsedUrl),v=S(null),O=S(null),Y=l(()=>e.state.messages.mapTitle);return{leaflet:t,maps:o,markerSets:a,configuration:r,playerMarkersEnabled:s,coordinatesControlEnabled:n,clockControlEnabled:i,linkControlEnabled:c,chatBoxEnabled:d,loginEnabled:u,logoControls:m,followTarget:N,panTarget:I,parsedUrl:L,mapBackground:T,currentWorld:f,currentMap:k,scheduledPan:v,scheduledZoom:O,mapTitle:Y}},watch:{followTarget:{handler(e,t){e&&this.updateFollow(e,!t||e.name!==t.name)},deep:!0},panTarget(e){e&&(this.currentWorld&&e.location.world===this.currentWorld.name&&_().commit(p.CLEAR_PAN_TARGET,void 0),this.updateFollow(e,!1))},currentMap(e,t){if(this.leaflet&&e){let o=this.scheduledPan;!o&&t?o=t.latLngToLocation(this.leaflet.getCenter(),64):o||(o={x:0,y:0,z:0}),this.scheduledZoom&&this.leaflet.setZoom(this.scheduledZoom,{animate:!1}),this.leaflet.panTo(e.locationToLatLng(o),{animate:!1,noMoveStart:!0}),this.scheduledZoom=null,this.scheduledPan=null}},currentWorld(e,t){var a,r,s;const o=_();if(e){let n=this.scheduledPan;if(o.state.followTarget&&o.state.followTarget.location.world===e.name)return;if(o.state.panTarget&&o.state.panTarget.location.world===e.name){o.commit(p.CLEAR_PAN_TARGET,void 0);return}else((a=o.state.parsedUrl)==null?void 0:a.location)?(n=o.state.parsedUrl.location,t||(typeof((r=o.state.parsedUrl)==null?void 0:r.zoom)!="undefined"?this.scheduledZoom=(s=o.state.parsedUrl)==null?void 0:s.zoom:typeof e.defaultZoom!="undefined"?this.scheduledZoom=e.defaultZoom:this.scheduledZoom=o.state.configuration.defaultZoom),o.commit(p.CLEAR_PARSED_URL,void 0)):n=e.center;this.scheduledZoom==null&&(typeof e.defaultZoom!="undefined"?this.scheduledZoom=e.defaultZoom:this.scheduledZoom=o.state.configuration.defaultZoom),this.scheduledPan=n}},parsedUrl:{handler(e){if(!(!e||!this.currentMap||!this.leaflet))if(e.world!==this.currentWorld.name||e.map!==this.currentMap.name){this.scheduledPan=e.location,this.scheduledZoom=e.zoom;try{_().commit(p.SET_CURRENT_MAP,{worldName:e.world,mapName:e.map})}catch(t){console.warn("Failed to handle URL change",t),this.scheduledPan=null,this.scheduledZoom=null}}else this.scheduledPan=null,this.scheduledZoom=null,this.leaflet.setZoom(e.zoom,{animate:!1}),this.leaflet.panTo(this.currentMap.locationToLatLng(e.location),{animate:!1,noMoveStart:!0})},deep:!0}},mounted(){this.leaflet=new Ia(this.$el.nextElementSibling,Object.freeze({zoom:this.configuration.defaultZoom,center:new g.exports.LatLng(0,0),fadeAnimation:!1,zoomAnimation:!0,zoomControl:!0,preferCanvas:!0,attributionControl:!1,crs:g.exports.CRS.Simple,worldCopyJump:!1})),window.addEventListener("keydown",this.handleKeydown),this.leaflet.createPane("vectors"),this.leaflet.addControl(new $a({position:"topleft",delayIndicator:500})),this.leaflet.on("moveend",()=>{this.currentMap&&_().commit(p.SET_CURRENT_LOCATION,this.currentMap.latLngToLocation(this.leaflet.getCenter(),64))}),this.leaflet.on("zoomend",()=>{_().commit(p.SET_CURRENT_ZOOM,this.leaflet.getZoom())})},unmounted(){window.removeEventListener("keydown",this.handleKeydown),this.leaflet.remove()},methods:{handleKeydown(e){e.key==="Escape"&&(e.preventDefault(),this.leaflet.getContainer().focus())},updateFollow(e,t){var i;const o=_(),a=o.state.configuration.followMap,r=o.state.currentWorld;let s=null;if(!this.leaflet){console.warn(`Cannot follow ${e.name}. Map not yet initialized.`);return}if(e.hidden){console.warn(`Cannot follow ${e.name}. Player is hidden from the map.`);return}if(!e.location.world){console.warn(`Cannot follow ${e.name}. Player isn't in a known world.`);return}if(!r||r.name!==e.location.world?s=o.state.worlds.get(e.location.world):s=r,!s){console.warn(`Cannot follow ${e.name}. Player isn't in a known world.`);return}let n=a&&s.maps.has(a)?s.maps.get(a):s.maps.entries().next().value[1];n!==o.state.currentMap&&(s!==r||t)?(this.scheduledPan=e.location,t&&o.state.configuration.followZoom&&(console.log(`Setting zoom for new follow ${o.state.configuration.followZoom}`),this.scheduledZoom=o.state.configuration.followZoom),console.log(`Switching map to match player ${s.name} ${n.name}`),o.commit(p.SET_CURRENT_MAP,{worldName:s.name,mapName:n.name})):(this.leaflet.panTo((i=o.state.currentMap)==null?void 0:i.locationToLatLng(e.location)),t&&o.state.configuration.followZoom&&(console.log(`Setting zoom for new follow ${o.state.configuration.followZoom}`),this.leaflet.setZoom(o.state.configuration.followZoom)))}}}),yr=["aria-label"];function wr(e,t,o,a,r,s){const n=E("MapLayer"),i=E("PlayersLayer"),c=E("MarkerSetLayer"),d=E("LogoControl"),u=E("CoordinatesControl"),m=E("LinkControl"),f=E("ClockControl"),k=E("LoginControl"),T=E("ChatControl"),N=E("MapContextMenu");return y(),b(j,null,[w("div",po({class:"map",style:{backgroundColor:e.mapBackground}},e.$attrs,{"aria-label":e.mapTitle}),[e.leaflet?(y(),b(j,{key:0},[(y(!0),b(j,null,Q(e.maps,([I,L])=>(y(),z(n,{key:I,map:L,name:I,leaflet:e.leaflet},null,8,["map","name","leaflet"]))),128)),e.playerMarkersEnabled?(y(),z(i,{key:0,leaflet:e.leaflet},null,8,["leaflet"])):P("",!0),(y(!0),b(j,null,Q(e.markerSets,([I,L])=>(y(),z(c,{key:I,markerSet:L,leaflet:e.leaflet},null,8,["markerSet","leaflet"]))),128)),(y(!0),b(j,null,Q(e.logoControls,I=>(y(),z(d,{key:JSON.stringify(I),options:I,leaflet:e.leaflet},null,8,["options","leaflet"]))),128)),e.coordinatesControlEnabled?(y(),z(u,{key:1,leaflet:e.leaflet},null,8,["leaflet"])):P("",!0),e.linkControlEnabled?(y(),z(m,{key:2,leaflet:e.leaflet},null,8,["leaflet"])):P("",!0),e.clockControlEnabled?(y(),z(f,{key:3,leaflet:e.leaflet},null,8,["leaflet"])):P("",!0),e.loginEnabled?(y(),z(k,{key:4,leaflet:e.leaflet},null,8,["leaflet"])):P("",!0),e.chatBoxEnabled?(y(),z(T,{key:5,leaflet:e.leaflet},null,8,["leaflet"])):P("",!0)],64)):P("",!0)],16,yr),e.leaflet?(y(),z(N,{key:0,leaflet:e.leaflet},null,8,["leaflet"])):P("",!0)],64)}var vr=x(fr,[["render",wr],["__scopeId","data-v-71439ee1"]]);const _r=M({name:"PlayerListItem",props:{player:{type:Object,required:!0}},setup(e){const t=_(),o=l(()=>t.state.components.playerList.showImages),a=S(Ze),r=l(()=>{var m;return((m=t.state.components.playerMarkers)==null?void 0:m.grayHiddenPlayers)&&!e.player.hidden&&(!t.state.currentWorld||t.state.currentWorld.name!==e.player.location.world)}),s=l(()=>e.player.hidden?t.state.messages.playersTitleHidden:r.value?t.state.messages.playersTitleOtherWorld:t.state.messages.playersTitle),n=l(()=>t.state.followTarget?t.state.followTarget.name:void 0),i=()=>{e.player.hidden||(t.commit(p.CLEAR_FOLLOW_TARGET,void 0),t.commit(p.SET_PAN_TARGET,e.player))},c=()=>t.commit(p.SET_FOLLOW_TARGET,e.player),d=m=>{m.preventDefault(),m.shiftKey?c():i()},u=m=>{m.shiftKey||m.detail===2?c():i()};return H(()=>{o.value&&Ve(e.player,"small").then(m=>a.value=m.src).catch(()=>{})}),{imagesEnabled:o,image:a,title:s,otherWorld:r,followTarget:n,onInputClick:d,onLabelClick:u}}}),br=["id","value"],Er=["for","title"],Lr=["src"],Sr=["innerHTML"];function kr(e,t,o,a,r,s){return y(),b(j,null,[D(w("input",{id:`player-${e.player.name}`,type:"radio",name:"player",value:e.player.name,"onUpdate:modelValue":t[0]||(t[0]=n=>e.followTarget=n),onClick:t[1]||(t[1]=X((...n)=>e.onInputClick&&e.onInputClick(...n),["prevent"]))},null,8,br),[[it,e.followTarget]]),w("label",{for:`player-${e.player.name}`,class:K({player:!0,"player--hidden":!!e.player.hidden,"player--other-world":e.otherWorld}),title:e.title,onClick:t[2]||(t[2]=X((...n)=>e.onLabelClick&&e.onLabelClick(...n),["prevent"]))},[e.imagesEnabled?(y(),b("img",{key:0,width:"16",height:"16",class:"player__icon",src:e.image,alt:"","aria-hidden":"true"},null,8,Lr)):P("",!0),w("span",{class:"player__name",innerHTML:e.player.displayName},null,8,Sr)],10,Er)],64)}var Cr=x(_r,[["render",kr],["__scopeId","data-v-7b033e06"]]);let Tr=document.getElementById("icon--arrow"),Ue=document.getElementById("svg-sprite-component-wrap");Ue||(Ue=document.createElementNS("http://www.w3.org/2000/svg","svg"),Ue.id="svg-sprite-component-wrap",Ue.style.setProperty("display","none"),document.body.appendChild(Ue));if(!Tr){let e=document.createElementNS("http://www.w3.org/2000/svg","symbol");Ue.appendChild(e),e.setAttribute("version","1.0"),e.setAttribute("viewBox","0 0 234.46 247.78"),e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.setAttribute("id","icon--arrow"),e.innerHTML='<path d="M19.626 58.589a15.46 15.46 0 0 0-10.963 4.556l-1.165 1.164a15.47 15.47 0 0 0 0 21.925l98.421 98.421a15.436 15.436 0 0 0 11.312 4.537 15.435 15.435 0 0 0 11.31-4.537l98.42-98.42a15.47 15.47 0 0 0 0-21.926l-1.164-1.164a15.468 15.468 0 0 0-21.923 0L117.23 149.79 30.586 63.145a15.45 15.45 0 0 0-10.96-4.556z"></path>'}const Mr=M({name:"CollapsibleSection",components:{SvgIcon:We},props:{name:{type:String,required:!0}},setup(e){const t=_(),o=l(()=>t.state.messages.toggleTitle),a=l(()=>t.state.ui.sidebar.collapsedSections.has(e.name));return{title:o,collapsed:a,toggle:()=>t.commit(p.TOGGLE_SIDEBAR_SECTION_COLLAPSED_STATE,e.name)}}}),Ar={class:"section__heading"},Pr=["id","title","aria-expanded","aria-controls"],Ir=["id","aria-hidden"];function Ur(e,t,o,a,r,s){const n=E("SvgIcon");return y(),b("section",{class:K({sidebar__section:!0,"section--collapsible":!0,"section--collapsed":e.collapsed})},[w("h2",Ar,[w("button",{id:`${e.name}-heading`,type:"button",onClick:t[0]||(t[0]=X((...i)=>e.toggle&&e.toggle(...i),["prevent"])),title:e.title,"aria-expanded":!e.collapsed,"aria-controls":`${e.name}-content`},[w("span",null,[He(e.$slots,"heading",{},void 0,!0)]),W(n,{name:"arrow"})],8,Pr)]),w("div",{id:`${e.name}-content`,"aria-hidden":e.collapsed},[He(e.$slots,"default",{},void 0,!0)],8,Ir)],2)}var ft=x(Mr,[["render",Ur],["__scopeId","data-v-fffa34d6"]]);const $r=M({name:"RadioList",setup(){return{onKeydown:t=>{et(t,Array.from(t.currentTarget.elements))}}}});function zr(e,t,o,a,r,s){return y(),b("fieldset",{class:"menu",role:"radiogroup",onKeydown:t[0]||(t[0]=(...n)=>e.onKeydown&&e.onKeydown(...n))},[He(e.$slots,"default")],32)}var yt=x($r,[["render",zr]]);const Or=M({components:{RadioList:yt,CollapsibleSection:ft,PlayerListItem:Cr},setup(){const e=_(),t=l(()=>e.getters.playersHeading),o=l(()=>e.state.messages.playersSkeleton),a=l(()=>e.state.messages.playersSearchSkeleton),r=l(()=>e.state.messages.playersSearchPlaceholder),s=l(()=>e.state.ui.playersSearch),n=S(""),i=l(()=>e.state.sortedPlayers),c=l(()=>{const m=n.value.toLowerCase();return m?e.state.sortedPlayers.filter(f=>f.name.toLowerCase().indexOf(m)>-1):e.state.sortedPlayers}),d=l(()=>e.state.maxPlayers||0);return{messageHeading:t,messageSkeletonPlayers:o,messageSkeletonPlayersSearch:a,messagePlayersSearchPlaceholder:r,searchEnabled:s,searchQuery:n,players:i,filteredPlayers:c,maxPlayers:d,onKeydown:m=>{m.stopImmediatePropagation()}}}}),Nr={class:"section__content"},xr=["placeholder"],Rr={key:2,class:"section__skeleton"},Dr={key:3,class:"section__skeleton"};function Hr(e,t,o,a,r,s){const n=E("PlayerListItem"),i=E("RadioList"),c=E("CollapsibleSection");return y(),z(c,{name:"players",class:"players"},{heading:F(()=>[De(A(e.messageHeading),1)]),default:F(()=>[w("div",Nr,[e.players&&e.searchEnabled?D((y(),b("input",{key:0,id:"players__search",type:"text",name:"search","onUpdate:modelValue":t[0]||(t[0]=d=>e.searchQuery=d),placeholder:e.messagePlayersSearchPlaceholder,onKeydown:t[1]||(t[1]=(...d)=>e.onKeydown&&e.onKeydown(...d))},null,40,xr)),[[ee,e.searchQuery]]):P("",!0),e.filteredPlayers.length?(y(),z(i,{key:1,"aria-labelledby":"players-heading"},{default:F(()=>[(y(!0),b(j,null,Q(e.filteredPlayers,d=>(y(),z(n,{key:d.name,player:d},null,8,["player"]))),128))]),_:1})):e.searchQuery?(y(),b("div",Rr,A(e.messageSkeletonPlayersSearch),1)):(y(),b("div",Dr,A(e.messageSkeletonPlayers),1))])]),_:1})}var Br=x(Or,[["render",Hr],["__scopeId","data-v-95db2048"]]);const jr=M({name:"WorldList",components:{RadioList:yt,CollapsibleSection:ft,WorldListItem:Xt},props:{prefix:{type:String,default:"map"}},setup(){const e=_(),t=l(()=>e.state.messages.worldsHeading),o=l(()=>e.state.messages.worldsSkeleton),a=l(()=>e.state.worlds),r=l(()=>e.state.currentServer?e.state.currentServer.id:void 0);return{heading:t,skeleton:o,worlds:a,currentServer:r}}}),Zr={key:1,class:"section__content section__skeleton"};function Wr(e,t,o,a,r,s){const n=E("WorldListItem"),i=E("RadioList"),c=E("CollapsibleSection");return y(),z(c,{name:"maps"},{heading:F(()=>[De(A(e.heading),1)]),default:F(()=>[e.worlds.size?(y(),z(i,{key:0,class:"section__content","aria-labelledby":"maps-heading"},{default:F(()=>[(y(!0),b(j,null,Q(e.worlds,([d,u])=>(y(),z(n,{world:u,key:`${e.prefix}_${e.currentServer}_${d}`},null,8,["world"]))),128))]),_:1})):(y(),b("div",Zr,A(e.skeleton),1))]),_:1})}var Gr=x(jr,[["render",Wr]]);const Fr=M({name:"ServerListItem",props:{server:{type:Object,required:!0}},setup(){const e=_();return{currentServer:l({get:()=>e.state.currentServer?e.state.currentServer.id:void 0,set:o=>o&&e.commit(p.SET_CURRENT_SERVER,o)})}}}),qr=["id","value"],Vr=["for"];function Kr(e,t,o,a,r,s){return y(),b(j,null,[D(w("input",{id:`server-${e.server.id}`,type:"radio",name:"server",value:e.server.id,"onUpdate:modelValue":t[0]||(t[0]=n=>e.currentServer=n)},null,8,qr),[[it,e.currentServer]]),w("label",{for:`server-${e.server.id}`},A(e.server.label||e.server.id),9,Vr)],64)}var Yr=x(Fr,[["render",Kr]]);const Qr=M({name:"ServerList",components:{RadioList:yt,CollapsibleSection:ft,ServerListItem:Yr},setup(){const e=_(),t=l(()=>e.state.messages.serversHeading),o=l(()=>e.state.servers);return{heading:t,servers:o}}});function Jr(e,t,o,a,r,s){const n=E("ServerListItem"),i=E("RadioList"),c=E("CollapsibleSection");return e.servers.size>1?(y(),z(c,{key:0,name:"servers"},{heading:F(()=>[De(A(e.heading),1)]),default:F(()=>[W(i,{class:"section__content","aria-labelledby":"servers-heading"},{default:F(()=>[(y(!0),b(j,null,Q(e.servers,([d,u])=>(y(),z(n,{server:u,key:d},null,8,["server"]))),128))]),_:1})]),_:1})):P("",!0)}var Xr=x(Qr,[["render",Jr]]);let es=document.getElementById("icon--cross"),$e=document.getElementById("svg-sprite-component-wrap");$e||($e=document.createElementNS("http://www.w3.org/2000/svg","svg"),$e.id="svg-sprite-component-wrap",$e.style.setProperty("display","none"),document.body.appendChild($e));if(!es){let e=document.createElementNS("http://www.w3.org/2000/svg","symbol");$e.appendChild(e),e.setAttribute("version","1.0"),e.setAttribute("viewBox","0 0 228.57 228.45"),e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.setAttribute("id","icon--cross"),e.innerHTML='<path d="M16.682 0A15.46 15.46 0 0 0 5.719 4.556L4.554 5.72a15.47 15.47 0 0 0 0 21.924l86.578 86.578L4.554 200.8a15.47 15.47 0 0 0 0 21.924l1.165 1.165a15.46 15.46 0 0 0 10.963 4.556 15.45 15.45 0 0 0 10.96-4.556l86.646-86.644 86.643 86.644a15.468 15.468 0 0 0 21.923 0l1.165-1.165a15.47 15.47 0 0 0 0-21.924l-86.578-86.578 86.578-86.578a15.47 15.47 0 0 0 0-21.924l-1.165-1.164a15.468 15.468 0 0 0-21.923 0L114.288 91.2 27.642 4.556A15.45 15.45 0 0 0 16.682 0z"></path>'}const ts=M({name:"FollowTarget",components:{SvgIcon:We},props:{target:{type:Object,required:!0}},setup(e){const t=_(),o=l(()=>t.state.components.playerList.showImages),a=S(Ze),r=S(e.target.name),s=l(()=>t.state.messages.followingHeading),n=l(()=>t.state.messages.followingUnfollow),i=l(()=>t.state.messages.followingTitleUnfollow),c=l(()=>t.state.messages.followingHidden),d=()=>{t.commit(p.CLEAR_FOLLOW_TARGET,void 0)},u=async()=>{if(a.value=Ze,o.value)try{const m=await Ve(e.target,"small");a.value=m.src}catch{}};return C(r,()=>u()),H(()=>u()),{imagesEnabled:o,image:a,unfollow:d,heading:s,messageUnfollow:n,messageUnfollowTitle:i,messageHidden:c}}}),os={class:"sidebar__section following"},as=["src"],rs=["innerHTML"],ss=["title","aria-label"];function ns(e,t,o,a,r,s){const n=E("SvgIcon");return y(),b("section",os,[w("h2",null,A(e.heading),1),w("div",{class:K({following__target:!0,"following__target--hidden":e.target.hidden})},[e.imagesEnabled?(y(),b("img",{key:0,width:"32",height:"32",class:"target__icon",src:e.image,alt:""},null,8,as)):P("",!0),w("span",{class:"target__name",innerHTML:e.target.displayName},null,8,rs),D(w("span",{class:"target__status"},A(e.messageHidden),513),[[oe,e.target.hidden]]),w("button",{class:"target__unfollow",type:"button",title:e.messageUnfollowTitle,onClick:t[0]||(t[0]=X((...i)=>e.unfollow&&e.unfollow(...i),["prevent"])),"aria-label":e.messageUnfollow},[W(n,{name:"cross"})],8,ss)],2)])}var is=x(ts,[["render",ns],["__scopeId","data-v-774c7f72"]]);let ls=document.getElementById("icon--players"),ze=document.getElementById("svg-sprite-component-wrap");ze||(ze=document.createElementNS("http://www.w3.org/2000/svg","svg"),ze.id="svg-sprite-component-wrap",ze.style.setProperty("display","none"),document.body.appendChild(ze));if(!ls){let e=document.createElementNS("http://www.w3.org/2000/svg","symbol");ze.appendChild(e),e.setAttribute("version","1.0"),e.setAttribute("viewBox","0 0 258.05 271.18"),e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.setAttribute("id","icon--players"),e.innerHTML='<path transform="scale(.75)" d="M115.9.336c-38.033 0-68.865 31.036-68.865 69.32 0 33.275 23.296 61.06 54.363 67.766 5.86-43.301 38.447-78.411 80.457-87.72C173.34 21.149 147.041.337 115.9.337z"></path><path d="M95.745 173.72c-2.582 0-4.277 1.426-7.451 3.963-6.024 4.835-13.794 12.383-17.453 16.954-9.996 12.49-17.467 29.232-20.862 46.753-1.88 9.697-2.612 23.496-1.355 25.53 1.462 2.365 6.553 4.245 14.492 4.245 60.371.021 124.23.005 179.81 0 7.94 0 13.03-1.88 14.492-4.245 1.257-2.034.525-15.833-1.354-25.53-3.395-17.52-10.866-34.264-20.862-46.753-3.658-4.57-11.43-12.12-17.453-16.954-3.174-2.537-4.868-3.963-7.45-3.963-1.49 0-3.196 1.051-5.583 2.9-14.03 11.747-32.038 18.837-51.695 18.918-19.657-.081-37.665-7.172-51.695-18.918-2.389-1.849-4.095-2.9-5.584-2.9z"></path><g stroke-width=".921"><path d="M206.11 77.176c0 42.623-34.327 77.176-76.671 77.176-42.344 0-76.671-34.553-76.671-77.176C52.768 34.553 87.095 0 129.439 0c42.344 0 76.671 34.553 76.671 77.176" transform="translate(47.674 50.748) scale(.81399)"></path><path d="M129.44-.375c-42.548 0-77.045 34.726-77.045 77.551 0 42.824 34.497 77.551 77.045 77.551s77.047-34.726 77.047-77.551S171.988-.375 129.44-.375zm0 .75c42.14 0 76.297 34.379 76.297 76.801 0 42.422-34.157 76.801-76.297 76.801s-76.295-34.379-76.295-76.801C53.145 34.754 87.3.375 129.44.375z" transform="translate(47.674 50.748) scale(.81399)"></path></g><path transform="scale(.75)" d="M52.684 136.03c-2.85 0-4.718 1.573-8.22 4.373-6.647 5.334-15.222 13.665-19.259 18.709-11.03 13.781-19.273 32.255-23.02 51.588C.112 221.4-.698 236.628.69 238.872c1.613 2.61 7.232 4.684 15.992 4.684 21.846.008 42.85-.001 65.066 0 6.605-7.58 15.31-15.7 23.461-22.242l.012-.012.016-.014c2.044-1.635 4.034-3.417 7.6-5.517 1.973-1.163 4.658-2.296 7.571-3.086-11.19-15.375-18.287-33.905-19.69-53.941-15.745-2.765-30.084-9.644-41.872-19.514-2.635-2.04-4.516-3.2-6.16-3.2z"></path>'}let ds=document.getElementById("icon--maps"),Oe=document.getElementById("svg-sprite-component-wrap");Oe||(Oe=document.createElementNS("http://www.w3.org/2000/svg","svg"),Oe.id="svg-sprite-component-wrap",Oe.style.setProperty("display","none"),document.body.appendChild(Oe));if(!ds){let e=document.createElementNS("http://www.w3.org/2000/svg","symbol");Oe.appendChild(e),e.setAttribute("version","1.0"),e.setAttribute("viewBox","0 0 268.83 266.53"),e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.setAttribute("id","icon--maps"),e.innerHTML='<path d="M5.235.662C2.153.606 0 2.945 0 6.912v216.577c0 5.288 3.828 11.41 8.582 13.725l57.835 28.165c4.755 2.316 8.582-.078 8.582-5.367V43.434c0-5.288-3.827-11.41-8.582-13.727L8.582 1.544C7.394.965 6.262.681 5.235.662zm32.283 135.96c14.394 0 26.062 11.669 26.062 26.063 0 14.394-24.167 59.55-26.062 57.654-1.854 1.854-26.063-43.26-26.063-57.654 0-14.394 11.669-26.063 26.063-26.063zM202.388 1.013l57.833 28.165c4.755 2.315 8.583 8.437 8.583 13.726v216.58c0 5.29-3.828 7.683-8.583 5.367l-57.833-28.164c-4.755-2.316-8.583-8.438-8.583-13.727V6.38c0-5.289 3.828-7.682 8.583-5.367zM172.012.39c-1.051-.035-2.209.191-3.426.709l-68.342 29.053c-4.867 2.07-8.786 7.993-8.786 13.282V260.01c0 5.29 3.919 7.88 8.786 5.811l68.342-29.053c4.867-2.07 8.786-7.991 8.786-13.28V6.91c0-3.967-2.204-6.417-5.36-6.521zm-36.949 41.216c14.394 0 26.063 11.668 26.063 26.062 0 14.394-24.168 59.55-26.063 57.655C133.209 127.177 109 82.063 109 67.668c0-14.394 11.669-26.062 26.063-26.062z"></path><path d="M48.573 162.689a11.056 11.056 0 0 1-11.056 11.056 11.056 11.056 0 0 1-11.056-11.056 11.056 11.056 0 0 1 11.056-11.056 11.056 11.056 0 0 1 11.056 11.056zm97.547-95.02a11.056 11.056 0 0 1-11.057 11.056 11.056 11.056 0 0 1-11.056-11.056 11.056 11.056 0 0 1 11.056-11.056 11.056 11.056 0 0 1 11.056 11.056z"></path>'}let cs=document.getElementById("icon--servers"),Ne=document.getElementById("svg-sprite-component-wrap");Ne||(Ne=document.createElementNS("http://www.w3.org/2000/svg","svg"),Ne.id="svg-sprite-component-wrap",Ne.style.setProperty("display","none"),document.body.appendChild(Ne));if(!cs){let e=document.createElementNS("http://www.w3.org/2000/svg","symbol");Ne.appendChild(e),e.setAttribute("version","1.0"),e.setAttribute("viewBox","0 0 228.1 227.44"),e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.setAttribute("id","icon--servers"),e.innerHTML='<g stroke-linecap="round" stroke-linejoin="bevel" stroke-width="30"><path d="M107.55 182.2v9.215h-.318a4.671 4.671 0 0 0-4.681 4.682v6.895h-.897a4.672 4.672 0 0 0-4.682 4.683v13.635a4.672 4.672 0 0 0 4.682 4.683h24.791a4.672 4.672 0 0 0 4.682-4.683v-13.635a4.672 4.672 0 0 0-4.682-4.683h-.895v-6.895a4.671 4.671 0 0 0-4.682-4.682h-.317V182.2zM11.637 0A11.611 11.611 0 0 0 0 11.637v30.895c0 6.447 5.19 11.637 11.637 11.637h204.82c6.447 0 11.638-5.19 11.638-11.637V11.637A11.613 11.613 0 0 0 216.457 0zm7.207 16.748h65.322a4.432 4.432 0 0 1 4.441 4.441V32.98a4.432 4.432 0 0 1-4.441 4.442H18.844a4.43 4.43 0 0 1-4.44-4.442V21.19a4.43 4.43 0 0 1 4.44-4.442zm184.49 0a10.336 10.336 0 0 1 10.337 10.337 10.336 10.336 0 0 1-10.337 10.336 10.336 10.336 0 0 1-10.336-10.336 10.336 10.336 0 0 1 10.336-10.337zM11.637 61.5A11.611 11.611 0 0 0 0 73.137v30.895c0 6.447 5.19 11.637 11.637 11.637h204.82c6.447 0 11.638-5.19 11.638-11.637V73.137A11.613 11.613 0 0 0 216.457 61.5zm7.207 16.748h65.322a4.432 4.432 0 0 1 4.441 4.441V94.48a4.432 4.432 0 0 1-4.441 4.442H18.844a4.43 4.43 0 0 1-4.44-4.442V82.69a4.43 4.43 0 0 1 4.44-4.442zm184.49 0a10.336 10.336 0 0 1 10.337 10.337 10.336 10.336 0 0 1-10.337 10.336 10.336 10.336 0 0 1-10.336-10.336 10.336 10.336 0 0 1 10.336-10.337zM11.637 123A11.612 11.612 0 0 0 0 134.637v30.895c0 6.447 5.19 11.637 11.637 11.637h204.82c6.447 0 11.638-5.19 11.638-11.637v-30.895A11.613 11.613 0 0 0 216.457 123zm7.207 16.748h65.322a4.432 4.432 0 0 1 4.441 4.441v11.791a4.432 4.432 0 0 1-4.441 4.442H18.844a4.43 4.43 0 0 1-4.44-4.442v-11.79a4.43 4.43 0 0 1 4.44-4.442zm184.49 0a10.336 10.336 0 0 1 10.337 10.337 10.336 10.336 0 0 1-10.337 10.336 10.336 10.336 0 0 1-10.336-10.336 10.336 10.336 0 0 1 10.336-10.337zM26.084 202.03a12.708 12.708 0 0 0-12.708 12.708 12.708 12.708 0 0 0 12.708 12.708 12.708 12.708 0 0 0 10.806-6.061h56v-13H37.087a12.708 12.708 0 0 0-11.002-6.353zm175.93 0a12.708 12.708 0 0 0-10.982 6.353h-55.824v13h56a12.708 12.708 0 0 0 10.806 6.061 12.708 12.708 0 0 0 12.708-12.707 12.708 12.708 0 0 0-12.708-12.708z"></path></g>'}const ps=M({components:{ServerList:Xr,SvgIcon:We,PlayerList:Br,FollowTarget:is,WorldList:Gr},setup(){const e=_(),t=S(null),o=l(()=>e.state.ui.visibleElements),a=l(()=>e.state.ui.previouslyVisibleElements),r=l(()=>e.state.ui.smallScreen),s=l(()=>e.state.maps.size),n=l(()=>e.state.servers.size),i=l(()=>e.state.followTarget),c=l(()=>e.state.messages.worldsHeading),d=l(()=>e.state.messages.serversHeading),u=l(()=>e.getters.playersHeading),m=l(()=>!!e.state.components.playerMarkers),f=l(()=>o.value.has("players")),k=l(()=>o.value.has("maps")),T=l(()=>!r.value&&i.value||r.value&&f.value),N=R=>{if(!R.target||!R.target.matches(".section__heading button"))return;const re=Array.from(t.value.querySelectorAll(".section__heading button"));et(R,re)},I=R=>{R.key==="ArrowDown"&&e.commit(p.SET_UI_ELEMENT_VISIBILITY,{element:"maps",state:!0})},L=R=>{R.key==="ArrowDown"&&e.commit(p.SET_UI_ELEMENT_VISIBILITY,{element:"players",state:!0})},v=()=>e.commit(p.TOGGLE_UI_ELEMENT_VISIBILITY,"players"),O=()=>e.commit(p.TOGGLE_UI_ELEMENT_VISIBILITY,"maps"),Y=()=>Mt(".section__heading button"),V=()=>Mt("#players-heading");return C(f,R=>R&&Re(()=>V())),C(k,R=>R&&Re(()=>Y())),{sidebar:t,mapCount:s,serverCount:n,following:i,messageWorlds:c,messageServers:d,messagePlayers:u,previouslyVisible:a,playersVisible:f,mapsVisible:k,followVisible:T,playerMakersEnabled:m,handleSidebarKeydown:N,handleMapsKeydown:I,handlePlayersKeydown:L,togglePlayers:v,toggleMaps:O}}}),ms={class:"sidebar",role:"none",ref:"sidebar"},us={class:"sidebar__buttons"},hs=["title","aria-label","aria-expanded"],gs=["title","aria-label","aria-expanded"];function fs(e,t,o,a,r,s){const n=E("SvgIcon"),i=E("ServerList"),c=E("WorldList"),d=E("PlayerList"),u=E("FollowTarget");return y(),b("section",ms,[w("header",us,[e.mapCount>1||e.serverCount>1?(y(),b("button",{key:0,class:K({"button--maps":!0}),onClick:t[0]||(t[0]=(...m)=>e.toggleMaps&&e.toggleMaps(...m)),title:e.mapCount>1?e.messageWorlds:e.messageServers,"aria-label":e.mapCount>1?e.messageWorlds:e.messageServers,"aria-expanded":e.mapsVisible,onKeydown:t[1]||(t[1]=(...m)=>e.handleMapsKeydown&&e.handleMapsKeydown(...m))},[W(n,{name:e.mapCount>1?"maps":"servers"},null,8,["name"])],40,hs)):P("",!0),e.playerMakersEnabled?(y(),b("button",{key:1,class:K({"button--players":!0}),onClick:t[2]||(t[2]=(...m)=>e.togglePlayers&&e.togglePlayers(...m)),title:e.messagePlayers,"aria-label":e.messagePlayers,"aria-expanded":e.playersVisible,onKeydown:t[3]||(t[3]=(...m)=>e.handlePlayersKeydown&&e.handlePlayersKeydown(...m))},[W(n,{name:"players"})],40,gs)):P("",!0)]),w("div",{class:"sidebar__content",onKeydown:t[4]||(t[4]=(...m)=>e.handleSidebarKeydown&&e.handleSidebarKeydown(...m))},[e.serverCount>1?D((y(),z(i,{key:0},null,512)),[[oe,e.mapsVisible]]):P("",!0),e.mapCount>1?D((y(),z(c,{key:1},null,512)),[[oe,e.mapsVisible]]):P("",!0),e.playerMakersEnabled&&e.previouslyVisible.has("players")?D((y(),z(d,{key:2,id:"players"},null,512)),[[oe,e.playersVisible]]):P("",!0),e.following?D((y(),z(u,{key:3,target:e.following},null,8,["target"])),[[oe,e.followVisible]]):P("",!0)],32)],512)}var ys=x(ps,[["render",fs]]);const ws=M({props:{message:{type:Object,required:!0}},setup(e){const t=_();let o=S(Ze),a=l(()=>{var i;return((i=t.state.components.chatBox)==null?void 0:i.showPlayerFaces)&&e.message.playerAccount}),r=l(()=>e.message.playerName&&e.message.type==="chat"),s=l(()=>e.message.type==="chat"?e.message.channel:void 0),n=l(()=>{switch(e.message.type){case"chat":return e.message.message;case"playerjoin":return e.message.playerName?t.state.messages.chatPlayerJoin.replace("%playername%",e.message.playerName):t.state.messages.chatAnonymousJoin;case"playerleave":return e.message.playerName?t.state.messages.chatPlayerQuit.replace("%playername%",e.message.playerName):t.state.messages.chatAnonymousQuit}});return H(()=>{a.value&&Ve(e.message.playerAccount,"small").then(i=>o.value=i.src).catch(()=>{})}),{image:o,showFace:a,showSender:r,messageChannel:s,messageContent:n}}}),vs=["src"],_s=["innerHTML"],bs=["innerHTML"],Es=["innerHTML"];function Ls(e,t,o,a,r,s){return y(),b("li",{class:K(`message message--${e.message.type}`)},[e.showFace?(y(),b("img",{key:0,width:"16",height:"16",class:"message__face",src:e.image,alt:""},null,8,vs)):P("",!0),e.messageChannel?(y(),b("span",{key:1,class:"message__channel",innerHTML:e.messageChannel},null,8,_s)):P("",!0),e.showSender?(y(),b("span",{key:2,class:"message__sender",innerHTML:e.message.playerName},null,8,bs)):P("",!0),w("span",{class:"message__content",innerHTML:e.messageContent},null,8,Es)],2)}var Ss=x(ws,[["render",Ls]]);const ks=M({components:{ChatMessage:Ss},setup(){const e=_(),t=l(()=>e.state.components.chatBox),o=l(()=>e.state.ui.visibleElements.has("chat")),a=l(()=>e.state.components.chatSending&&e.state.components.chatSending.loginRequired&&!e.state.loggedIn),r=l(()=>e.state.components.chatSending&&!a.value),s=l(()=>{var L;return(L=e.state.components.chatSending)==null?void 0:L.maxLength}),n=S(null),i=S(""),c=S(!1),d=S(null),u=l(()=>t.value.messageHistory?e.state.chat.messages.slice(0,t.value.messageHistory):e.state.chat.messages),m=l(()=>e.state.messages.chatSend),f=l(()=>e.state.messages.chatPlaceholder),k=l(()=>e.state.messages.chatNoMessages),T=l(()=>e.state.messages.chatLogin),N=async()=>{const L=i.value.trim().substring(0,s.value);if(!!L){c.value=!0,d.value=null;try{await e.dispatch(U.SEND_CHAT_MESSAGE,L),i.value="",d.value=null}catch(v){v instanceof Ye?d.value=v.message:d.value=e.state.messages.chatErrorUnknown}finally{c.value=!1,requestAnimationFrame(()=>n.value.focus())}}},I=()=>e.commit(p.SHOW_UI_MODAL,"login");return C(o,L=>{L&&r.value&&requestAnimationFrame(()=>n.value.focus())}),{chatInput:n,enteredMessage:i,sendMessage:N,login:I,chatMessages:u,loginRequired:a,sendingEnabled:r,sendingMessage:c,sendingError:d,maxMessageLength:s,messageLogin:T,messageSend:m,messageNoMessages:k,messagePlaceholder:f}}}),Cs={class:"chat"},Ts={class:"chat__messages",role:"log","aria-live":"polite","aria-relevant":"additions"},Ms={key:0,class:"message message--skeleton",role:"none"},As={key:0,role:"alert",class:"chat__error"},Ps=["maxlength","placeholder","disabled"],Is=["disabled"];function Us(e,t,o,a,r,s){const n=E("ChatMessage");return y(),b("section",Cs,[w("ul",Ts,[(y(!0),b(j,null,Q(e.chatMessages,i=>(y(),z(n,{key:i.timestamp,message:i},null,8,["message"]))),128)),e.chatMessages.length?P("",!0):(y(),b("li",Ms,A(e.messageNoMessages),1))]),e.sendingEnabled?(y(),b("form",{key:0,class:"chat__form",onSubmit:t[1]||(t[1]=X((...i)=>e.sendMessage&&e.sendMessage(...i),["prevent"]))},[e.sendingError?(y(),b("div",As,A(e.sendingError),1)):P("",!0),D(w("input",{ref:"chatInput","onUpdate:modelValue":t[0]||(t[0]=i=>e.enteredMessage=i),class:"chat__input",type:"text",maxlength:e.maxMessageLength,placeholder:e.messagePlaceholder,disabled:e.sendingMessage},null,8,Ps),[[ee,e.enteredMessage]]),w("button",{class:"chat__send",disabled:!e.enteredMessage||e.sendingMessage},A(e.messageSend),9,Is)],32)):P("",!0),e.loginRequired?(y(),b("button",{key:1,type:"button",class:"chat__login",onClick:t[2]||(t[2]=(...i)=>e.login&&e.login(...i))},A(e.messageLogin),1)):P("",!0)])}var $s=x(ks,[["render",Us]]);const tt=document.getElementById("app"),ae=document.getElementById("splash"),ot=document.getElementById("splash__spinner"),at=document.getElementById("splash__error"),wt=document.getElementById("splash__error-message"),xe=document.getElementById("splash__error-retry"),zs=function(e){!ae||!tt||(e&&(at&&at.setAttribute("aria-hidden","true"),ot&&(ot.style.visibility="visible"),xe&&(xe.hidden=!0)),ae.hidden=!1,tt.setAttribute("aria-hidden","true"),requestAnimationFrame(function(){ae.style.opacity="1"}))},Os=()=>{!ae||!tt||requestAnimationFrame(()=>{ae.style.opacity="0",tt.removeAttribute("aria-hidden"),window.getComputedStyle(ae).opacity==="0"&&(ae.hidden=!0)})},vt=(e,t,o)=>{at&&at.setAttribute("aria-hidden","false"),wt&&wt.innerText!==e&&(wt.innerText=e||"Unknown error"),ot&&t&&(ot.style.visibility="hidden"),xe&&(t?xe.hidden=!0:o&&(xe.hidden=!1,xe.textContent=`Retrying... (${o.toString()})`))},Ns=M({setup(){const e=_(),t=S(null),o=S(null),a=l(()=>e.state.ui.visibleModal==="login"),r=l(()=>e.state.messages.loginHeading),s=l(()=>e.state.messages.loginHeading),n=l(()=>e.state.messages.loginUsernameLabel),i=l(()=>e.state.messages.loginPasswordLabel),c=l(()=>e.state.messages.loginSubmit),d=l(()=>e.state.messages.loginSuccess),u=S(""),m=S(""),f=S(!1),k=S(!1),T=S(null);return H(()=>{mo(async()=>{await Re(),a.value?o.value.focus():(u.value="",m.value="")})}),{form:t,usernameField:o,heading:r,loginHeading:s,usernameLabel:n,passwordLabel:i,loginSubmit:c,loginUsername:u,loginPassword:m,submitting:f,invalid:k,error:T,login:async()=>{if(T.value=null,k.value=!t.value.reportValidity(),!k.value)try{f.value=!0,await e.dispatch(U.LOGIN,{username:u.value,password:m.value}),e.commit(p.HIDE_UI_MODAL,"login"),J(d.value)}catch(I){T.value=I}finally{f.value=!1}}}}}),xs={class:"form__group"},Rs={for:"login-username",class:"form__label"},Ds={class:"form__group"},Hs={for:"login-password",class:"form__label"},Bs={key:0,role:"alert","aria-live":"assertive",class:"form__group alert"},js={class:"form__group"},Zs=["disabled"];function Ws(e,t,o,a,r,s){return y(),b("form",{class:K({form:!0,"form--invalid":e.invalid}),onSubmit:t[2]||(t[2]=X((...n)=>e.login&&e.login(...n),["prevent"])),ref:"form",novalidate:""},[w("h3",null,A(e.loginHeading),1),w("div",xs,[w("label",Rs,A(e.usernameLabel),1),D(w("input",{id:"login-username",type:"text",name:"username",autocomplete:"username","onUpdate:modelValue":t[0]||(t[0]=n=>e.loginUsername=n),required:"",ref:"usernameField"},null,512),[[ee,e.loginUsername]])]),w("div",Ds,[w("label",Hs,A(e.passwordLabel),1),D(w("input",{id:"login-password",type:"password",name:"password",autocomplete:"current-password","onUpdate:modelValue":t[1]||(t[1]=n=>e.loginPassword=n),required:""},null,512),[[ee,e.loginPassword]])]),e.error?(y(),b("div",Bs,A(e.error),1)):P("",!0),w("div",js,[w("button",{type:"submit",disabled:e.submitting},A(e.loginSubmit),9,Zs)])],34)}var Gs=x(Ns,[["render",Ws]]);const Fs=M({setup(){const e=_(),t=S(null),o=S(null),a=l(()=>e.state.ui.visibleModal==="login"),r=l(()=>e.state.messages.loginUsernameLabel),s=l(()=>e.state.messages.loginPasswordLabel),n=l(()=>e.state.messages.registerConfirmPasswordLabel),i=l(()=>e.state.messages.registerCodeLabel),c=l(()=>e.state.messages.registerHeading),d=l(()=>e.state.messages.registerDescription),u=l(()=>e.state.messages.registerSubmit),m=l(()=>e.state.messages.registerErrorVerifyFailed),f=S(""),k=S(""),T=S(""),N=S(""),I=S(!1),L=S(!1),v=S(null);C(a,V=>{V||(f.value="",k.value="",T.value="",N.value="")});const O=()=>{k.value!==T.value?o.value.setCustomValidity(m.value):o.value.setCustomValidity("")};return{form:t,confirmPasswordField:o,messageHeading:c,messageDescription:d,messageUsernameLabel:r,messagePasswordLabel:s,messageConfirmPasswordLabel:n,messageRegisterCodeLabel:i,messageSubmit:u,valueUsername:f,valuePassword:k,valuePassword2:T,valueCode:N,submitting:I,invalid:L,error:v,register:async()=>{if(v.value=null,O(),L.value=!t.value.reportValidity(),!L.value)try{I.value=!0,await e.dispatch(U.REGISTER,{username:f.value,password:k.value,code:N.value}),e.commit(p.HIDE_UI_MODAL,"login")}catch(V){v.value=V}finally{I.value=!1}}}}}),qs={class:"form__group"},Vs={for:"register-username",class:"form__label"},Ks={class:"form__group"},Ys={for:"register-password",class:"form__label"},Qs={class:"form__group"},Js={for:"register-confirm-password",class:"form__label"},Xs={class:"form__group"},en={for:"register-code",class:"form__label"},tn={key:0,role:"alert","aria-live":"assertive",class:"form__group alert"},on={class:"form__group"},an=["disabled"];function rn(e,t,o,a,r,s){return y(),b("form",{class:K({form:!0,"form--invalid":e.invalid}),onSubmit:t[4]||(t[4]=X((...n)=>e.register&&e.register(...n),["prevent"])),ref:"form",novalidate:""},[w("h3",null,A(e.messageHeading),1),w("p",null,A(e.messageDescription),1),w("div",qs,[w("label",Vs,A(e.messageUsernameLabel),1),D(w("input",{id:"register-username",type:"text",name:"username",autocomplete:"username","onUpdate:modelValue":t[0]||(t[0]=n=>e.valueUsername=n),required:""},null,512),[[ee,e.valueUsername]])]),w("div",Ks,[w("label",Ys,A(e.messagePasswordLabel),1),D(w("input",{id:"register-password",type:"password",name:"password",autocomplete:"new-password","onUpdate:modelValue":t[1]||(t[1]=n=>e.valuePassword=n),required:""},null,512),[[ee,e.valuePassword]])]),w("div",Qs,[w("label",Js,A(e.messageConfirmPasswordLabel),1),D(w("input",{id:"register-confirm-password",type:"password",name:"confirm_password",autocomplete:"new-password","onUpdate:modelValue":t[2]||(t[2]=n=>e.valuePassword2=n),required:"",ref:"confirmPasswordField"},null,512),[[ee,e.valuePassword2]])]),w("div",Xs,[w("label",en,A(e.messageRegisterCodeLabel),1),D(w("input",{id:"register-code",type:"tel",name:"code",minlength:"9",maxlength:"9","onUpdate:modelValue":t[3]||(t[3]=n=>e.valueCode=n),required:""},null,512),[[ee,e.valueCode]])]),e.error?(y(),b("div",tn,A(e.error),1)):P("",!0),w("div",on,[w("button",{type:"submit",disabled:e.submitting},A(e.messageSubmit),9,an)])],34)}var sn=x(Fs,[["render",rn],["__scopeId","data-v-338b3bc6"]]);const nn=M({components:{SvgIcon:We},props:{id:{required:!0,type:String},closeable:{default:!0,type:Boolean},backdrop:{default:!0,type:Boolean}},setup(e){const t=_(),o=S(null),a=l(()=>t.state.messages.closeTitle),r=l(()=>t.state.ui.visibleModal===e.id),s=c=>{e.closeable&&r.value&&c.key==="Escape"&&(i(),c.preventDefault(),c.stopImmediatePropagation())},n=c=>{e.closeable&&c.target===o.value&&i()},i=()=>e.closeable&&t.commit(p.HIDE_UI_MODAL,e.id);return H(()=>{window.addEventListener("keydown",s)}),Z(()=>{window.removeEventListener("keydown",s)}),{visible:r,modal:o,onBackdropClick:n,close:i,messageClose:a}}}),ln=["id","aria-labelledby"],dn={class:"modal__header"},cn=["aria-label"],pn={class:"modal__content"};function mn(e,t,o,a,r,s){const n=E("SvgIcon");return y(),b("div",{class:K({modal:!0,"modal--visible":e.visible,"modal--backdrop":e.backdrop}),role:"dialog",id:`modal--${e.id}`,"aria-labelledby":`${e.id}__heading`,"aria-modal":"true",onClick:t[1]||(t[1]=(...i)=>e.onBackdropClick&&e.onBackdropClick(...i)),ref:"modal"},[w("div",dn,[He(e.$slots,"header"),e.closeable?(y(),b("button",{key:0,class:"modal__close",type:"button",onClick:t[0]||(t[0]=(...i)=>e.close&&e.close(...i)),"aria-label":e.messageClose},[W(n,{name:"cross"})],8,cn)):P("",!0)]),w("div",pn,[He(e.$slots,"default")])],10,ln)}var un=x(nn,[["render",mn]]);const hn=M({components:{Modal:un,RegisterForm:sn,LoginForm:Gs},props:{required:{default:!1,type:Boolean}},setup(){const e=_();return{heading:l(()=>e.state.messages.loginTitle)}}}),gn={id:"login__heading"};function fn(e,t,o,a,r,s){const n=E("LoginForm"),i=E("RegisterForm"),c=E("Modal");return y(),z(c,{id:"login",closeable:!e.required,backdrop:!e.required},{header:F(()=>[w("h2",gn,A(e.heading),1)]),default:F(()=>[W(n),W(i)]),_:1},8,["closeable","backdrop"])}var yn=x(hn,[["render",fn],["__scopeId","data-v-4dc528c6"]]);const wn=M({name:"App",components:{Map:vr,Sidebar:ys,ChatBox:$s,LoginModal:yn},setup(){let e=null;const t=_(),o=l(()=>t.getters.pageTitle),a=l(()=>t.getters.url),r=l(()=>t.state.currentServer),s=l(()=>t.state.configurationHash),n=l(()=>t.state.components.chatBox),i=l(()=>t.state.ui.visibleElements.has("chat")),c=l(()=>t.state.loggedIn),d=l(()=>t.state.loginRequired),u=l(()=>t.getters.loginEnabled),m=l(()=>t.state.ui.visibleModal==="login"&&(!d.value||!t.state.ui.visibleElements.has("maps"))),f=S(!1),k=S(0),T=async()=>{try{clearTimeout(Number(e)),zs(!k.value),f.value=!0,await t.dispatch(U.LOAD_CONFIGURATION,void 0),await t.dispatch(U.START_UPDATES,void 0),requestAnimationFrame(()=>{Os();const v=document.getElementById("#app");v&&v.focus()})}catch(v){if(!(v instanceof DOMException&&v.name==="AbortError")&&!d.value){const O=`Failed to load server configuration for '${t.state.currentServer.id}'`;console.error(`${O}:`,v),vt(`${O}
${v}`,!1,++k.value),clearTimeout(Number(e)),e=setTimeout(()=>T(),1e3)}}finally{f.value=!1}},N=()=>{const v=new URL(window.location.href),O=_o(v);O&&(O.legacy&&(v.searchParams.delete("worldname"),v.searchParams.delete("world"),v.searchParams.delete("mapname"),v.searchParams.delete("x"),v.searchParams.delete("y"),v.searchParams.delete("z"),v.searchParams.delete("zoom"),history.replaceState({},"",v.toString())),t.commit(p.SET_PARSED_URL,O))},I=()=>{t.commit(p.SET_SMALL_SCREEN,window.innerWidth<480||window.innerHeight<500)},L=v=>{if(!v.ctrlKey||!v.shiftKey)return;let O;if(!(t.state.ui.visibleModal&&(!d.value||v.key!=="M"))){switch(v.key){case"M":O="maps";break;case"C":O="chat";break;case"P":O="players";break;case"L":O="layers";break;default:return}v.preventDefault(),t.commit(p.TOGGLE_UI_ELEMENT_VISIBILITY,O)}};return C(o,v=>document.title=v),C(a,v=>window.history.replaceState({},"",v)),C(r,v=>{!v||(k.value=0,window.history.replaceState({},"",v.id),T())},{deep:!0}),C(s,async(v,O)=>{v&&O&&await T()}),C(c,async()=>{f.value||(console.log("Login state changed. Reloading configuration"),await T())}),C(d,v=>{v?(t.commit(p.SET_UI_ELEMENT_VISIBILITY,{element:"maps",state:!1}),t.commit(p.SHOW_UI_MODAL,"login"),J("Login required"),vt("Login required",!0,1)):t.commit(p.HIDE_UI_MODAL,"login")}),N(),I(),H(()=>{window.addEventListener("resize",I),window.addEventListener("keydown",L),window.addEventListener("hashchange",N),T()}),uo(()=>{t.dispatch(U.STOP_UPDATES,void 0),clearTimeout(Number(e)),window.removeEventListener("resize",I),window.removeEventListener("keydown",L),window.removeEventListener("hashchange",N)}),{chatBoxEnabled:n,chatVisible:i,loginEnabled:u,loginRequired:d,loginModalVisible:m}}});function vn(e,t,o,a,r,s){const n=E("Map"),i=E("ChatBox"),c=E("LoginModal"),d=E("Sidebar"),u=E("notifications");return y(),b(j,null,[W(n),e.chatBoxEnabled?D((y(),z(i,{key:0},null,512)),[[oe,e.chatBoxEnabled&&e.chatVisible]]):P("",!0),e.loginEnabled?D((y(),z(c,{key:1,required:e.loginRequired},null,8,["required"])),[[oe,e.loginModalVisible]]):P("",!0),W(d),W(u,{position:"bottom center",speed:250,max:3,ignoreDuplicates:!0,classes:"notification"})],64)}var _n=x(wn,[["render",vn]]);class B extends Error{constructor(t){super(t);this.name=""}}const bn=1,En=e=>{const t=`
Check your server configuration in index.html is correct.`,o=new Map;if(!Object.keys(e).length)throw new B(`No servers defined. ${t}`);for(const a in e){if(!Object.hasOwnProperty.call(e,a))continue;const r=e[a];if(!r||r.constructor!==Object||!Object.keys(r).length)throw new B(`Server '${a}': Configuration missing. ${t}`);if(r.id=a,typeof r.pl3xmap!="undefined")r.type="pl3xmap",r.pl3xmap.slice(-1)!=="/"&&(r.pl3xmap=`${r.pl3xmap}/`);else if(typeof r.dynmap!="undefined"){if(!r.dynmap||r.dynmap.constructor!==Object)throw new B(`Server '${a}': Dynmap configuration object missing. ${t}`);if(!r.dynmap.configuration)throw new B(`Server '${a}': Dynmap configuration URL missing. ${t}`);if(!r.dynmap.update)throw new B(`Server '${a}': Dynmap update URL missing. ${t}`);if(!r.dynmap.markers)throw new B(`Server '${a}': Dynmap markers URL missing. ${t}`);if(!r.dynmap.tiles)throw new B(`Server '${a}': Dynmap tiles URL missing. ${t}`);if(!r.dynmap.sendmessage)throw new B(`Server '${a}': Dynmap sendmessage URL missing. ${t}`);r.type="dynmap"}else throw new B(`Server '${a}': No Dynmap or Pl3xmap configuration defined. ${t}`);o.set(a,r)}return o},Ln=e=>{const t=`
Check your standalone/config.js file exists and is being loaded correctly.`;if(!e)throw new B(`Dynmap configuration is missing. ${t}`);if(!e.configuration)throw new B(`Dynmap configuration URL is missing. ${t}`);if(!e.update)throw new B(`Dynmap update URL is missing. ${t}`);if(!e.markers)throw new B(`Dynmap markers URL is missing. ${t}`);if(!e.tiles)throw new B(`Dynmap tiles URL is missing. ${t}`);if(!e.sendmessage)throw new B(`Dynmap sendmessage URL is missing. ${t}`);const o=new Map;return o.set("dynmap",{id:"dynmap",label:"dynmap",type:"dynmap",dynmap:e}),o},Sn=e=>{var t;if(!e)throw new B(`No configuration found.
Check for any syntax errors in your configuration in index.html. Your browser console may contain additional information.`);if(e.version!==bn)throw new B(`Configuration version mismatch.
Use a fresh copy of index.html from your current LiveAtlas version (${_().state.version}) and reapply any customisations.`);return typeof e.servers!="undefined"?En(e.servers):Ln(((t=window.config)==null?void 0:t.url)||null)},Ge=document.getElementById("splash");Ge&&Ge.addEventListener("transitionend",e=>{e.target===Ge&&Ge.style.opacity==="0"&&(Ge.hidden=!0)});console.info(`LiveAtlas version ${q.state.version} - https://github.com/JLyne/LiveAtlas`);q.subscribe((e,t)=>{(e.type==="toggleSidebarSectionCollapsedState"||e.type==="setSidebarSectionCollapsedState")&&localStorage.setItem("collapsedSections",JSON.stringify(Array.from(t.ui.sidebar.collapsedSections)))});try{const e=window.liveAtlasConfig;if(e.servers=Sn(e),q.commit(p.INIT,e),q.state.servers.size>1){const o=window.location.pathname.split("/").pop(),a=o&&q.state.servers.has(o)?o:q.state.servers.keys().next().value;a!==o&&window.history.replaceState({},"",a+window.location.hash),q.commit(p.SET_CURRENT_SERVER,a)}else q.commit(p.SET_CURRENT_SERVER,q.state.servers.keys().next().value);ho(_n).use(q).use(go).use(fo).mount("#app")}catch(e){console.error("LiveAtlas configuration is invalid: ",e),vt(`LiveAtlas configuration is invalid:
`+e,!0)}
